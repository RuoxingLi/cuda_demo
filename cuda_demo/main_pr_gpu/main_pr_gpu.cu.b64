LyoKICogQ29weXJpZ2h0IDE5OTMtMjAxNSBOVklESUEgQ29ycG9yYXRpb24uICBBbGwgcmlnaHRz
IHJlc2VydmVkLgogKgogKiBQbGVhc2UgcmVmZXIgdG8gdGhlIE5WSURJQSBlbmQgdXNlciBsaWNl
bnNlIGFncmVlbWVudCAoRVVMQSkgYXNzb2NpYXRlZAogKiB3aXRoIHRoaXMgc291cmNlIGNvZGUg
Zm9yIHRlcm1zIGFuZCBjb25kaXRpb25zIHRoYXQgZ292ZXJuIHlvdXIgdXNlIG9mCiAqIHRoaXMg
c29mdHdhcmUuIEFueSB1c2UsIHJlcHJvZHVjdGlvbiwgZGlzY2xvc3VyZSwgb3IgZGlzdHJpYnV0
aW9uIG9mCiAqIHRoaXMgc29mdHdhcmUgYW5kIHJlbGF0ZWQgZG9jdW1lbnRhdGlvbiBvdXRzaWRl
IHRoZSB0ZXJtcyBvZiB0aGUgRVVMQQogKiBpcyBzdHJpY3RseSBwcm9oaWJpdGVkLgogKgogKi8K
CiNwcmFnbWEgZGlhZ19zdXBwcmVzcyAxNzcKLy8gU3lzdGVtIGluY2x1ZGVzCiNpbmNsdWRlIDxz
dGRpby5oPgojaW5jbHVkZSA8Y2Fzc2VydD4KI2luY2x1ZGUgPGZzdHJlYW0+CgoKLy8gQ1VEQSBy
dW50aW1lCiNpbmNsdWRlIDxjdWRhX3J1bnRpbWUuaD4KLy8jaW5jbHVkZSA8Y29vcGVyYXRpdmVf
Z3JvdXBzLmg+CgovLyBoZWxwZXIgZnVuY3Rpb25zIGFuZCB1dGlsaXRpZXMgdG8gd29yayB3aXRo
IENVREEKI2luY2x1ZGUgPGhlbHBlcl9mdW5jdGlvbnMuaD4KI2luY2x1ZGUgPGhlbHBlcl9jdWRh
Lmg+CiNpbmNsdWRlIDxoZWxwZXJfbWF0aC5oPgojaW5jbHVkZSA8dGhydXN0L2RldmljZV92ZWN0
b3IuaD4KI2luY2x1ZGUgPHRocnVzdC9ob3N0X3ZlY3Rvci5oPiAKLy8jaW5jbHVkZSA8aGVscGVy
X2N1ZGFfZHJ2YXBpLmg+CgojaW5jbHVkZSA8aW9zdHJlYW0+CiNpbmNsdWRlIDxudW1lcmljPgoj
aW5jbHVkZSA8c3RkbGliLmg+CiNpbmNsdWRlIDx1bm9yZGVyZWRfbWFwPgojaW5jbHVkZSA8Y2Zs
b2F0PgojaW5jbHVkZSA8dW5vcmRlcmVkX21hcD4KI2luY2x1ZGUgPG1hcD4KCgoKLy8gamQgYWRk
CiNkZWZpbmUgREVMX0FSUl9NRU0oUCkgaWYoTlVMTCAhPSAoUCkpe2RlbGV0ZSBbXSAoUCk7IChQ
KSA9IE5VTEw7fQoKI2lmZGVmIF9fbGludXhfXwojZGVmaW5lIF9fUF9fICByZXR1cm4gMDsgICAv
L19fCiNlbHNlCiNkZWZpbmUgX19QX18gIHN5c3RlbSgicGF1c2UiKTtyZXR1cm4gMDsgICAvL19f
CiNkZWZpbmUgcG9wZW4oZnAsIGZyKSBfcG9wZW4oKGZwKSwoZnIpKQojZGVmaW5lIHBjbG9zZShm
cCkgX3BjbG9zZShmcCkKI2VuZGlmCiNkZWZpbmUgQ1VEQV9DSEVDS19SRVRVUk4odmFsdWUpIENo
ZWNrQ3VkYUVycm9yQXV4KF9fRklMRV9fLF9fTElORV9fLCAjdmFsdWUsIHZhbHVlKQoKI2lmbmRl
ZiBfX0RFRklORV9JRFhfSV9KX0tfaV9qX2tfXwojZGVmaW5lIF9JIChibG9ja0lkeC55KQojZGVm
aW5lIF9KIChibG9ja0lkeC54KQojZGVmaW5lIF9LIChibG9ja0lkeC56KQoKI2RlZmluZSBfaSAg
KHRocmVhZElkeC55KSAKI2RlZmluZSBfaiAodGhyZWFkSWR4LngpCiNkZWZpbmUgX2sgKHRocmVh
ZElkeC56KQoKI2RlZmluZSBfQ09MUyAoZ3JpZERpbS54KQojZGVmaW5lIF9ST1dTIChncmlkRGlt
LnkpIAojZGVmaW5lIF9DSEFOTkVMUyAoZ3JpZERpbS56KQoKI2RlZmluZSBfY29scyAoYmxvY2tE
aW0ueCkKI2RlZmluZSBfcm93cyAoYmxvY2tEaW0ueSkKI2RlZmluZSBfY2hhbm5lbHMgKGJsb2Nr
RGltLnopCgojZGVmaW5lIF9fVElEX0lfSl9LX2lfal9rKEksSixLLCBpLCBqLCBrKSAgKCgoKEkp
KiBfQ09MUyArKEopKSAqIF9DSEFOTkVMUyArIChLKSkgKiBfY29scyAqIF9yb3dzICogX2NoYW5u
ZWxzICsgKChpKSogX2NvbHMgKyAoaikpICogX2NoYW5uZWxzICsgKGspKQojZGVmaW5lIF9fVElE
X0pfaihKLGopICgoSikqIChfY29scykgKyAoaikpCgojZGVmaW5lIEdFVF9USUQgIF9fVElEKF9J
LF9KLF9LLCBfaSwgX2osIF9rKQoKI2RlZmluZSBERUZJTkVfSV9KX0tfaV9qX2tfaWR4ICBhdXRv
IGlkeCA9IF9fVElEX0lfSl9LX2lfal9rKF9JLF9KLF9LLCBfaSwgX2osIF9rKTsKI2RlZmluZSBE
RUZJTkVfSl9qX2lkeCBhdXRvIGlkeCA9IF9fVElEX0pfaihfSixfaik7CgojaWZuZGVmIE1BWAoj
ZGVmaW5lIE1BWChhLGIpIChhID4gYiA/IGEgOiBiKQojZW5kaWYKCnN0YXRpYyB2b2lkIENoZWNr
Q3VkYUVycm9yQXV4KGNvbnN0IGNoYXIgKmZpbGUsIHVuc2lnbmVkIGxpbmUsIGNvbnN0IGNoYXIg
KnN0YXRlbWVudCwgY3VkYUVycm9yX3QgZXJyKQp7CglpZiAoZXJyID09IGN1ZGFTdWNjZXNzKQoJ
CXJldHVybjsKCXN0ZDo6Y2VyciA8PCBzdGF0ZW1lbnQgPDwgIiByZXR1cm5lZCAiIDw8IGN1ZGFH
ZXRFcnJvclN0cmluZyhlcnIpIDw8ICIoIiA8PCBlcnIgPDwgIikgYXQgIiA8PCBmaWxlIDw8ICI6
IiA8PCBsaW5lIDw8IHN0ZDo6ZW5kbDsKCXN5c3RlbSgicGF1c2UiKTsKCWV4aXQoMSk7Cn0KI2Vu
ZGlmIAoKCgoKCgoKdXNpbmcgbmFtZXNwYWNlIHN0ZDsgCi8vIGpkIGVuZCAKCgovLyBqZCBhZGQg
CgpjbGFzcyBzYW1fcmVjb3JkOyAKY2xhc3MgZ3JwX3RhYmxlczsKY2xhc3MgZV9saW5lX3Q7IAoK
CnN0YXRpYyBjb25zdCBpbnQgZV9iX3N6ID0gMTsKCiNkZWZpbmUgTUFYX0VfTElORSAoMTAyNCkK
CiNpZiAxIApzdGF0aWMgY29uc3QgaW50IHJvd3MgPSAxNjsKc3RhdGljIGNvbnN0IGludCBjb2xz
ID0gNTEyOwojZW5kaWYgCgoKI2lmIDAgCnN0YXRpYyBjb25zdCBpbnQgcm93cyA9IDE7CnN0YXRp
YyBjb25zdCBpbnQgY29scyA9IDE7CiNlbmRpZiAKCi8vIGpkIGFkZAoKCmNsYXNzIGNtbF9wYXJz
ZXIKewpwdWJsaWM6CiAgICBtYXA8c3RyaW5nLCB2ZWN0b3I8c3RyaW5nPj4gbWFwXzsKICAgIGNt
bF9wYXJzZXIoaW50IGFyZ2NfLCBjaGFyKiogYXJndl8pCiAgICB7CiAgICAgICAgc3RhdGljIHZl
Y3RvcjxzdHJpbmc+IGtleXNfbGlzdHsgIi1JIiwgIi1vIiwgIi1ncnBQYXRoIiB9OwogICAgICAg
IHZlY3RvcjxzdHJpbmc+IHZlY19hcmd7fTsKCiAgICAgICAgYXV0byBsZW4gPSBhcmdjXzsKICAg
ICAgICBmb3IgKGludCBpID0gMDsgaSA8IGxlbjsgaSsrKQogICAgICAgIHsKICAgICAgICAgICAg
dmVjX2FyZy5wdXNoX2JhY2soc3RyaW5nKGFyZ3ZfW2ldKSk7CiAgICAgICAgfQoKICAgICAgICBm
b3IgKGF1dG8gJmVfa2V5IDoga2V5c19saXN0KQogICAgICAgIHsKICAgICAgICAgICAgdmVjdG9y
PHN0cmluZz46Oml0ZXJhdG9yIGl0ID0gdmVjX2FyZy5iZWdpbigpOwogICAgICAgICAgICB3aGls
ZSAoKGl0ID0gc3RkOjpmaW5kKGl0LCB2ZWNfYXJnLmVuZCgpLCBlX2tleSkpICE9IHZlY19hcmcu
ZW5kKCkpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGl0Kys7CiAgICAgICAgICAgICAg
ICBtYXBfW2Vfa2V5XS5wdXNoX2JhY2soKml0KTsKICAgICAgICAgICAgICAgIC8vY291dCA8PCAq
aXQgPDwgZW5kbDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH07CgogICAgaW50IGhhc19v
cHQoc3RyaW5nIGVfa2V5KQogICAgewogICAgICAgIHJldHVybiBtYXBfLmZpbmQoZV9rZXkpID09
IG1hcF8uZW5kKCkgPyAwIDogMTsKICAgIH0KICAgIHZlY3RvcjxzdHJpbmc+IGdldF9hcmdfb3B0
KHN0cmluZyBlX2tleSkKICAgIHsKICAgICAgICBhc3NlcnQoaGFzX29wdChlX2tleSkpOwogICAg
ICAgIHJldHVybiBtYXBfW2Vfa2V5XTsKICAgIH0KCgp9OwoKLy8gKioqKioqIGhlYWRlcnMsIG9y
ZGVyZWQgKioqKioKLy8jaW5jbHVkZSAiZ2xvYmFsYi5ocHAiCm5hbWVzcGFjZSBnbG9iYWxCCnsK
CWNvbnN0IGludCBTSE9VTERfSEFWRV9BUkdDID0gNzsKCgljb25zdCBpbnQgUkVBRF9VTk1BUFBF
RF9GTEFHID0gMHg0OwoJY29uc3QgaW50IFJFQURfUEFJUkVEX0ZMQUcgPSAweDE7Cgljb25zdCBp
bnQgU0VDT05EX09GX1BBSVJfRkxBRyA9IDB4ODA7Cgljb25zdCBjaGFyIE5PX0FMSUdOTUVOVF9D
SUdBUiA9ICcqJzsKICAgIGNvbnN0IGludCBFdmVudE51bSA9IDM7CiAgICBjb25zdCBpbnQgTEVO
R1RIX0JJVFMgPSA0OwogICAgY29uc3QgaW50IG1pc21hdGNoZXNDb250ZXh0U2l6ZSA9IDI7CiAg
ICBjb25zdCBpbnQgaW5kZWxzQ29udGV4dFNpemUgPSAzOwoKICAgIGNvbnN0IGludCBNQVhfUEhS
RURfU0NPUkUgPSA5MzsKICAgIGNvbnN0IGludCBRdWFsUkFOR0VMRU5USCA9IE1BWF9QSFJFRF9T
Q09SRSArIDE7CiAgICBjb25zdCBpbnQgR3JwUlQyU0hBUEVfZGltXzAgPSAyOwogICAgY29uc3Qg
aW50IEdycFJUMlNIQVBFX2RpbV8xID0gUXVhbFJBTkdFTEVOVEg7CiAgICBjb25zdCBpbnQgSW5k
ZWxLZXlOdW0gPSAxMDEyOwogICAgY29uc3QgaW50IEdycFJUMlNIQVBFX2RpbV8yID0gSW5kZWxL
ZXlOdW07CiAgICBjb25zdCBjaGFyIExPV19RVUFMX1RBSUwgPSAyOwoKICAgIGNvbnN0IGludCBS
RUFEX1NUUkFORF9GTEFHID0gMHgxMDsKICAgIGNvbnN0IGludCBDVVNISU9OX0ZPUl9JTkRFTFMg
PSA0OwogICAgY29uc3QgaW50IERFRkFVTFRfSU5TRVJUSU9OX0RFTEVUSU9OX1FVQUwgPSA0NTsK
ICAgIAoKCgogICAgLy9jb25zdCBpbnQgbWlzbWF0Y2hlc0tleU1hc2sgPSBnbG9iYWxCOjpjcmVh
dGVNYXNrKG1pc21hdGNoZXNDb250ZXh0U2l6ZSk7CiAgICBjb25zdCBpbnQgbWlzbWF0Y2hlc0tl
eU1hc2sgPSAyNDA7CiAgCiAgICAvL2NvbnN0IGludCBpbmRlbHNLZXlNYXNrID0gZ2xvYmFsQjo6
Y3JlYXRlTWFzayhtaXNtYXRjaGVzQ29udGV4dFNpemUpOyAgCiAgICBjb25zdCBpbnQgaW5kZWxz
S2V5TWFzayA9IDI0MDsKICAgIGludCBDT05URVhUQ09NQklORVNJWkU7CiAgICAvLy0tLS0tLS0t
LS0tLS0tLQogICAgdmVjdG9yPHN0cmluZz4gY29udGV4dENvbWJpbmU7CiAgICBpbnQgKmN5Y2xl
X3Zfa19hcnIgPSBOVUxMOwogICAgaW50ICpjb250ZXh0X3Zfa19hcnIgPSBOVUxMOwogICAgdW5v
cmRlcmVkX21hcDxpbnQsIGludD4gY29udGV4dF92X2tfTWFwOwogICAgZG91YmxlICpnbG9iYWxE
ZWx0YVFfMSA9IE5VTEw7CiAgICAvL2NvbnN0IGludCBFdmVudE51bSA9IDM7CiAgICBkb3VibGUg
ZXBzaWxvbltFdmVudE51bV07CiAgICBjb25zdCBpbnQgTUlOX1VTQUJMRV9RX1NDT1JFID0gNjsK
ICAgIGRvdWJsZSAqZGVsdGFRUmVwb3J0ZWQgPSBOVUxMOwogICAgLy9kb3VibGUgKioqKmRlbHRh
UUNvdmFyaWF0ZXNBcnJfMSA9IE5VTEw7CiAgICBkb3VibGUgKmRlbHRhUUNvdmFyaWF0ZXNBcnJf
MSA9IE5VTEw7CiAgICBjb25zdCBpbnQgU01PT1RISU5HX0NPTlNUQU5UID0gMTsgLy9HQVRLOnVz
ZWQgd2hlbiBjYWxjdWxhdGluZyBlbXBpcmljYWwgcXVhbGl0aWVzIHRvIGF2b2lkIGRpdmlzaW9u
IGJ5IHplcm8KICAgIGNvbnN0IGludCBNQVhfUkVBU09OQUJMRV9RX1NDT1JFID0gNjA7CiAgICBj
b25zdCBkb3VibGUgUkVTT0xVVElPTl9CSU5TX1BFUl9RVUFMID0gMS4wZjsKICAgIGNvbnN0IGlu
dCBNQVhfR0FUS19VU0FCTEVfUV9TQ09SRSA9IDQwOwogICAgZG91YmxlIGxvZzEwUWVtcFByaW9y
Q2FjaGVbTUFYX0dBVEtfVVNBQkxFX1FfU0NPUkUgKyAxXTsKICAgIGNvbnN0IGxvbmcgTUFYX05V
TUJFUl9PRl9PQlNFUlZBVElPTlMgPSBJTlRfTUFYIC0gMTsKICAgIGNvbnN0IGludCBMT0cxMF9D
QUNIRV9TSVpFID0gMTAwMDA7CiAgICBjb25zdCBpbnQgTUFUSF9FID0gMi43MTgyODE4Mjg0NTkw
NDUyMzU0OwogICAgZG91YmxlIExvZzEwRmFjdG9yaWFsQ2FjaGVbTE9HMTBfQ0FDSEVfU0laRV07
CiAgICBjb25zdCBkb3VibGUgTE9HMTBfUF9PRl9aRVJPID0gLTEwMDAwMDAuMDsKCgljaGFyICps
aW5lX2NhY2hlID0gTlVMTDsKCWNoYXIgKmxpbmVfY2FjaGVfMSA9IE5VTEw7CgogICAgX19kZXZp
Y2VfXyB2b2lkIGNvbnRleHRXaXRoKGNoYXIqIGJhc2VzLCBpbnQgYmFzZXNfbGVuLCBjb25zdCBp
bnQgY29udGV4dFNpemUsIGNvbnN0IGludCBtYXNrLCBpbnQgKmtleXMpOwogICAgaW50IGNyZWF0
ZU1hc2soY29uc3QgaW50IGNvbnRleHRTaXplKTsKICAgIHZvaWQgcmVsYXRlZERlbHRhUUluaXQo
Z3JwX3RhYmxlcyAmIGd0LCBpbnQgJiByZWFkTGVuZ3RoKTsKICAgIHZvaWQgcmVsYXRlZERlbHRh
UUFsbG9jYXRlKHZlY3RvcjxzdHJpbmc+ICYgY29udGV4dFZhbHVlLCBpbnQgJiByZWFkTGVuZ3Ro
KTsKICAgIHZvaWQgcmVsYXRlZERlbHRhUVJlbGVhc2UoaW50IGNvbnRleHRUb3RhbE51bSwgaW50
ICYgcmVhZExlbmd0aCk7CgogICAgdm9pZCBpbml0aWFsaXplUWVtcFByaW9yKCk7Cn07CgovLyNp
bmNsdWRlICJncnB0b29scy5ocHAiCm5hbWVzcGFjZSBncnB0b29scwp7CiAgICBzdHJ1Y3QgUmVj
YWxUYWJsZTAKICAgIHsKICAgICAgICBkb3VibGUgZW1waXJpY2FsUXVhbGl0eTsKICAgICAgICBk
b3VibGUgZXN0aW1hdGVkUVJlcG9ydGVkOwogICAgICAgIGRvdWJsZSBvYnNlcnZhdGlvbnM7CiAg
ICAgICAgZG91YmxlIG51bU1pc21hdGNoZXM7IC8vIEVycm9ycwogICAgICAgIFJlY2FsVGFibGUw
KCkKICAgICAgICB7CiAgICAgICAgICAgIG9ic2VydmF0aW9ucyA9IDA7CiAgICAgICAgICAgIGVt
cGlyaWNhbFF1YWxpdHkgPSAtMTsKICAgICAgICAgICAgZXN0aW1hdGVkUVJlcG9ydGVkID0gLTE7
CiAgICAgICAgICAgIG51bU1pc21hdGNoZXMgPSAwOwogICAgICAgIH0KICAgICAgICAvL3N0cmlu
ZyB0b19zdHJpbmdfdjEoc3RyaW5nJiBSZWFkR3JvdXAsIHN0cmluZyAmRXZlbnRUeXBlLCBjb25z
dCBjaGFyKiByZWNvcmRfZm9ybWF0LCBjaGFyKiBlX2xpbmUsIGNvbnN0IGludCAmIE1BWF9DSEFS
X0VfTElORSk7CiAgICB9OwoKCiAgICBzdHJ1Y3QgUmVjYWxUYWJsZTEKICAgIHsKICAgICAgICBk
b3VibGUgZW1waXJpY2FsUXVhbGl0eTsKICAgICAgICBkb3VibGUgb2JzZXJ2YXRpb25zOwogICAg
ICAgIGRvdWJsZSBudW1NaXNtYXRjaGVzOyAvLyBFcnJvcnMKCiAgICAgICAgZG91YmxlIGVzdGlt
YXRlZFFSZXBvcnRlZDsgLy8gbm8gbmVlZCB0aGlzIGluIG91dHB1dCBzdHIKICAgICAgICBSZWNh
bFRhYmxlMSgpCiAgICAgICAgewogICAgICAgICAgICBvYnNlcnZhdGlvbnMgPSAwOwogICAgICAg
ICAgICBlbXBpcmljYWxRdWFsaXR5ID0gLTE7CiAgICAgICAgICAgIG51bU1pc21hdGNoZXMgPSAw
OwogICAgICAgIH0KICAgICAgICAvL3N0cmluZyB0b19zdHJpbmdfdjEoc3RyaW5nJiBSZWFkR3Jv
dXAsIGludCAma2V5LCBzdHJpbmcgJkV2ZW50VHlwZSwgY29uc3QgY2hhciogcmVjb3JkX2Zvcm1h
dCwgY2hhciogZV9saW5lLCBjb25zdCBpbnQgJiBNQVhfQ0hBUl9FX0xJTkUpOwogICAgfTsKCiAg
ICBzdHJ1Y3QgUmVjYWxUYWJsZTIKICAgIHsKICAgICAgICBkb3VibGUgZW1waXJpY2FsUXVhbGl0
eTsKICAgICAgICBkb3VibGUgb2JzZXJ2YXRpb25zOwogICAgICAgIGRvdWJsZSBudW1NaXNtYXRj
aGVzOwoKICAgICAgICBkb3VibGUgZXN0aW1hdGVkUVJlcG9ydGVkOyAvLyBubyBuZWVkIHRoaXMg
aW4gb3V0cHV0IHN0cgogICAgICAgIFJlY2FsVGFibGUyKCkKICAgICAgICB7CiAgICAgICAgICAg
IG9ic2VydmF0aW9ucyA9IDA7CiAgICAgICAgICAgIGVtcGlyaWNhbFF1YWxpdHkgPSAtMTsKICAg
ICAgICAgICAgbnVtTWlzbWF0Y2hlcyA9IDA7CiAgICAgICAgfQogICAgICAgIC8vICBzdHJpbmcg
dG9fc3RyaW5nX3YxKHN0cmluZyAmUmVhZEdyb3VwLCBSVDJLRVkgJmtleSwgc3RyaW5nICZFdmVu
dFR5cGUsIGNvbnN0IGNoYXIqIHJlY29yZF9mb3JtYXQsIGNoYXIqIGVfbGluZSwgY29uc3QgaW50
ICYgTUFYX0NIQVJfRV9MSU5FKTsKICAgIH07CgogICAgc3RydWN0IENWS0VZCiAgICB7CiAgICAg
ICAgaW50IHF1YWxpdHkgPSAwOwogICAgICAgIGludCBjb250ZXh0S2V5ID0gMDsKICAgICAgICBp
bnQgY3ljbGVLZXkgPSAwOwogICAgfTsKCgoKICAgIGdycHRvb2xzOjpDVktFWSAqcmVhZENvdmFy
aWF0ZXNBcnIgPSBOVUxMOwoKICAgIF9fZGV2aWNlX18gdm9pZCBDb21wdXRlQ292YXJpYXRlc192
MyhzYW1fcmVjb3JkICYgZV9zYW1fcmVjb3JkLCBncnB0b29sczo6Q1ZLRVkqIHJlYWRDb3Zhcmlh
dGVzQXJyLCBpbnQgcm93cywgaW50IGNvbHMpOwogICAgLy8tLS0tLS0tLS0tLS0tLS0tLQogICAg
ZG91YmxlIGdldEVtcGlyaWNhbFF1YWxpdHlfdjEoZG91YmxlICYgY29uZGl0aW9uYWxQcmlvciwg
ZG91YmxlICYgZW1waXJpY2FsUXVhbGl0eSwgZG91YmxlICYgb2JzZXJ2YXRpb25zLCBkb3VibGUg
JiBudW1NaXNtYXRjaGVzKTsKICAgIGRvdWJsZSBiYXllc2lhbkVzdGltYXRlT2ZFbXBpcmljYWxR
dWFsaXR5KGxvbmcgJiBuT2JzZXJ2YXRpb25zLCBsb25nICYgbkVycm9ycywgZG91YmxlICYgY29u
ZGl0aW9uYWxQcmlvcik7CiAgICBkb3VibGUgbG9nMTBRZW1wUHJpb3IoZG91YmxlICYgUWVtcGly
aWNhbCwgZG91YmxlICYgUXJlcG9ydGVkKTsKICAgIGRvdWJsZSBsb2cxMFFlbXBMaWtlbGlob29k
KGRvdWJsZSAmIFFlbXBpcmljYWwsIGxvbmcgJiBuT2JzZXJ2YXRpb25zLCBsb25nICYgbkVycm9y
cyk7CiAgICBkb3VibGUgbG9nMTBCaW5vbWlhbFByb2JhYmlsaXR5KGNvbnN0IGludCAmIG4sIGNv
bnN0IGludCAmIGssIGNvbnN0IGRvdWJsZSAmIGxvZzEwcCk7CiAgICBkb3VibGUgbG9nMTBCaW5v
bWlhbENvZWZmaWNpZW50KGNvbnN0IGludCAmIG4sIGNvbnN0IGludCAmIGspOwogICAgZG91Ymxl
IGxvZzEwRmFjdG9yaWFsKGNvbnN0IGludCAmIHgpOwogICAgZG91YmxlIGxvZzEwR2FtbWEoY29u
c3QgZG91YmxlICYgeCk7CiAgICBkb3VibGUgbG5Ub0xvZzEwKGNvbnN0IGRvdWJsZSAmIGxuKTsK
ICAgIGRvdWJsZSBxdWFsVG9FcnJvclByb2JMb2cxMChkb3VibGUgJiBxdWFsKTsKICAgIHZlY3Rv
cjxkb3VibGU+IG5vcm1hbGl6ZUZyb21Mb2cxMCh2ZWN0b3I8ZG91YmxlPiAmIGFycmF5LCBjb25z
dCBib29sICYgdGFrZUxvZzEwT2ZPdXRwdXQgPSBmYWxzZSwgY29uc3QgYm9vbCAmIGtlZXBJbkxv
Z1NwYWNlID0gZmFsc2UpOwp9OwoKLy8jaW5jbHVkZSAiZ3B1X3Rvb2xzLmhwcCIKbmFtZXNwYWNl
IGdwdV90b29scwp7CglzdHJpbmcgcmVhZF9oZWFkKGlmc3RyZWFtICZpZl8pOwoJdm9pZCBzaG93
X2N1ZGFfaW5mbyhpbnQgZmxhZ19zaG93KTsKCV9fZ2xvYmFsX18gdm9pZCBwcm9jX2VfbGluZShl
X2xpbmVfdCAqZ3B1X3AsIGludCBjbnRfbGluZSwgICAgCgogICAgICAgIGRvdWJsZSAqZ2xvYmFs
Ql9kZWx0YVFSZXBvcnRlZCwKICAgICAgICBkb3VibGUgKmdsb2JhbEJfZGVsdGFRQ292YXJpYXRl
c0Fycl8xLAogICAgICAgIGRvdWJsZSAqZ2xvYmFsQl9nbG9iYWxEZWx0YVFfMSwKICAgICAgICBp
bnQgKmdsb2JhbEJfY3ljbGVfdl9rX2FyciwKICAgICAgICBpbnQgKmdsb2JhbEJfY29udGV4dF92
X2tfYXJyLAoJaW50IGdsb2JhbEJfQ09OVEVYVENPTUJJTkVTSVpFLCAKCWRvdWJsZSAqZ2xvYmFs
Ql9lcHNpbG9uLCAKCWludCBnbG9iYWxCX2NvbnRleHRDb21iaW5lX3N6LAogICAgICAgIGdycHRv
b2xzOjpDVktFWSAqZ3JwdG9vbHNfcmVhZENvdmFyaWF0ZXNBcnIsCiAgICAgICAgY2hhciAqZ2xv
YmFsQl9saW5lX2NhY2hlLAogICAgICAgIGNoYXIgKmdsb2JhbEJfbGluZV9jYWNoZV8xCiAgICAg
ICAgKTsKCiAgICBfX2RldmljZV9fIGludCBiaW5fbnVtX29mX2V4dChjaGFyKiBlX2V4dCk7CiAg
ICBfX2RldmljZV9fIHZvaWQgaW5zZXJ0X2JkX2JpX3RvX3JlY29yZChjaGFyICphbnNfcjAsIGNo
YXIgKmV4X3N0ciwgaW50JiBleF9zdHJfbGVuLCBjaGFyICpiZCwgaW50IGJkX2xlbiwgY2hhciAq
YmksIGludCBiaV9sZW4sIGNoYXIgc2VwKTsKICAgIF9fZGV2aWNlX18gdm9pZCBwcmludF9pdGVt
KGNoYXIgKnAsIGludCBwX2xlbik7Cgp9OwoKLy8jaW5jbHVkZSAiYmdpdG9vbHMuaHBwIgpuYW1l
c3BhY2UgYmdpdG9vbHMKewoJZW51bSBPUFQKCXsKCQlOLCAvL1NraXBwZWQgcmVnaW9uIGZyb20g
dGhlIHJlZmVyZW5jZQoJCUgsIC8vSGFyZCBjbGlwCgkJUCwgLy9QYWRkaW5nCgkJRCwgLy9EZWxl
dGlvbiB2cy4gdGhlIHJlZmVyZW5jZQoJCUksIC8vSW5zZXJ0aW9uIHZzLiB0aGUgcmVmZXJlbmNl
CgkJUywgLy9Tb2Z0IGNsaXAKCQlNLCAvL01hdGNoIG9yIG1pc21hdGNoCgkJRVEsIC8vTWF0Y2hl
cyB0aGUgcmVmZXJlbmNlCgkJWCAvL01pc21hdGNoZXMgdGhlIHJlZmVyZW5jZQoJfTsKCglzdHJ1
Y3QgQ0lHQVIKCXsKCQlpbnQgbGVuZ3RoOwoJCU9QVCBvcHQ7IC8vb3B0OiBNLEksRCxldGMuLi4K
CX07CgoJc3RydWN0IENpZ2FyT3BlcmF0b3IKCXsKCQlib29sIGNvbnN1bWVzUmVmZXJlbmNlQmFz
ZXM7CgkJYm9vbCBjb25zdW1lc1JlYWRCYXNlczsKCQljaGFyIGNoYXJhY3RlcjsKCX07CgogICAg
ZW51bSBFdmVudFR5cGUKICAgIHsKICAgICAgICBCQVNFX1NVQlNUSVRVVElPTiwKICAgICAgICBC
QVNFX0lOU0VSVElPTiwKICAgICAgICBCQVNFX0RFTEVUSU9OCiAgICB9OwoKCgogICAgdmVjdG9y
PHN0cmluZz4gc3BsaXRfc3RyXzJfdmVjKGNvbnN0IHN0cmluZyAmIHN0ciwgY29uc3QgY2hhciAm
IGRlbGltaXRlciA9ICdcdCcsIGNvbnN0IGludCAmIHJldGFpbk51bSA9IC0xLCBpbnQgZmxhZ19w
dXNoX3RhaWxfc3RyID0gMCk7CiAgICB2b2lkIHRyaW1fc3RyKHN0cmluZyAmIHN0cik7CiAgICB2
b2lkIHRyaW1fc3RyKGNoYXIgKiBzdHIpOwogICAgaW50IGdldEV2ZW50T3JkQnlFdFN0cihjb25z
dCBzdHJpbmcgJiBldFN0cik7CiAgICAvLy0tLS0tLS0KCglfX2RldmljZV9fIGJvb2wgTWFsZm9y
bWVkUmVhZEZpbHRlcihzYW1fcmVjb3JkICYgZV9zYW1fcmVjb3JkKTsKCV9fZGV2aWNlX18gaW50
IGdldEFsaWdubWVudEVuZChzYW1fcmVjb3JkICYgZV9zYW1fcmVjb3JkKTsKCglfX2RldmljZV9f
IHZvaWQgZGVjb2RlX2NpZ2FyKHNhbV9yZWNvcmQgJiBlX3NhbV9yZWNvcmQpOwoJX19kZXZpY2Vf
XyBpbnQgYXRvaShjaGFyKiBwLCBpbnQgcF9sZW4pOwoJX19kZXZpY2VfXyBpbnQgaXNkaWdpdChj
aGFyIHApOwoJX19kZXZpY2VfXyBib29sIGNvbnRhaW5zTk9wZXJhdG9yKHNhbV9yZWNvcmQgJiBl
X3NhbV9yZWNvcmQpOwoJX19kZXZpY2VfXyBib29sIGJhZENpZ2FyRmlsdGVyKHNhbV9yZWNvcmQg
JiBlX3NhbV9yZWNvcmQpOwoJX19kZXZpY2VfXyBzdHJ1Y3QgYmdpdG9vbHM6OkNpZ2FyT3BlcmF0
b3IgY2lnYXJPcGVyYXRvcihiZ2l0b29sczo6T1BUICYgb3B0KTsKICAgIC8vLS0tLS0tLS0tLS0t
LQogICAgdmVjdG9yPHN0cmluZz4gYmFzZUVudW1BbmRDb21iaW5lKGNvbnN0IGludCAmIG51bUJh
c2VzLCBjb25zdCB2ZWN0b3I8c3RyaW5nPiAmIGJhc2VUeXBlID0geyAiQSIsICJDIiwgIkciLCAi
VCIgfSk7CgoKfTsKCi8vI2luY2x1ZGUgInNhbXRvb2xzLmhwcCIKbmFtZXNwYWNlIHNhbXRvb2xz
CnsKCWVudW0gQ2xpcHBpbmdSZXByZXNlbnRhdGlvbgoJewoJCS8qKiBHQVRLOkNsaXBwZWQgYmFz
ZXMgYXJlIGNoYW5nZWQgdG8gTnMgKi8KCQlXUklURV9OUywKCgkJLyoqIEdBVEs6Q2xpcHBlZCBi
YXNlcyBhcmUgY2hhbmdlZCB0byBoYXZlIFEwIHF1YWxpdHkgc2NvcmUgKi8KCQlXUklURV9RMFMs
CgoJCS8qKiBDbGlwcGVkIGJhc2VzIGFyZSBjaGFuZ2UgdG8gaGF2ZSBib3RoIGFuIE4gYmFzZSBh
bmQgYSBRMCBxdWFsaXR5IHNjb3JlICovCgkJV1JJVEVfTlNfUTBTLAoKCQkvKioKCQkgKiBHQVRL
OkNoYW5nZSB0aGUgcmVhZCdzIGNpZ2FyIHN0cmluZyB0byBzb2Z0IGNsaXAgKFMsIHNlZSBzYW0t
c3BlYykgYXdheSB0aGUgYmFzZXMuCgkJICogTm90ZSB0aGF0IHRoaXMgY2FuIG9ubHkgYmUgYXBw
bGllZCB0byBjYXNlcyB3aGVyZSB0aGUgY2xpcHBlZCBiYXNlcyBvY2N1cgoJCSAqIGF0IHRoZSBz
dGFydCBvciBlbmQgb2YgYSByZWFkLgoJCSAqLwoJCVNPRlRDTElQX0JBU0VTLAoKCQkvKioKCQkg
KiBHQVRLOldBUk5JTkc6IFRISVMgT1BUSU9OIElTIFNUSUxMIFVOREVSIERFVkVMT1BNRU5UIEFO
RCBJUyBOT1QgU1VQUE9SVEVELgoJCSAqCgkJICogQ2hhbmdlIHRoZSByZWFkJ3MgY2lnYXIgc3Ry
aW5nIHRvIGhhcmQgY2xpcCAoSCwgc2VlIHNhbS1zcGVjKSBhd2F5IHRoZSBiYXNlcy4KCQkgKiBI
YXJkIGNsaXBwaW5nLCB1bmxpa2Ugc29mdCBjbGlwcGluZywgYWN0dWFsbHkgcmVtb3ZlcyBiYXNl
cyBmcm9tIHRoZSByZWFkLAoJCSAqIHJlZHVjaW5nIHRoZSByZXN1bHRpbmcgZmlsZSdzIHNpemUg
YnV0IGludHJvZHVjaW5nIGFuIGlycmV2ZXNpYmxlIChpLmUuLAoJCSAqIGxvc3N5KSBvcGVyYXRp
b24uICBOb3RlIHRoYXQgdGhpcyBjYW4gb25seSBiZSBhcHBsaWVkIHRvIGNhc2VzIHdoZXJlIHRo
ZSBjbGlwcGVkCgkJICogYmFzZXMgb2NjdXIgYXQgdGhlIHN0YXJ0IG9yIGVuZCBvZiBhIHJlYWQu
CgkJICovCgkJSEFSRENMSVBfQkFTRVMsCgoJCS8qKgoJCSAqIEdBVEs6VHVybiBhbGwgc29mdC1j
bGlwcGVkIGJhc2VzIGludG8gbWF0Y2hlcwoJCSAqLwoJCVJFVkVSVF9TT0ZUQ0xJUFBFRF9CQVNF
UywKCX07CgogICAgaW50IHNpbXBsZUJhc2VUb0Jhc2VJbmRleChjb25zdCBjaGFyICYgYmFzZSk7
CiAgICBfX2RldmljZV9fIGludCBfX2RldmljZV9fc2ltcGxlQmFzZVRvQmFzZUluZGV4KGNvbnN0
IGNoYXIgJiBiYXNlKTsKICAgIAogICAgaW50IGtleUZyb21Db250ZXh0KHN0cmluZyAmYmFzZXMs
IGNvbnN0IGludCAmIHN0YXJ0LCBjb25zdCBpbnQgJiBlbmQpOwogICAgX19kZXZpY2VfXyBpbnQg
X19kZXZpY2VfX2tleUZyb21Db250ZXh0KGNoYXIgKiBiYXNlcywgaW50IGJhc2VzX2xlbiwgY29u
c3QgaW50ICYgc3RhcnQsIGNvbnN0IGludCAmIGVuZCk7CgogICAgX19kZXZpY2VfXyBfX2hvc3Rf
XyBpbnQga2V5RnJvbUN5Y2xlKGludCAmIGN5Y2xlKTsKICAgIC8vLS0tLS0tLS0tCglfX2Rldmlj
ZV9fIGJvb2wgZ2V0UmVhZFVubWFwcGVkRmxhZyhzYW1fcmVjb3JkICYgZV9zYW1fcmVjb3JkKTsK
CV9fZGV2aWNlX18gYm9vbCBnZXRSZWFkUGFpcmVkRmxhZyhjb25zdCBpbnQgJiBmbGFnKTsKCV9f
ZGV2aWNlX18gYm9vbCBnZXRTZWNvbmRPZlBhaXJGbGFnKGNvbnN0IGludCAmIGZsYWcpOwoKCV9f
ZGV2aWNlX18gc2FtX3JlY29yZCBjbGlwTG93UXVhbEVuZHMoc2FtX3JlY29yZCAmIGVfc2FtX3Jl
Y29yZCwgY29uc3QgY2hhciBsb3dRdWFsLCBjb25zdCBzYW10b29sczo6Q2xpcHBpbmdSZXByZXNl
bnRhdGlvbiAmIGFsZ29yaXRobSk7CglfX2RldmljZV9fIGludCBnZXRSZWFkTGVuZ3RoRm9yQ2ln
YXIoc3RydWN0IGJnaXRvb2xzOjpDSUdBUiogY2lnYXJfbWFwLCBpbnQgY2lnYXJfbWFwX2xlbik7
CiAgICBfX2RldmljZV9fIGJvb2wgZ2V0UmVhZE5lZ2F0aXZlU3RyYW5kRmxhZyhzYW1fcmVjb3Jk
JiBlX3NhbV9yZWNvcmQpOwogICAgX19kZXZpY2VfXyB2b2lkIHNpbXBsZVJldmVyc2VDb21wbGVt
ZW50KGNoYXIqIGJhc2VzLCBpbnQgYmFzZXNfbGVuKTsKICAgIF9fZGV2aWNlX18gdm9pZCBnZXRC
YXNlUXVhbGl0aWVzKHNhbV9yZWNvcmQgJiBlX3NhbV9yZWNvcmQsIGludCAmZXZlbnRPcmQsIGNo
YXIqIHF1YWxzKTsKICAgIF9fZGV2aWNlX18gdm9pZCBzZXRCYXNlUXVhbGl0aWVzKGNoYXIgKiBx
dWFscywgc2FtX3JlY29yZCAmIGVfc2FtX3JlY29yZCwgaW50ICYgZXZlbnRPcmQpOwp9OwoKCgoK
Ly8jaW5jbHVkZSAiYnFzcnRvb2xzLmhwcCIKbmFtZXNwYWNlIGJxc3J0b29scwp7CiAgICBkb3Vi
bGUgY2FsY3VsYXRlR2xvYmFsRGVsdGFRX3YxKHN0cnVjdCBncnB0b29sczo6UmVjYWxUYWJsZTAg
JiBlX3J0MF8xKTsKICAgIGRvdWJsZSBDYWxjdWxhdGVEZWx0YVFSZXBvcnRlZF92MShzdHJ1Y3Qg
Z3JwdG9vbHM6OlJlY2FsVGFibGUxICYgZV9ydDFfMSwgY29uc3QgZG91YmxlICYgZ2xvYmFsRGVs
dGFRLCBjb25zdCBkb3VibGUgJiBlcHNpbG9uKTsKICAgIGRvdWJsZSBDYWxjdWxhdGVEZWx0YVFD
b3ZhcmlhdGVzX3YxKHN0cnVjdCBncnB0b29sczo6UmVjYWxUYWJsZTIgJiBlX3J0Ml8xLCBjb25z
dCBkb3VibGUgJiBnbG9iYWxEZWx0YVEsIGNvbnN0IGRvdWJsZSAmIGRlbHRhUVJlcG9ydGVkLCBj
b25zdCBkb3VibGUgJiBlcHNpbG9uKTsKfTsKCgovLyNpbmNsdWRlICJlX2xpbmVfdC5ocHAiCmNs
YXNzIGVfbGluZV90CnsKCXB1YmxpYzoKCQljaGFyIHBbMTAyNF07CgkJaW50IGxlbjsKCQlfX2hv
c3RfXyBfX2RldmljZV9fICB2b2lkIHByaW50KCk7CgoJCV9faG9zdF9fIGVfbGluZV90KHN0cmlu
ZyYgZV9saW5lKTsKfTsKCi8vI2luY2x1ZGUgInNhbV9yZWNvcmQuaHBwIgpjbGFzcyBzYW1fcmVj
b3JkCnsKCXB1YmxpYzoKCQlfX2RldmljZV9fIHNhbV9yZWNvcmQoKTsKCQlfX2RldmljZV9fIH5z
YW1fcmVjb3JkKCk7CgoJCV9fZGV2aWNlX18gIHNhbV9yZWNvcmQoY2hhciogIHBfZV9saW5lKTsK
CQljaGFyICpwOwoJCWNoYXIgKnFuYW1lOwoJCWludCBxbmFtZV9sZW47CgkJdWludDE2X3QgZmxh
ZzsKCQljaGFyICpybmFtZTsKCQlpbnQgcm5hbWVfbGVuOwoKCQl1aW50MzJfdCBwb3M7CgkJdWlu
dDhfdCBtYXBxOwoJCWNoYXIgKmNpZ2FyOwoJCWludCBjaWdhcl9sZW47CgoJCWNoYXIgKnJlZlNl
cTsKCQlpbnQgcmVmU2VxX2xlbjsKCgkJY2hhciAqcm5leHQ7CgkJaW50IHJuZXh0X2xlbjsKCgkJ
dWludDMyX3QgcG5leHQ7CgoJCWludDMyX3QgdGxlbjsKCQljaGFyICpzZXE7CgkJaW50IHNlcV9s
ZW47CgoJCWNoYXIgKnF1YWw7CgkJaW50IHF1YWxfbGVuOwoKCQljaGFyICpleF9zdHI7CgkJaW50
IGV4X3N0cl9sZW47CgoJCS8vCgkJc3RhdGljIGNvbnN0IGludCAgTUFYX0NJR0FSX01BUCA9IDE2
OwoKCgkJaW50IGNpZ2FyX21hcF9sZW47CgkJc3RydWN0IGJnaXRvb2xzOjpDSUdBUiBjaWdhcl9t
YXBbTUFYX0NJR0FSX01BUF07CgogICAgICAgIGNoYXIgKkJJOyAKICAgICAgICBpbnQgQklfbGVu
OyAKCiAgICAgICAgY2hhciAqQkQ7IAogICAgICAgIGludCBCRF9sZW47CgojaWYgMAowIDogcW5h
bWUKCSAgICAxIDogY19mbGFnCgkgICAgMiA6IHJuYW1lCgkgICAgMyA6IGNfcG9zCgkgICAgNCA6
IGNfbWFwcQoJICAgIDUgOiBjaWdhcgoJICAgIDYgOiBybmV4dAoJICAgIDcgOiBjX3BuZXh0Cgkg
ICAgOCA6IGNfdGxlbgoJICAgIDkgOiBzZXEKCSAgICAxMCA6IHF1YWwKI2VuZGlmIAp9OwoKLy8j
aW5jbHVkZSAiZ3JwX3RhYmxlcy5ocHAiCmNsYXNzIGdycF90YWJsZXMKewpwdWJsaWM6CiAgICBz
dHJ1Y3QgZ3JwdG9vbHM6OlJlY2FsVGFibGUwIFJlY2FsVGFibGUwW2dsb2JhbEI6OkV2ZW50TnVt
XTsgLy9ldmVudE9yZAogICAgc3RydWN0IGdycHRvb2xzOjpSZWNhbFRhYmxlMSAqKlJlY2FsVGFi
bGUxID0gTlVMTDsgLy9bOTRdWzNdOiBxdWFsaXR5LCBldmVudE9yZAogICAgc3RydWN0IGdycHRv
b2xzOjpSZWNhbFRhYmxlMiAqKioqUmVjYWxUYWJsZTIgPSBOVUxMOyAvL1syXVsyNTZdWzI1Nl06
Y292YXJpYXRlSWR4LCBxdWFsaXR5LCBjb3ZhcmlhdGVLZXksIGV2ZW50T3JkCgogICAgdm9pZCBh
bGxvY2F0ZVJUMSgpOwogICAgdm9pZCByZWxlYXNlUlQxKCk7CiAgICB2b2lkIGFsbG9jYXRlUlQy
X3YxKCk7CiAgICB2b2lkIHJlbGVhc2VSVDJfdjEoKTsKCiAgICB2b2lkIGxvYWQoc3RyaW5nICZn
cnBfcGF0aCk7Cn07CgovLyNpbmNsdWRlICJlX2xpbmVfdC5jcHAiCi8vIGVfbGluZV90X18gc3Rh
cnQgCl9faG9zdF9fIGVfbGluZV90OjplX2xpbmVfdChzdHJpbmcmIGVfbGluZSkKewoJYXV0byBl
X2xlbiA9IGVfbGluZS5zaXplKCk7CgltZW1jcHkocCwgZV9saW5lLmNfc3RyKCksIGVfbGVuKTsK
CXBbZV9sZW5dID0gJ1wwJzsKCglsZW4gPSAoaW50KWVfbGVuOwp9Cl9faG9zdF9fIF9fZGV2aWNl
X18gIHZvaWQgZV9saW5lX3Q6OnByaW50KCkKewoJcHJpbnRmKCJfX18lc19fX1xuIiwgcCk7Cgkv
L3ByaW50ZigiJWQgIiwgbGVuKTsKfQoKLy8gZV9saW5lX3RfXyBlbmQgCgovLyNpbmNsdWRlICJz
YW1fcmVjb3JkLmNwcCIKLy8gc2FtX3JlY29yZF9fIHN0YXJ0IAoKX19kZXZpY2VfXyBzYW1fcmVj
b3JkOjpzYW1fcmVjb3JkKGNoYXIqICBwX2VfbGluZSkKewoJcCA9IHBfZV9saW5lOyAKCWNpZ2Fy
X21hcF9sZW4gPSAtMTsKCWNoYXIgKmNfZmxhZyA9IE5VTEw7CglpbnQgY19mbGFnX2xlbiA9IDA7
CgoJY2hhciAqY19wb3MgPSBOVUxMOwoJaW50IGNfcG9zX2xlbiA9IDA7CgoJY2hhciAqY19tYXBx
ID0gTlVMTDsKCWludCBjX21hcHFfbGVuID0gMDsKCgljaGFyICpjX3BuZXh0ID0gTlVMTDsKCWlu
dCBjX3BuZXh0X2xlbiA9IDA7CgoJY2hhciAqY190bGVuID0gTlVMTDsKCWludCBjX3RsZW5fbGVu
ID0gMDsKCglhdXRvICpwID0gcF9lX2xpbmU7CglpbnQgY250X2VudGVyID0gMDsKCXFuYW1lID0g
cDsKCglhdXRvIHNldF9wX2xlbiA9IFtdKGNoYXIgKnAsIGNoYXIgKmxhc3RfLCBpbnQgJmxhc3Rf
bGVuLCBjaGFyICogJm5ld18pCgl7CgkJbGFzdF9sZW4gPSBwIC0gbGFzdF87CgkJbmV3XyA9IHAg
KyAxOwoJfTsKI2lmIDAKCWF1dG8gYXRvX2kgPSBbXShjaGFyKiBwLCBpbnQgcF9sZW4pCgl7CgkJ
aW50IHN1bSA9IDA7CgkJYXV0byAqcHAgPSBwOwoJCWF1dG8gcHBfbGVuID0gcF9sZW47CgkJaW50
IGZsYWdfc2lnbiA9IDE7CgoJCWlmIChwcFswXSA9PSAnLScpCgkJewoJCQlwcCsrOwoJCQlwcF9s
ZW4tLTsKCQkJZmxhZ19zaWduID0gLTE7CgkJfQoKCQlmb3IgKGludCBpID0gMDsgaSA8IHBwX2xl
bjsgaSsrKQoJCXsKCQkJLy9zdW0gKz0gcFtpXTsKCQkJc3VtICs9IChwcFtpXSAtICcwJykqIHBv
dygxMCAqIDEuMGYsIChwcF9sZW4gLSBpIC0gMSkqMS4wZik7CgkJfQoJCXJldHVybiBpbnQoc3Vt
ICooZmxhZ19zaWduKSk7Cgl9OwojZW5kaWYgCglhdXRvIHByaW50X2l0ZW0gPSBbXShjaGFyICpw
LCBpbnQgcF9sZW4pCgl7CgkJLy9yZXR1cm47CgkJaWYgKCFwKXJldHVybjsKCQlwcmludGYoIl9f
XyIpOwoJCWZvciAoaW50IGkgPSAwOyBpIDwgcF9sZW47IGkrKykKCQl7CgkJCXByaW50ZigiJWMi
LCBwW2ldKTsKCQl9CgkJcHJpbnRmKCJfX18iKTsKCQkvLyAgICAgICAgICAgICBjb3V0IDw8IGVu
ZGw7CgkJcHJpbnRmKCJcbiIpOwoJfTsKCglhdXRvIHByaW50X2l0ZW1faSA9IFtdKGludCBlKQoJ
ewoJCS8vcmV0dXJuOwoJCXByaW50ZigiX19fIik7CgkJcHJpbnRmKCIlZCIsIGUpOwoJCXByaW50
ZigiX19fIik7CgkJcHJpbnRmKCJcbiIpOwoJfTsKCgl3aGlsZSAoKnAgIT0gJ1wwJykKCXsKCQlp
ZiAoKnAgPT0gJ1x0JykKCQl7CgkJCWNudF9lbnRlcisrOwoJCQlzd2l0Y2ggKGNudF9lbnRlcikK
CQkJewoJCQkJY2FzZSAxOiB7IHNldF9wX2xlbihwLCBxbmFtZSwJcW5hbWVfbGVuLAljX2ZsYWcp
OwlicmVhazsgfQoJCQkJY2FzZSAyOiB7IHNldF9wX2xlbihwLCBjX2ZsYWcsCWNfZmxhZ19sZW4s
CXJuYW1lKTsJCWJyZWFrOyB9CgkJCQljYXNlIDM6IHsgc2V0X3BfbGVuKHAsIHJuYW1lLAlybmFt
ZV9sZW4sCWNfcG9zKTsJCWJyZWFrOyB9CgkJCQljYXNlIDQ6IHsgc2V0X3BfbGVuKHAsIGNfcG9z
LAljX3Bvc19sZW4sCWNfbWFwcSk7CWJyZWFrOyB9CgkJCQljYXNlIDU6IHsgc2V0X3BfbGVuKHAs
IGNfbWFwcSwJY19tYXBxX2xlbiwJY2lnYXIpOwkJYnJlYWs7IH0KCgkJCQljYXNlIDY6IHsgc2V0
X3BfbGVuKHAsIGNpZ2FyLAljaWdhcl9sZW4sCXJuZXh0KTsJCWJyZWFrOyB9CgkJCQljYXNlIDc6
IHsgc2V0X3BfbGVuKHAsIHJuZXh0LAlybmV4dF9sZW4sCWNfcG5leHQpOwlicmVhazsgfQoJCQkJ
Y2FzZSA4OiB7IHNldF9wX2xlbihwLCBjX3BuZXh0LAljX3BuZXh0X2xlbiwJY190bGVuKTsJYnJl
YWs7IH0KCQkJCWNhc2UgOTogeyBzZXRfcF9sZW4ocCwgY190bGVuLAljX3RsZW5fbGVuLAlzZXEp
OwkJYnJlYWs7IH0KCQkJCWNhc2UgMTA6eyBzZXRfcF9sZW4ocCwgc2VxLAlzZXFfbGVuLAlxdWFs
KTsJCWJyZWFrOyB9CgoJCQkJY2FzZSAxMTp7IHNldF9wX2xlbihwLCBxdWFsLAlxdWFsX2xlbiwJ
ZXhfc3RyKTsJYnJlYWs7IH0KCgkJCQlkZWZhdWx0OgoJCQkJCXsKCQkJCQkJLy9wcmludGYoIi0t
LS0tLVxuIik7CgkJCQkJCWFzc2VydCgxMiA9PSBjbnRfZW50ZXIpOwoJCQkJCQlleF9zdHJfbGVu
ID0gMDsKCQkJCQkJd2hpbGUgKGV4X3N0cltleF9zdHJfbGVuXSAhPSAnXDAnKQoJCQkJCQl7CgkJ
CQkJCQlleF9zdHJfbGVuKys7CgkJCQkJCX0KCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQl9CgoJCQlp
ZiAoY250X2VudGVyID09IDEyKSBicmVhazsKCQl9CgoJCXArKzsKCX0KCgoJZmxhZyA9IGJnaXRv
b2xzOjphdG9pKGNfZmxhZywgY19mbGFnX2xlbik7Cglwb3MgPSBiZ2l0b29sczo6YXRvaShjX3Bv
cywgY19wb3NfbGVuKTsKCW1hcHEgPSBiZ2l0b29sczo6YXRvaShjX21hcHEsIGNfbWFwcV9sZW4p
OwoJcG5leHQgPSBiZ2l0b29sczo6YXRvaShjX3BuZXh0LCBjX3BuZXh0X2xlbik7Cgl0bGVuID0g
YmdpdG9vbHM6OmF0b2koY190bGVuLCBjX3RsZW5fbGVuKTsKCiNpZiAwCiAgICBwcmludF9pdGVt
KGNfZmxhZywgY19mbGFnX2xlbik7CiAgICBwcmludF9pdGVtX2koZmxhZyk7CiAgICAvL3ByaW50
X2l0ZW0ocm5hbWUsIHJuYW1lX2xlbik7CiAgICBwcmludF9pdGVtKGNfcG9zLCBjX3Bvc19sZW4p
OwogICAgcHJpbnRfaXRlbV9pKHBvcyk7CiNlbmRpZgoKI2lmIDAKCXByaW50X2l0ZW0ocW5hbWUs
IHFuYW1lX2xlbik7CgkvL3ByaW50X2l0ZW0oY19mbGFnLCBjX2ZsYWdfbGVuKTsKCXByaW50X2l0
ZW1faShmbGFnKTsKCXByaW50X2l0ZW0ocm5hbWUsIHJuYW1lX2xlbik7CgkvL3ByaW50X2l0ZW0o
Y19wb3MsIGNfcG9zX2xlbik7CglwcmludF9pdGVtX2kocG9zKTsKCS8vcHJpbnRfaXRlbShjX21h
cHEsIGNfbWFwcV9sZW4pOwoJcHJpbnRfaXRlbV9pKG1hcHEpOwoJcHJpbnRfaXRlbShjaWdhciwg
Y2lnYXJfbGVuKTsKCXByaW50X2l0ZW0ocm5leHQsIHJuZXh0X2xlbik7CgkvL3ByaW50X2l0ZW0o
Y19wbmV4dCwgY19wbmV4dF9sZW4pOwoJcHJpbnRfaXRlbV9pKHBuZXh0KTsKCS8vcHJpbnRfaXRl
bShjX3RsZW4sIGNfdGxlbl9sZW4pOwoJcHJpbnRfaXRlbV9pKHRsZW4pOwoJcHJpbnRfaXRlbShz
ZXEsIHNlcV9sZW4pOwoJcHJpbnRfaXRlbShxdWFsLCBxdWFsX2xlbik7CglwcmludF9pdGVtKGV4
X3N0ciwgZXhfc3RyX2xlbik7CgkvLy0tLS0tLQoJaW50IGZpZWxkX25vID0gMDsKCXByaW50Zigi
JWQ6ICAgICVzXG4iLCBmaWVsZF9ubysrLCBxbmFtZSk7CglwcmludGYoIiVkOiAgICAlZFxuIiwg
ZmllbGRfbm8rKywgZmxhZyk7CglwcmludGYoIiVkOiAgICAlc1xuIiwgZmllbGRfbm8rKywgcm5h
bWUpOwoJcHJpbnRmKCIlZDogICAgJWRcbiIsIGZpZWxkX25vKyssIHBvcyk7CglwcmludGYoIiVk
OiAgICAlZFxuIiwgZmllbGRfbm8rKywgbWFwcSk7CgoJcHJpbnRmKCIlZDogICAgJXNcbiIsIGZp
ZWxkX25vKyssIGNpZ2FyKTsKCXByaW50ZigiJWQ6ICAgICVzXG4iLCBmaWVsZF9ubysrLCBybmV4
dCk7CglwcmludGYoIiVkOiAgICAlZFxuIiwgZmllbGRfbm8rKywgcG5leHQpOwoJcHJpbnRmKCIl
ZDogICAgJWRcbiIsIGZpZWxkX25vKyssIHRsZW4pOwoJcHJpbnRmKCIlZDogICAgJXNcbiIsIGZp
ZWxkX25vKyssIHNlcSk7CgoJcHJpbnRmKCIlZDogICAgJXNcbiIsIGZpZWxkX25vKyssIHF1YWwp
OwojZW5kaWYgCn0KCl9fZGV2aWNlX18gc2FtX3JlY29yZDo6fnNhbV9yZWNvcmQoKSAKewp9Cl9f
ZGV2aWNlX18gc2FtX3JlY29yZDo6c2FtX3JlY29yZCgpIHt9CgovLyBzYW1fcmVjb3JkX18gZW5k
CgovLyNpbmNsdWRlICJnbG9iYWxCLmNwcCIKLy8gZ2xvYmFsQl9fIHN0YXJ0IAp2b2lkIGdsb2Jh
bEI6OmluaXRpYWxpemVRZW1wUHJpb3IoKQp7CiAgICBkb3VibGUgR0ZfYSA9IDAuMDsKICAgIGRv
dWJsZSBHRl9iID0gMC45OwogICAgZG91YmxlIEdGX2MgPSAwLjA7CiAgICBkb3VibGUgR0ZfZCA9
IDAuNTsgICAvLyBHQVRLOndpdGggdGhlc2UgcGFyYW1ldGVycywgZGVsdGFzIGNhbiBzaGlmdCBh
dCBtb3N0IH4yMCBRIHBvaW50cwoKICAgIGZvciAoaW50IGkgPSAwOyBpIDw9IGdsb2JhbEI6Ok1B
WF9HQVRLX1VTQUJMRV9RX1NDT1JFOyBpKyspCiAgICB7CiAgICAgICAgZG91YmxlIHhNYyA9IGkg
LSBHRl9jOwogICAgICAgIGRvdWJsZSBsb2cxMFByaW9yID0gbG9nMTAoR0ZfYSArIEdGX2IgKiBl
eHAoLXhNYyAqIHhNYyAvICgyLjAgKiAoR0ZfZCAqIEdGX2QpKSkpOwogICAgICAgIGlmICghc3Rk
Ojppc2Zpbml0ZShsb2cxMFByaW9yKSkKICAgICAgICB7CiAgICAgICAgICAgIGxvZzEwUHJpb3Ig
PSAtREJMX01BWDsKICAgICAgICB9CiAgICAgICAgZ2xvYmFsQjo6bG9nMTBRZW1wUHJpb3JDYWNo
ZVtpXSA9IGxvZzEwUHJpb3I7CiAgICB9Cn0KCgp2b2lkIGdsb2JhbEI6OnJlbGF0ZWREZWx0YVFJ
bml0KGdycF90YWJsZXMgJiBndCwgaW50ICYgcmVhZExlbmd0aCkKewogICAgZ2xvYmFsQjo6Y29u
dGV4dENvbWJpbmUgPSBiZ2l0b29sczo6YmFzZUVudW1BbmRDb21iaW5lKDIpOwogICAgdmVjdG9y
PHN0cmluZz4gYmFzZTNjb21iaW5lID0gYmdpdG9vbHM6OmJhc2VFbnVtQW5kQ29tYmluZSgzKTsK
ICAgIGdsb2JhbEI6OmNvbnRleHRDb21iaW5lLmluc2VydChnbG9iYWxCOjpjb250ZXh0Q29tYmlu
ZS5lbmQoKSwgYmFzZTNjb21iaW5lLmJlZ2luKCksIGJhc2UzY29tYmluZS5lbmQoKSk7CiAgICBn
bG9iYWxCOjpDT05URVhUQ09NQklORVNJWkUgPSBnbG9iYWxCOjpjb250ZXh0Q29tYmluZS5zaXpl
KCk7CiAgICBnbG9iYWxCOjpyZWxhdGVkRGVsdGFRQWxsb2NhdGUoZ2xvYmFsQjo6Y29udGV4dENv
bWJpbmUsIHJlYWRMZW5ndGgpOwoKICAgIHVub3JkZXJlZF9tYXA8aW50LCBpbnQ+IGN5Y2xlX2tf
dl9NYXA7CgogICAgLy9nbG9iYWxCOjpjeWNsZV92X2tfYXJyID0gbmV3IGludFtyZWFkTGVuZ3Ro
ICsgcmVhZExlbmd0aCArIDJdOwoKICAgIAoJQ1VEQV9DSEVDS19SRVRVUk4oCgkJCWN1ZGFNYWxs
b2NNYW5hZ2VkKCZnbG9iYWxCOjpjeWNsZV92X2tfYXJyLCAocmVhZExlbmd0aCtyZWFkTGVuZ3Ro
KzIpICogc2l6ZW9mKGludCkpCgkJCSk7IAoKICAgIGFzc2VydChnbG9iYWxCOjpjeWNsZV92X2tf
YXJyICE9IE5VTEwpOwoKICAgIGZvciAoaW50IGlpID0gMDsgaWkgPCByZWFkTGVuZ3RoICsgcmVh
ZExlbmd0aDsgaWkrKykKICAgIHsKICAgICAgICBpbnQgY3ljbGUsIGN5Y2xlS2V5OwogICAgICAg
IGlmIChpaSA8IHJlYWRMZW5ndGgpCiAgICAgICAgewogICAgICAgICAgICBjeWNsZSA9IGlpIC0g
cmVhZExlbmd0aDsKICAgICAgICB9CiAgICAgICAgaWYgKGlpID49IHJlYWRMZW5ndGgpCiAgICAg
ICAgewogICAgICAgICAgICBjeWNsZSA9IGlpIC0gcmVhZExlbmd0aCArIDE7CiAgICAgICAgfQog
ICAgICAgIGN5Y2xlS2V5ID0gc2FtdG9vbHM6OmtleUZyb21DeWNsZShjeWNsZSk7CiAgICAgICAg
Y3ljbGVfa192X01hcFtpaV0gPSBjeWNsZUtleTsKICAgICAgICAvLyAgICAgICAgZ2xvYmFsQjo6
Y3ljbGVfdl9rX01hcFtjeWNsZUtleV0gPSBpaTsKICAgICAgICBnbG9iYWxCOjpjeWNsZV92X2tf
YXJyW2N5Y2xlS2V5XSA9IGlpOwogICAgfQogICAgdW5vcmRlcmVkX21hcDxpbnQsIGludD4gY29u
dGV4dF9rX3ZfTWFwOwogICAgLy9nbG9iYWxCOjpjb250ZXh0X3Zfa19hcnIgPSBuZXcgaW50W2ds
b2JhbEI6OkluZGVsS2V5TnVtXTsKCUNVREFfQ0hFQ0tfUkVUVVJOKAoJCQljdWRhTWFsbG9jTWFu
YWdlZCgmZ2xvYmFsQjo6Y29udGV4dF92X2tfYXJyLCBnbG9iYWxCOjpJbmRlbEtleU51bSAqIHNp
emVvZihpbnQpKQoJCQkpOyAKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZ2xvYmFsQjo6Q09OVEVY
VENPTUJJTkVTSVpFOyBpKyspCiAgICB7CiAgICAgICAgaW50IGNvbnRleHRLZXk7CiAgICAgICAg
aWYgKGdsb2JhbEI6OmNvbnRleHRDb21iaW5lW2ldLmxlbmd0aCgpID09IGdsb2JhbEI6Om1pc21h
dGNoZXNDb250ZXh0U2l6ZSkKICAgICAgICB7CiAgICAgICAgICAgIGNvbnRleHRLZXkgPSBzYW10
b29sczo6a2V5RnJvbUNvbnRleHQoZ2xvYmFsQjo6Y29udGV4dENvbWJpbmVbaV0sIDAsIGdsb2Jh
bEI6Om1pc21hdGNoZXNDb250ZXh0U2l6ZSk7CiAgICAgICAgfQogICAgICAgIGVsc2UKICAgICAg
ICB7CiAgICAgICAgICAgIGNvbnRleHRLZXkgPSBzYW10b29sczo6a2V5RnJvbUNvbnRleHQoZ2xv
YmFsQjo6Y29udGV4dENvbWJpbmVbaV0sIDAsIGdsb2JhbEI6OmluZGVsc0NvbnRleHRTaXplKTsK
ICAgICAgICB9CiAgICAgICAgY29udGV4dF9rX3ZfTWFwW2ldID0gY29udGV4dEtleTsKICAgICAg
ICBnbG9iYWxCOjpjb250ZXh0X3Zfa19NYXBbY29udGV4dEtleV0gPSBpOwogICAgICAgIGdsb2Jh
bEI6OmNvbnRleHRfdl9rX2Fycltjb250ZXh0S2V5XSA9IGk7CiAgICB9CiAgICBjb250ZXh0X2tf
dl9NYXBbZ2xvYmFsQjo6Y29udGV4dENvbWJpbmUuc2l6ZSgpXSA9IC0xOwogICAgZ2xvYmFsQjo6
Y29udGV4dF92X2tfTWFwWy0xXSA9IGdsb2JhbEI6OkNPTlRFWFRDT01CSU5FU0laRTsKCiAgICBk
b3VibGUgZ2xvYmFsRGVsdGFRLCBkZWx0YVFSZXBvcnRlZCwgZXBzaWxvbl90bXA7CgoKICAgIGlu
dCByb3dzID0gZ2xvYmFsQjo6TUFYX1BIUkVEX1NDT1JFIC0gZ2xvYmFsQjo6TUlOX1VTQUJMRV9R
X1NDT1JFICsgMTsKICAgIGludCBjb2xzID0gZ2xvYmFsQjo6Q09OVEVYVENPTUJJTkVTSVpFICsg
MTsKICAgIGludCBjXzAgPSByZWFkTGVuZ3RoICsgcmVhZExlbmd0aDsKICAgIGludCBjXzEgPSBn
bG9iYWxCOjpFdmVudE51bTsKCgogICAgZm9yIChpbnQgZXZlbnRPcmQgPSAwOyBldmVudE9yZCA8
IGdsb2JhbEI6OkV2ZW50TnVtOyBldmVudE9yZCsrKQogICAgewoJICAgIGlmIChndC5SZWNhbFRh
YmxlMFtldmVudE9yZF0ub2JzZXJ2YXRpb25zIDwgMTBlLTQpCgkgICAgewoJCSAgICBnbG9iYWxC
OjpnbG9iYWxEZWx0YVFfMVtldmVudE9yZF0gPSAtMTAwLjsgLy9nbG9iYWxCOjpnbG9iYWxEZWx0
YVFfMVtldmVudE9yZF0gPj0gLWVfcnQwXzEuZXN0aW1hdGVkUVJlcG9ydGVkID49IC0xMDAKCQkg
ICAgY29udGludWU7CgkgICAgfQoJICAgIGdsb2JhbERlbHRhUSA9IGJxc3J0b29sczo6Y2FsY3Vs
YXRlR2xvYmFsRGVsdGFRX3YxKGd0LlJlY2FsVGFibGUwW2V2ZW50T3JkXSk7CgkgICAgZ2xvYmFs
Qjo6Z2xvYmFsRGVsdGFRXzFbZXZlbnRPcmRdID0gZ2xvYmFsRGVsdGFROwoKCSAgICBpZiAoZ2xv
YmFsQjo6Z2xvYmFsRGVsdGFRXzFbZXZlbnRPcmRdIDwgLTEwMC4gKyAxMGUtNCkKCSAgICB7CgkJ
ICAgIHByaW50ZigiZ2xvYmFsQjo6Z2xvYmFsRGVsdGFRXzFbZXZlbnRPcmRdIDwgLTEwMC4gKyAx
MGUtNCBpcyBub3QgYWxsb3dlZCBpbiB0aGlzIHZlcnNpb24iKTsKCQkgICAgYXNzZXJ0KGdsb2Jh
bEI6Omdsb2JhbERlbHRhUV8xW2V2ZW50T3JkXSA+PSAtMTAwLiArIDEwZS00KTsKCSAgICB9Cgkg
ICAgZXBzaWxvbl90bXAgPSBndC5SZWNhbFRhYmxlMFtldmVudE9yZF0uZXN0aW1hdGVkUVJlcG9y
dGVkOwoJICAgIGdsb2JhbEI6OmVwc2lsb25bZXZlbnRPcmRdID0gZXBzaWxvbl90bXA7CgoKCSAg
ICAvL1tpLCBqLCBrLCBtXSAqXyogW3Jvd3MsIGNvbHMsIGNfMCwgY18xXSA9PiAoaSAqIGNvbHMg
KyBqKSAqIGNfMCAqIGNfMSArIGsgKiBjXzEgKyBtOyAKCgkgICAgZm9yIChpbnQgcSA9IDA7IHEg
PD0gZ2xvYmFsQjo6TUFYX1BIUkVEX1NDT1JFIC0gZ2xvYmFsQjo6TUlOX1VTQUJMRV9RX1NDT1JF
OyBxKyspCgkgICAgewoJCSAgICBpbnQgcXVhbEZyb21SZWFkID0gcSArIGdsb2JhbEI6Ok1JTl9V
U0FCTEVfUV9TQ09SRTsKCQkgICAgZGVsdGFRUmVwb3J0ZWQgPSBicXNydG9vbHM6OkNhbGN1bGF0
ZURlbHRhUVJlcG9ydGVkX3YxKGd0LlJlY2FsVGFibGUxW3F1YWxGcm9tUmVhZF1bZXZlbnRPcmRd
LCBnbG9iYWxEZWx0YVEsIGVwc2lsb25fdG1wKTsKCgkJICAgIGludCBpZHggPSBxICogZ2xvYmFs
Qjo6RXZlbnROdW0gKyBldmVudE9yZDsKCgkJICAgIGdsb2JhbEI6OmRlbHRhUVJlcG9ydGVkW2lk
eF0gPSBkZWx0YVFSZXBvcnRlZDsKCgkJICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZ2xvYmFsQjo6
Q09OVEVYVENPTUJJTkVTSVpFICsgMTsgaSsrKQoJCSAgICB7CgkJCSAgICBpbnQgY29udGV4dEtl
eSA9IGNvbnRleHRfa192X01hcFtpXTsKCQkJICAgIGZvciAoaW50IGNvdmFyaWF0ZSA9IDA7IGNv
dmFyaWF0ZSA8IHJlYWRMZW5ndGggKyByZWFkTGVuZ3RoOyBjb3ZhcmlhdGUrKykgCgkJCSAgICB7
CgkJCQkgICAgaW50IGN5Y2xlS2V5ID0gY3ljbGVfa192X01hcFtjb3ZhcmlhdGVdOwoJCQkJICAg
IHZlY3RvcjxpbnQ+IGtleVNldHsgY29udGV4dEtleSwgY3ljbGVLZXkgfTsKI2lmIDAKCQkJCSAg
ICBpZiAocXVhbEZyb21SZWFkID09IDQ1ICYmIGV2ZW50T3JkID09IDIgJiYgY29udGV4dEtleSA9
PSAzICYmIGN5Y2xlS2V5ID09IDEyKQoJCQkJICAgIHsKCQkJCQkgICAgY291dCA8PCAiIjsKCQkJ
CSAgICB9CgkJCQkgICAgLy8gICAgICAgICAgICAgICAgICAgIGNvdXQgPDwgImNvbnRleHRLZXk6
ICIgPDwgY29udGV4dEtleSA8PCAiO2N5Y2xlS2V5OiAiIDw8IGN5Y2xlS2V5IDw8IGVuZGw7CiNl
bmRpZgoJCQkJICAgIGRvdWJsZSBkZWx0YVFDb3ZhcmlhdGVzID0gMC4wOwoJCQkJICAgIGZvciAo
aW50IGN2SW5kID0gMDsgY3ZJbmQgPCAyOyBjdkluZCsrKQoJCQkJICAgIHsKCQkJCQkgICAgaWYg
KGtleVNldFtjdkluZF0gPCAwKSBjb250aW51ZTsKCQkJCQkgICAgZGVsdGFRQ292YXJpYXRlcyAr
PSBicXNydG9vbHM6OkNhbGN1bGF0ZURlbHRhUUNvdmFyaWF0ZXNfdjEoZ3QuUmVjYWxUYWJsZTJb
Y3ZJbmRdW3F1YWxGcm9tUmVhZF1ba2V5U2V0W2N2SW5kXV1bZXZlbnRPcmRdLCBnbG9iYWxEZWx0
YVEsIGRlbHRhUVJlcG9ydGVkLCBlcHNpbG9uX3RtcCk7CgkJCQkgICAgfQoKCQkJCSAgICAvL1tp
LCBqLCBrLCBtXSAqXyogW3Jvd3MsIGNvbHMsIGNfMCwgY18xXSA9PiAoaSAqIGNvbHMgKyBqKSAq
IGNfMCAqIGNfMSArIGsgKiBjXzEgKyBtOyAKCgkJCQkgICAgLy9nbG9iYWxCOjpkZWx0YVFDb3Zh
cmlhdGVzQXJyXzFbcV1baV1bY292YXJpYXRlXVtldmVudE9yZF0gPSBkZWx0YVFDb3ZhcmlhdGVz
OwoJCQkJICAgIC8vCQkgICAgW2ksIGosIGssIG1dID0+ICBbcSxpLCBjb3ZhcmlhdGUsIGV2ZW50
T3JkXSAKCQkJCSAgICBhdXRvIGlkeCA9IChxICogY29scyArIGkpICogY18wICogY18xICsgY292
YXJpYXRlICogY18xICsgZXZlbnRPcmQ7IAoJCQkJICAgIGdsb2JhbEI6OmRlbHRhUUNvdmFyaWF0
ZXNBcnJfMVtpZHhdID0gZGVsdGFRQ292YXJpYXRlczsKCQkJICAgIH0KCQkgICAgfQoJICAgIH0K
CiAgICB9Cgp9Cgp2b2lkIGdsb2JhbEI6OnJlbGF0ZWREZWx0YVFBbGxvY2F0ZSh2ZWN0b3I8c3Ry
aW5nPiAmIGNvbnRleHRWYWx1ZSwgaW50ICYgcmVhZExlbmd0aCkKewogICAgLy9nbG9iYWxCOjpn
bG9iYWxEZWx0YVFfMSA9IG5ldyBkb3VibGVbZ2xvYmFsQjo6RXZlbnROdW1dOwoJQ1VEQV9DSEVD
S19SRVRVUk4oCgkJCWN1ZGFNYWxsb2NNYW5hZ2VkKCZnbG9iYWxCOjpnbG9iYWxEZWx0YVFfMSwg
Z2xvYmFsQjo6RXZlbnROdW0gKiBzaXplb2YoZG91YmxlKSkKCQkJKTsgCgogICAgLy9nbG9iYWxC
OjpkZWx0YVFSZXBvcnRlZCA9IG5ldyBkb3VibGUqW2dsb2JhbEI6Ok1BWF9QSFJFRF9TQ09SRSAt
IGdsb2JhbEI6Ok1JTl9VU0FCTEVfUV9TQ09SRSArIDFdOwoJIAoJQ1VEQV9DSEVDS19SRVRVUk4o
CgkJCWN1ZGFNYWxsb2NNYW5hZ2VkKCZnbG9iYWxCOjpkZWx0YVFSZXBvcnRlZCwgKGdsb2JhbEI6
Ok1BWF9QSFJFRF9TQ09SRSAtIGdsb2JhbEI6Ok1JTl9VU0FCTEVfUV9TQ09SRSArIDEpICogZ2xv
YmFsQjo6RXZlbnROdW0gKiBzaXplb2YoZG91YmxlKSkKCQkJKTsgCi8qCiAgICBmb3IgKGludCBp
ID0gMDsgaSA8IGdsb2JhbEI6Ok1BWF9QSFJFRF9TQ09SRSAtIGdsb2JhbEI6Ok1JTl9VU0FCTEVf
UV9TQ09SRSArIDE7IGkrKykKICAgIHsKICAgICAgICBnbG9iYWxCOjpkZWx0YVFSZXBvcnRlZFtp
XSA9IG5ldyBkb3VibGVbZ2xvYmFsQjo6RXZlbnROdW1dOwogICAgfQoqLwoJaW50IHJvd3MgPSBn
bG9iYWxCOjpNQVhfUEhSRURfU0NPUkUgLSBnbG9iYWxCOjpNSU5fVVNBQkxFX1FfU0NPUkUgKyAx
OwoJaW50IGNvbHMgPSBjb250ZXh0VmFsdWUuc2l6ZSgpICsgMTsKCWludCBjXzAgPSByZWFkTGVu
Z3RoICsgcmVhZExlbmd0aDsgCglpbnQgY18xID0gZ2xvYmFsQjo6RXZlbnROdW07IAoKCgkgCglD
VURBX0NIRUNLX1JFVFVSTigKCQkJY3VkYU1hbGxvY01hbmFnZWQoJmdsb2JhbEI6OmRlbHRhUUNv
dmFyaWF0ZXNBcnJfMSwgKHJvd3MgKiBjb2xzICogY18wICogY18xICogc2l6ZW9mKGRvdWJsZSkp
KQoJCQkpOyAKCiNpZiAwCiAgICBnbG9iYWxCOjpkZWx0YVFDb3ZhcmlhdGVzQXJyXzEgPSBuZXcg
ZG91YmxlKioqW2dsb2JhbEI6Ok1BWF9QSFJFRF9TQ09SRSAtIGdsb2JhbEI6Ok1JTl9VU0FCTEVf
UV9TQ09SRSArIDFdOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBnbG9iYWxCOjpNQVhfUEhSRURf
U0NPUkUgLSBnbG9iYWxCOjpNSU5fVVNBQkxFX1FfU0NPUkUgKyAxOyBpKyspCiAgICB7CiAgICAg
ICAgZ2xvYmFsQjo6ZGVsdGFRQ292YXJpYXRlc0Fycl8xW2ldID0gbmV3IGRvdWJsZSoqW2NvbnRl
eHRWYWx1ZS5zaXplKCkgKyAxXTsKICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IGNvbnRleHRW
YWx1ZS5zaXplKCkgKyAxOyBqKyspCiAgICAgICAgewogICAgICAgICAgICBnbG9iYWxCOjpkZWx0
YVFDb3ZhcmlhdGVzQXJyXzFbaV1bal0gPSBuZXcgZG91YmxlKltyZWFkTGVuZ3RoICsgcmVhZExl
bmd0aF07CiAgICAgICAgICAgIGZvciAoaW50IGsgPSAwOyBrIDwgcmVhZExlbmd0aCArIHJlYWRM
ZW5ndGg7IGsrKykKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZ2xvYmFsQjo6ZGVsdGFR
Q292YXJpYXRlc0Fycl8xW2ldW2pdW2tdID0gbmV3IGRvdWJsZVtnbG9iYWxCOjpFdmVudE51bV07
CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiNlbmRpZiAKCn0KCnZvaWQgZ2xvYmFsQjo6
cmVsYXRlZERlbHRhUVJlbGVhc2UoaW50IGNvbnRleHRUb3RhbE51bSwgaW50ICYgcmVhZExlbmd0
aCkKewojaWYgMAogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBnbG9iYWxCOjpNQVhfUEhSRURfU0NP
UkUgLSBnbG9iYWxCOjpNSU5fVVNBQkxFX1FfU0NPUkUgKyAxOyBpKyspCiAgICB7CiAgICAgICAg
Ly9ERUxfQVJSX01FTShnbG9iYWxCOjpkZWx0YVFSZXBvcnRlZFtpXSk7CgkgICAgCiAgICAgICAg
Zm9yIChpbnQgaiA9IDA7IGogPCBjb250ZXh0VG90YWxOdW0gKyAxOyBqKyspCiAgICAgICAgewog
ICAgICAgICAgICBmb3IgKGludCBjb3ZhcmlhdGUgPSAwOyBjb3ZhcmlhdGUgPCByZWFkTGVuZ3Ro
ICsgcmVhZExlbmd0aDsgY292YXJpYXRlKyspCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAg
IERFTF9BUlJfTUVNKGdsb2JhbEI6OmRlbHRhUUNvdmFyaWF0ZXNBcnJfMVtpXVtqXVtjb3Zhcmlh
dGVdKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBERUxfQVJSX01FTShnbG9iYWxCOjpkZWx0
YVFDb3ZhcmlhdGVzQXJyXzFbaV1bal0pOwogICAgICAgIH0KICAgICAgICBERUxfQVJSX01FTShn
bG9iYWxCOjpkZWx0YVFDb3ZhcmlhdGVzQXJyXzFbaV0pOwogICAgfQojZW5kaWYgCgogICAgLy9E
RUxfQVJSX01FTShnbG9iYWxCOjpkZWx0YVFSZXBvcnRlZCk7CiAgICBjdWRhRnJlZShnbG9iYWxC
OjpkZWx0YVFSZXBvcnRlZCk7ICAKICAgIC8vREVMX0FSUl9NRU0oZ2xvYmFsQjo6ZGVsdGFRQ292
YXJpYXRlc0Fycl8xKTsKCiAgICBjdWRhRnJlZShnbG9iYWxCOjpkZWx0YVFDb3ZhcmlhdGVzQXJy
XzEpOwoKICAgIC8vREVMX0FSUl9NRU0oZ2xvYmFsQjo6Z2xvYmFsRGVsdGFRXzEpOwogICAgY3Vk
YUZyZWUoZ2xvYmFsQjo6Z2xvYmFsRGVsdGFRXzEpOwogICAgLy9ERUxfQVJSX01FTShnbG9iYWxC
OjpjeWNsZV92X2tfYXJyKTsKICAgIGN1ZGFGcmVlKGdsb2JhbEI6OmN5Y2xlX3Zfa19hcnIpOwoK
ICAgIGN1ZGFGcmVlKGdsb2JhbEI6OmNvbnRleHRfdl9rX2Fycik7Cn0KCgoKCmludCBnbG9iYWxC
OjpjcmVhdGVNYXNrKGNvbnN0IGludCBjb250ZXh0U2l6ZSkKewogICAgaW50IG1hc2sgPSAwOwog
ICAgLy8gY3JlYXRlIDIqY29udGV4dFNpemUgd29ydGggb2YgYml0cwogICAgZm9yIChpbnQgaSA9
IDA7IGkgPCBjb250ZXh0U2l6ZTsgaSsrKQogICAgICAgIG1hc2sgPSAobWFzayA8PCAyKSB8IDM7
CiAgICAvLyBzaGlmdCA0IGJpdHMgdG8gbWFzayBvdXQgdGhlIGJpdHMgdXNlZCB0byBlbmNvZGUg
dGhlIGxlbmd0aAogICAgcmV0dXJuIG1hc2sgPDwgZ2xvYmFsQjo6TEVOR1RIX0JJVFM7Cn0KCgoK
X19kZXZpY2VfXyB2b2lkIGdsb2JhbEI6OmNvbnRleHRXaXRoKGNoYXIqIGJhc2VzLCBpbnQgYmFz
ZXNfbGVuLCAgY29uc3QgaW50IGNvbnRleHRTaXplLCBjb25zdCBpbnQgbWFzaywgaW50ICprZXlz
KQp7CiAgICBpbnQgcmVhZExlbmd0aCA9IGJhc2VzX2xlbjsKICAgIGludCBjdXJyZW50SW5kZXgg
PSAwOwogICAgLy9pbnQgKiBrZXlzID0gbmV3IGludFtyZWFkTGVuZ3RoXTsKCiAgICAvLyB0aGUg
Zmlyc3QgY29udGV4dFNpemUtMSBiYXNlcyB3aWxsIG5vdCBoYXZlIGVub3VnaCBwcmV2aW91cyBj
b250ZXh0CiAgICBmb3IgKGludCBpID0gMTsgaSA8IGNvbnRleHRTaXplICYmIGkgPD0gcmVhZExl
bmd0aDsgaSsrKQogICAgewogICAgICAgIGtleXNbY3VycmVudEluZGV4XSA9IC0xOwogICAgICAg
IGN1cnJlbnRJbmRleCsrOwogICAgfQoKICAgIGlmIChyZWFkTGVuZ3RoIDwgY29udGV4dFNpemUp
CiAgICAgICAgcmV0dXJuOwoKICAgIGludCBuZXdCYXNlT2Zmc2V0ID0gMiAqIChjb250ZXh0U2l6
ZSAtIDEpICsgZ2xvYmFsQjo6TEVOR1RIX0JJVFM7CgogICAgLy8gZ2V0IChhbmQgYWRkKSB0aGUg
a2V5IGZvciB0aGUgY29udGV4dCBzdGFydGluZyBhdCB0aGUgZmlyc3QgYmFzZQogICAgaW50IGN1
cnJlbnRLZXkgPSBzYW10b29sczo6X19kZXZpY2VfX2tleUZyb21Db250ZXh0KGJhc2VzLCByZWFk
TGVuZ3RoLCAwLCBjb250ZXh0U2l6ZSk7CiAgICBrZXlzW2N1cnJlbnRJbmRleF0gPSBjdXJyZW50
S2V5OwogICAgY3VycmVudEluZGV4Kys7CgoKICAgIC8vIGlmIHRoZSBmaXJzdCBrZXkgd2FzIC0x
IHRoZW4gdGhlcmUgd2FzIGFuIE4gaW4gdGhlIGNvbnRleHQ7IGZpZ3VyZSBvdXQgaG93IG1hbnkg
bW9yZSBjb25zZWN1dGl2ZSBjb250ZXh0cyBpdCBhZmZlY3RzCiAgICBpbnQgY3VycmVudE5QZW5h
bHR5ID0gMDsKICAgIGlmIChjdXJyZW50S2V5ID09IC0xKQogICAgewogICAgICAgIGN1cnJlbnRL
ZXkgPSAwOwogICAgICAgIGN1cnJlbnROUGVuYWx0eSA9IGNvbnRleHRTaXplIC0gMTsKICAgICAg
ICBpbnQgb2Zmc2V0ID0gbmV3QmFzZU9mZnNldDsKICAgICAgICB3aGlsZSAoYmFzZXNbY3VycmVu
dE5QZW5hbHR5XSAhPSAnTicpCiAgICAgICAgewogICAgICAgICAgICBpbnQgYmFzZUluZGV4ID0g
c2FtdG9vbHM6Ol9fZGV2aWNlX19zaW1wbGVCYXNlVG9CYXNlSW5kZXgoYmFzZXNbY3VycmVudE5Q
ZW5hbHR5XSk7CiAgICAgICAgICAgIGN1cnJlbnRLZXkgfD0gKGJhc2VJbmRleCA8PCBvZmZzZXQp
OwogICAgICAgICAgICBvZmZzZXQgLT0gMjsKICAgICAgICAgICAgY3VycmVudE5QZW5hbHR5LS07
IC8vIGphdmEgY29kZSwgYXJyYXkgaWR4IGNhbiBiZSBuZWd0aXZlIG51bWJlcj8KICAgICAgICB9
CiAgICB9CgogICAgZm9yICg7IGN1cnJlbnRJbmRleCA8IHJlYWRMZW5ndGg7IGN1cnJlbnRJbmRl
eCsrKQogICAgewogICAgICAgIGludCBiYXNlSW5kZXggPSBzYW10b29sczo6X19kZXZpY2VfX3Np
bXBsZUJhc2VUb0Jhc2VJbmRleChiYXNlc1tjdXJyZW50SW5kZXhdKTsKICAgICAgICBpZiAoYmFz
ZUluZGV4ID09IC0xKQogICAgICAgIHsgLy8gaWdub3JlIG5vbi1BQ0dUIGJhc2VzCiAgICAgICAg
ICAgIGN1cnJlbnROUGVuYWx0eSA9IGNvbnRleHRTaXplOwogICAgICAgICAgICBjdXJyZW50S2V5
ID0gMDsgLy8gcmVzZXQgdGhlIGtleQogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgewog
ICAgICAgICAgICAvL1RPRE86IGhpZ2ggNGJpdHMgcmVjb3JkIHRoZSBjb250ZXh0IGJhc2VzIGlz
IHJlZHVuZGFudAogICAgICAgICAgICAvLyBwdXNoIHRoaXMgYmFzZSdzIGNvbnRyaWJ1dGlvbiBv
bnRvIHRoZSBrZXk6IHNoaWZ0IGV2ZXJ5dGhpbmcgMiBiaXRzLCBtYXNrIG91dCB0aGUgbm9uLWNv
bnRleHQgYml0cywgYW5kIGFkZCB0aGUgbmV3IGJhc2UgYW5kIHRoZSBsZW5ndGggaW4KICAgICAg
ICAgICAgY3VycmVudEtleSA9IChjdXJyZW50S2V5ID4+IDIpICYgbWFzazsKICAgICAgICAgICAg
Y3VycmVudEtleSB8PSAoYmFzZUluZGV4IDw8IG5ld0Jhc2VPZmZzZXQpOwogICAgICAgICAgICBj
dXJyZW50S2V5IHw9IGNvbnRleHRTaXplOwogICAgICAgIH0KCiAgICAgICAgaWYgKGN1cnJlbnRO
UGVuYWx0eSA9PSAwKQogICAgICAgIHsKICAgICAgICAgICAga2V5c1tjdXJyZW50SW5kZXhdID0g
Y3VycmVudEtleTsKICAgICAgICB9CiAgICAgICAgZWxzZQogICAgICAgIHsKICAgICAgICAgICAg
Y3VycmVudE5QZW5hbHR5LS07CiAgICAgICAgICAgIGtleXNbY3VycmVudEluZGV4XSA9IC0xOwog
ICAgICAgIH0KICAgIH0KCiAgICByZXR1cm47Cn0KCi8vIGdsb2JhbEJfXyBlbmQgCgovLyNpbmNs
dWRlICJncHVfdG9vbHMuY3BwIgovLyBncHVfdG9vbHNfXyBzdGFydApfX2RldmljZV9fIGludCBn
cHVfdG9vbHM6OmJpbl9udW1fb2ZfZXh0KGNoYXIqIGVfZXh0KQp7CiAgICBpbnQgcmV0X251bSA9
IChlX2V4dFsxXSA8PCA4KSB8IGVfZXh0WzBdOwogICAgcmV0dXJuIHJldF9udW07Cn07CgpfX2Rl
dmljZV9fIHZvaWQgZ3B1X3Rvb2xzOjpwcmludF9pdGVtKGNoYXIgKnAsIGludCBwX2xlbikKewog
ICAgLy9yZXR1cm47CiAgICBpZiAoIXApcmV0dXJuOwogICAgcHJpbnRmKCJfX18iKTsKICAgIGZv
ciAoaW50IGkgPSAwOyBpIDwgcF9sZW47IGkrKykKICAgIHsKI2lmIDAKICAgICAgICBpZiAocFtp
XSA9PSAnXHQnKQogICAgICAgIHsKICAgICAgICAgICAgcFtpXSA9ICcrJzsKICAgICAgICB9CiNl
bmRpZiAKCiAgICAgICAgcHJpbnRmKCIlYyIsIHBbaV0pOwogICAgfQogICAgcHJpbnRmKCJfX18i
KTsKICAgIC8vICAgICAgICAgICAgIGNvdXQgPDwgZW5kbDsKICAgIHByaW50ZigiXG4iKTsKfTsK
X19kZXZpY2VfXyB2b2lkIGdwdV90b29sczo6aW5zZXJ0X2JkX2JpX3RvX3JlY29yZChjaGFyICph
bnNfcjAsIGNoYXIgKmV4X3N0ciwgaW50JiBleF9zdHJfbGVuLCBjaGFyICpiZCwgaW50IGJkX2xl
biwgY2hhciAqYmksIGludCBiaV9sZW4sIGNoYXIgc2VwKQp7CgogICAgaW50IGFuc19sZW4gPSAx
MDI0OwogICAgYXNzZXJ0KE5VTEwgIT0gYW5zX3IwKTsKCiAgICBjaGFyICphbnMgPSBhbnNfcjA7
CiAgICBjaGFyICphbnNfdCA9IGFuc19yMDsKCiAgICBtZW1zZXQoYW5zLCAwLCBhbnNfbGVuKTsK
CiAgICAKICAgIGNoYXIgKnAgPSAoY2hhciopZXhfc3RyOwoKICAgIGF1dG8gQkRfa2V5ID0gZ3B1
X3Rvb2xzOjpiaW5fbnVtX29mX2V4dChiZCk7CiAgICBhdXRvIEJJX2tleSA9IGdwdV90b29sczo6
YmluX251bV9vZl9leHQoYmkpOwoKCgogICAgLy9jaGFyICogb2xkX3AgPSBOVUxMOwoKICAgIHdo
aWxlICgqcCkKICAgIHsKCiAgICAgICAgaWYgKCpwID09IHNlcCkKICAgICAgICB7CiAgICAgICAg
ICAgIHArKzsKICAgICAgICAgICAgYXV0byBlX2tleSA9IGdwdV90b29sczo6YmluX251bV9vZl9l
eHQocCk7CgogICAgICAgICAgICBpZiAoZV9rZXkgPiBCRF9rZXkpCiAgICAgICAgICAgIHsKICAg
ICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vb2xkX3AgPSBw
OwogICAgICAgIH0KCiAgICAgICAgcCsrOwogICAgfQoKICAgIG1lbWNweShhbnNfdCwgZXhfc3Ry
LCBwIC0gZXhfc3RyKTsKICAgIGFuc190ICs9IHAgLSBleF9zdHI7CiAgICBtZW1jcHkoYW5zX3Qs
IGJkLCBiZF9sZW4pOwoKICAgIGFuc190ICs9IGJkX2xlbjsKICAgIGFuc190WzBdID0gc2VwOwog
ICAgYW5zX3QrKzsKCgogICAgLy9wcmludGYoImFuc190OiBfX18lc19fX1xuIiwgYW5zX3IwKTsK
CiAgICAvL3ByaW50ZigiLSAgJWMlYzogQkQgOiAlYyVjXG4iLCBvbGRfcFswXSwgb2xkX3BbMV0s
IHBbMF0sIHBbMV0pOyAvL3AtLTsKCgoKICAgIGNoYXIgKnBfbGFzdF9lbmQgPSBwOwoKICAgIHdo
aWxlICgqcCkKICAgIHsKCiAgICAgICAgaWYgKCpwID09IHNlcCkKICAgICAgICB7CiAgICAgICAg
ICAgIHArKzsKICAgICAgICAgICAgYXV0byBlX2tleSA9IGJpbl9udW1fb2ZfZXh0KHApOwoKICAg
ICAgICAgICAgaWYgKGVfa2V5ID4gQklfa2V5KQogICAgICAgICAgICB7CgogICAgICAgICAgICAg
ICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9vbGRfcCA9IHA7CiAgICAgICAg
fQoKICAgICAgICBwKys7CiAgICB9CiAgICAvL3ByaW50ZigiLSAgJWMlYzogQkkgOiAlYyVjXG4i
LCBvbGRfcFswXSwgb2xkX3BbMV0sIHBbMF0sIHBbMV0pOwoKICAgIG1lbWNweShhbnNfdCwgcF9s
YXN0X2VuZCwgcCAtIHBfbGFzdF9lbmQpOwogICAgYW5zX3QgKz0gcCAtIHBfbGFzdF9lbmQ7Cgog
ICAgbWVtY3B5KGFuc190LCBiaSwgYmlfbGVuKTsKICAgIGFuc190ICs9IGJpX2xlbjsKICAgIGFu
c190WzBdID0gc2VwOwogICAgYW5zX3QrKzsKCiAgICBtZW1jcHkoYW5zX3QsIHAsIGV4X3N0ciAr
IGV4X3N0cl9sZW4gLSBwKTsKICAgIGFuc190ICs9IGV4X3N0ciArIGV4X3N0cl9sZW4gLSBwOwog
ICAgYW5zX3RbMF0gPSAnXDAnOwoKICAgIAogICAgLy9wcmludGYoImFuc19yMDogX19fJXNfX19c
biIsIGFuc19yMCk7CgogICAgbWVtY3B5KGV4X3N0ciwgYW5zX3IwLCBhbnNfbGVuKTsKICAgIAoK
ICAgIGV4X3N0clthbnNfbGVuIC0gMV0gPSAnXDAnOwogICAgZXhfc3RyX2xlbiA9IGFuc190IC0g
YW5zX3IwOwogICAgCn07CgoKCl9fZ2xvYmFsX18gdm9pZCBncHVfdG9vbHM6OnByb2NfZV9saW5l
KCAgLyoKeyAgICAgKi8KCQllX2xpbmVfdCAqZ3B1X3AsCgkgICAgICAgCWludCBjbnRfbGluZSwK
CgkgICAgICAgCWRvdWJsZSAqZ2xvYmFsQl9kZWx0YVFSZXBvcnRlZCwKCSAgICAJZG91YmxlICpn
bG9iYWxCX2RlbHRhUUNvdmFyaWF0ZXNBcnJfMSwKCSAgICAJZG91YmxlICpnbG9iYWxCX2dsb2Jh
bERlbHRhUV8xLAoJICAgIAlpbnQgKmdsb2JhbEJfY3ljbGVfdl9rX2FyciwKCSAgICAJaW50ICpn
bG9iYWxCX2NvbnRleHRfdl9rX2FyciwKCSAgICAgICAJaW50IGdsb2JhbEJfQ09OVEVYVENPTUJJ
TkVTSVpFLCAKCQlkb3VibGUgKmdsb2JhbEJfZXBzaWxvbiwKCQlpbnQgZ2xvYmFsQl9jb250ZXh0
Q29tYmluZV9zeiwKCQlncnB0b29sczo6Q1ZLRVkgKmdycHRvb2xzX3JlYWRDb3ZhcmlhdGVzQXJy
LAoJCWNoYXIgKmdsb2JhbEJfbGluZV9jYWNoZSwgCgkJY2hhciAqZ2xvYmFsQl9saW5lX2NhY2hl
XzEKCQkpCnsgCglERUZJTkVfSl9qX2lkeDsKCgkvL3ByaW50ZigiMSAiKTsKCgoJaWYgKGlkeCA8
IGNudF9saW5lKQoJewoKCQljaGFyICphbnNfcjAgPSBnbG9iYWxCX2xpbmVfY2FjaGUgICArIDEw
MjQgKiBpZHg7CgkJY2hhciAqYW5zX3IxID0gZ2xvYmFsQl9saW5lX2NhY2hlXzEgKyAxMDI0ICog
aWR4OwoKCgkJaW50IHJlY2FsaWJyYXRlZFF1YWxpdHlTY29yZSwgcXVhbEZyb21SZWFkLCBjb250
ZXh0SWRleCwgY3ljbGVJZGV4OwoJCWRvdWJsZSBkZWx0YVFSZXBvcnRlZCwgZGVsdGFRQ292YXJp
YXRlcywgcmVjYWxpYnJhdGVkUXVhbDsKCgoJCXNhbV9yZWNvcmQgZV9zYW1fcmVjb3JkID0gc2Ft
X3JlY29yZChncHVfcFtpZHhdLnApOwoKI2lmIDAKCQlpZiAoZV9zYW1fcmVjb3JkLmZsYWcgPT0g
MTYzICYmIGVfc2FtX3JlY29yZC5wb3MgPT0gMTA0NDAzMzgpCgkJewoJCQlpbnQgdCA9IDk5OwoJ
CQkvL3ByaW50ZigiLS0tJXMtLS1cbiIsIGVfc2FtX3JlY29yZC5wKTsKCQkJLy9ncHVfdG9vbHM6
OnByaW50X2l0ZW0oZV9zYW1fcmVjb3JkLnNlcSwgZV9zYW1fcmVjb3JkLnNlcV9sZW4pOwoJCX0K
I2VuZGlmIAoJCS8vcHJpbnRmKCIlc1xuIiwgZV9zYW1fcmVjb3JkLnApOwoKCQkvL3ByaW50Zigi
X19fJXNfX19cbiIsIGVfc2FtX3JlY29yZC5leF9zdHIpOwoJCS8vcHJpbnRmKCIlZFxuIiwgZV9z
YW1fcmVjb3JkLmV4X3N0cl9sZW4pOwoJCS8vIHN0YXJ0IHByCgoJCWlmIChiZ2l0b29sczo6TWFs
Zm9ybWVkUmVhZEZpbHRlcihlX3NhbV9yZWNvcmQpIHx8IGJnaXRvb2xzOjpiYWRDaWdhckZpbHRl
cihlX3NhbV9yZWNvcmQpKQoJCXsKCQkJLy9wcmludGYoIjAgIik7CgkJCXJldHVybjsKCQl9CgoK
CgoJCWludCBfaV8sIF9qXywgX2tfLCBfbV87CgkJaW50IF9yb3dzXywgX2NvbHNfLCBfY18wXywg
X2NfMV87CgkJaW50IF9pZHhfOwoKCQkvL2dycHRvb2xzOjpDVktFWSAqKnJlYWRDb3ZhcmlhdGVz
QXJyID0gbmV3IGdycHRvb2xzOjpDVktFWSpbM107IAoJCWF1dG8gJnJlYWRMZW5ndGggPSBlX3Nh
bV9yZWNvcmQuc2VxX2xlbjsKCiNpZiAwCgkJZm9yIChpbnQgaSA9IDA7IGkgPCAzOyBpKyspCgkJ
ewoJCQkvL3JlYWRDb3ZhcmlhdGVzQXJyW2ldID0gbmV3IGdycHRvb2xzOjpDVktFWVtyZWFkTGVu
Z3RoXTsKICAgICAgICAgICAgcmVhZENvdmFyaWF0ZXNBcnJbaV0gPSBncnB0b29sc19yZWFkQ292
YXJpYXRlc0FyciArIGlkeCAqIDMgKyBpOwoJCX0KI2VuZGlmIAoJCS8vIGNhbCByZWFkQ29udmFy
aWF0ZXNBcnIKCQlfcm93c18gPSAzOyAKCQlfY29sc18gPSByZWFkTGVuZ3RoOyAKCQkvLyAgICAg
KCZncnB0b29sc19yZWFkQ292YXJpYXRlc0Fyciwgcm93cyAqIGNvbHMgKiAzICogcmVhZExlbmd0
aCAqIHNpemVvZihncnB0b29sczo6Q1ZLRVkpKQoJCWdycHRvb2xzOjpDVktFWSAqcmVhZENvdmFy
aWF0ZXNBcnIgPSBncnB0b29sc19yZWFkQ292YXJpYXRlc0FyciArIGlkeCAqIDMgKiByZWFkTGVu
Z3RoOwoKCQlncnB0b29sczo6Q29tcHV0ZUNvdmFyaWF0ZXNfdjMoZV9zYW1fcmVjb3JkLCByZWFk
Q292YXJpYXRlc0FyciwgX3Jvd3NfLCBfY29sc18pOyAKCgojaWYgMAogICAgICAgIGZvciAoaW50
IGkgPSAwOyBpIDwgMzsgaSsrKQogICAgICAgIHsKICAgICAgICAgICAgYXV0byAmIGUgPSByZWFk
Q292YXJpYXRlc0FycltpXTsgCiAgICAgICAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgcmVhZExl
bmd0aDsgaisrKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBwcmludGYoIiVkICVkICVk
XG4iLCBlW2pdLnF1YWxpdHksIGVbal0uY29udGV4dEtleSwgZVtqXS5jeWNsZUtleSk7CiAgICAg
ICAgICAgIH0KICAgICAgICAgICAgcHJpbnRmKCJcbiIpOwoKICAgICAgICB9CiNlbmRpZiAKCQlh
dXRvICZyZWFkQ292YXJpYXRlcyA9IHJlYWRDb3ZhcmlhdGVzQXJyOwoKCQliZ2l0b29sczo6RXZl
bnRUeXBlIGV0VmVjW10gPSB7IGJnaXRvb2xzOjpFdmVudFR5cGU6OkJBU0VfU1VCU1RJVFVUSU9O
LAoJCQliZ2l0b29sczo6RXZlbnRUeXBlOjpCQVNFX0lOU0VSVElPTiwKCQkJYmdpdG9vbHM6OkV2
ZW50VHlwZTo6QkFTRV9ERUxFVElPTiB9OwoKCQlhdXRvIEV2ZW50TnVtID0gZ2xvYmFsQjo6RXZl
bnROdW07CgkJY2hhciAqcXVhbHMgPSBuZXcgY2hhcltyZWFkTGVuZ3RoXTsgLy8gbWVtIDIKCgkJ
Ly8gW2ksIGosIGssIG1dICAqXyogW3Jvd3MsIGNvbHMsIGNfMCwgY18xXSA9PiAgYXV0byBpZHgg
PSAoaSAqIGNvbHMgKyBqKSAqIGNfMCAqIGNfMSArIGsgKiBjXzEgKyBtOyAKCQllX3NhbV9yZWNv
cmQuQkkgPSBOVUxMOwoJCWVfc2FtX3JlY29yZC5CRCA9IE5VTEw7CgoJCWlmIChOVUxMID09IGVf
c2FtX3JlY29yZC5CSSkKCQl7CgkJCWVfc2FtX3JlY29yZC5CSSA9IG5ldyBjaGFyWzUgKyBlX3Nh
bV9yZWNvcmQucXVhbF9sZW4gKyAxXTsgLy8gbWVtIDIwMTgwODA4MTQwMgoJCX0KCgkJaWYgKE5V
TEwgPT0gZV9zYW1fcmVjb3JkLkJEKQoJCXsKCQkJZV9zYW1fcmVjb3JkLkJEID0gbmV3IGNoYXJb
NSArIGVfc2FtX3JlY29yZC5xdWFsX2xlbiArIDFdOyAvLyBtZW0gMjAxODA4MDgxNDAzCgkJfQoK
CgoJCWZvciAoaW50IGV2ZW50T3JkID0gMDsgZXZlbnRPcmQgPCBFdmVudE51bTsgZXZlbnRPcmQr
KykKCQl7CgoJCQlzYW10b29sczo6Z2V0QmFzZVF1YWxpdGllcyhlX3NhbV9yZWNvcmQsIGV2ZW50
T3JkLCBxdWFscyk7CgoKCgkJCWlmIChnbG9iYWxCX2dsb2JhbERlbHRhUV8xW2V2ZW50T3JkXSA+
IC0xMDAgKyAxMGUtNCkKCQkJewoJCQkJZm9yIChpbnQgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgcmVh
ZExlbmd0aDsgb2Zmc2V0KyspCgkJCQl7CgkJCQkJLy9ncnB0b29sczo6Q1ZLRVkga2V5U2V0ID0g
cmVhZENvdmFyaWF0ZXNbZXZlbnRPcmRdW29mZnNldF07IC8vIGdldCB0aGUga2V5c2V0IGZvciB0
aGlzIGJhc2UgdXNpbmcgdGhlIGVycm9yIG1vZGVsCiAgICAgICAgICAgICAgICAgICAgZ3JwdG9v
bHM6OkNWS0VZIGtleVNldCA9IHJlYWRDb3ZhcmlhdGVzW2V2ZW50T3JkICogcmVhZExlbmd0aCAr
IG9mZnNldF07IC8vIGdldCB0aGUga2V5c2V0IGZvciB0aGlzIGJhc2UgdXNpbmcgdGhlIGVycm9y
IG1vZGVsCgoJCQkJCXF1YWxGcm9tUmVhZCA9IGtleVNldC5xdWFsaXR5OwoJCQkJCWlmIChxdWFs
RnJvbVJlYWQgPj0gZ2xvYmFsQjo6TUlOX1VTQUJMRV9RX1NDT1JFKSAKCQkJCQl7CgojaWYgMQoJ
CQkJCQljb250ZXh0SWRleCA9IChrZXlTZXQuY29udGV4dEtleSAhPSAtMSA/IGdsb2JhbEJfY29u
dGV4dF92X2tfYXJyW2tleVNldC5jb250ZXh0S2V5XSA6IGdsb2JhbEJfQ09OVEVYVENPTUJJTkVT
SVpFKTsKCQkJCQkJY3ljbGVJZGV4ID0gZ2xvYmFsQl9jeWNsZV92X2tfYXJyW2tleVNldC5jeWNs
ZUtleV07CgkJCQkJCS8vZGVsdGFRUmVwb3J0ZWQgPSBnbG9iYWxCX2RlbHRhUVJlcG9ydGVkW3F1
YWxGcm9tUmVhZCAtIGdsb2JhbEI6Ok1JTl9VU0FCTEVfUV9TQ09SRV1bZXZlbnRPcmRdOwoKCQkJ
CQkJX2lfID0gcXVhbEZyb21SZWFkIC0gZ2xvYmFsQjo6TUlOX1VTQUJMRV9RX1NDT1JFOyAgCgkJ
CQkJCV9qXyA9IGV2ZW50T3JkOyAKCQkJCQkJX3Jvd3NfID0gIGdsb2JhbEI6Ok1BWF9QSFJFRF9T
Q09SRSAtIGdsb2JhbEI6Ok1JTl9VU0FCTEVfUV9TQ09SRSArIDE7CgkJCQkJCV9jb2xzXyA9IGds
b2JhbEI6OkV2ZW50TnVtOyAKCgkJCQkJCV9pZHhfID0gX2lfICogIF9jb2xzXyArIF9qXzsKCgkJ
CQkJCS8vIFtpOiBnbG9iYWxCOjpNQVhfUEhSRURfU0NPUkUgLSBnbG9iYWxCOjpNSU5fVVNBQkxF
X1FfU0NPUkUgKyAxLCBqOmdsb2JhbEI6OkV2ZW50TnVtXSAKCQkJCQkJZGVsdGFRUmVwb3J0ZWQg
PSBnbG9iYWxCX2RlbHRhUVJlcG9ydGVkW19pZHhfXTsgICAKCgkJCQkJCS8vZGVsdGFRQ292YXJp
YXRlcyA9IGdsb2JhbEJfZGVsdGFRQ292YXJpYXRlc0Fycl8xW3F1YWxGcm9tUmVhZCAtIGdsb2Jh
bEI6Ok1JTl9VU0FCTEVfUV9TQ09SRV1bY29udGV4dElkZXhdW2N5Y2xlSWRleF1bZXZlbnRPcmRd
OwoKCQkJCQkJX2lfID0gcXVhbEZyb21SZWFkIC0gZ2xvYmFsQjo6TUlOX1VTQUJMRV9RX1NDT1JF
OyAKCQkJCQkJX2pfID0gY29udGV4dElkZXg7IAoJCQkJCQlfa18gPSBjeWNsZUlkZXg7IAoJCQkJ
CQlfbV8gPSBldmVudE9yZDsgCgoJCQkJCQlfcm93c18gPSBnbG9iYWxCOjpNQVhfUEhSRURfU0NP
UkUgLSBnbG9iYWxCOjpNSU5fVVNBQkxFX1FfU0NPUkUgKyAxOwoJCQkJCQlfY29sc18gPSBnbG9i
YWxCX2NvbnRleHRDb21iaW5lX3N6ICsxOyAKCQkJCQkJX2NfMF8gPSByZWFkTGVuZ3RoK3JlYWRM
ZW5ndGg7IAoJCQkJCQlfY18xXyA9IGdsb2JhbEI6OkV2ZW50TnVtOwoKCQkJCQkJX2lkeF8gPSAo
X2lfICogX2NvbHNfICsgX2pfKSAqIF9jXzBfICogX2NfMV8gKyBfa18gKiBfY18xXyArIF9tXzsK
CgoJCQkJCQkvLyBbaTpnbG9iYWxCOjpNQVhfUEhSRURfU0NPUkUgLSBnbG9iYWxCOjpNSU5fVVNB
QkxFX1FfU0NPUkUgKyAxICwgajpjb250ZXh0VmFsdWUuc2l6ZSgpKzEgLCBrOnJlYWRMZW5ndGgr
cmVhZExlbmd0aCAsIG06Z2xvYmFsQjo6RXZlbnROdW1dCgkJCQkJCWRlbHRhUUNvdmFyaWF0ZXMg
PSBnbG9iYWxCX2RlbHRhUUNvdmFyaWF0ZXNBcnJfMVtfaWR4X107ICAKCgkJCQkJCXJlY2FsaWJy
YXRlZFF1YWwgPSBnbG9iYWxCX2Vwc2lsb25bZXZlbnRPcmRdICsgZ2xvYmFsQl9nbG9iYWxEZWx0
YVFfMVtldmVudE9yZF0gKyBkZWx0YVFSZXBvcnRlZCArIGRlbHRhUUNvdmFyaWF0ZXM7CgoJCQkJ
CQlpbnQgcnEgPSByb3VuZChyZWNhbGlicmF0ZWRRdWFsKTsKCQkJCQkJcmVjYWxpYnJhdGVkUXVh
bGl0eVNjb3JlID0gbWF4KG1pbihycSwgZ2xvYmFsQjo6TUFYX1BIUkVEX1NDT1JFKSwgMSk7CgkJ
CQkJCXF1YWxGcm9tUmVhZCA9IHJlY2FsaWJyYXRlZFF1YWxpdHlTY29yZTsKCgojZW5kaWYgCgkJ
CQkJfQoKI2lmIDAKCQkJCQlpZiAob2Zmc2V0ID49IDYpCgkJCQkJewoJCQkJCQlpbnQgdCA9IDk5
OwoJCQkJCQlwcmludGYoIiVmXG4iLCAoZmxvYXQpY29udGV4dElkZXggKTsgCgkJCQkJCXByaW50
ZigiJWZcbiIsIChmbG9hdCljeWNsZUlkZXgpOyAKCQkJCQkJcHJpbnRmKCIlZlxuIiwgKGZsb2F0
KWRlbHRhUVJlcG9ydGVkICk7IAoJCQkJCQlwcmludGYoIiVmXG4iLCAoZmxvYXQpZGVsdGFRQ292
YXJpYXRlcyApOyAKCQkJCQkJcHJpbnRmKCIlZlxuIiwgKGZsb2F0KXJlY2FsaWJyYXRlZFF1YWwg
KTsgCgkJCQkJCXByaW50ZigiJWZcbiIsIChmbG9hdClyZWNhbGlicmF0ZWRRdWFsaXR5U2NvcmUg
KTsgCgkJCQkJCXByaW50ZigiJWZcbiIsIChmbG9hdClxdWFsRnJvbVJlYWQgKTsgCgkJCQkJfQoj
ZW5kaWYKCQkJCQlxdWFsc1tvZmZzZXRdID0gKHF1YWxGcm9tUmVhZCArIDMzKTsKCgkJCQl9CgkJ
CX0KCgkJCWVfc2FtX3JlY29yZC5xdWFsW2Vfc2FtX3JlY29yZC5xdWFsX2xlbl0gPSAnXHQnOwoK
CgoJCQkvLyhldmVudE9yZCA9PSAwKSAmJiBwcmludGYoIi0gYmVmb3JlOlx0JXNcbiIsIGVfc2Ft
X3JlY29yZC5xdWFsKTsKCQkJc2FtdG9vbHM6OnNldEJhc2VRdWFsaXRpZXMocXVhbHMsIGVfc2Ft
X3JlY29yZCwgZXZlbnRPcmQpOwoJCQkvLyhldmVudE9yZCA9PSAwKSAmJiBwcmludGYoIi0gYWZ0
ZXIgOlx0JXNcbiIsIGVfc2FtX3JlY29yZC5xdWFsKTsKCgoKCQkJLy8oZXZlbnRPcmQgPT0gMSkg
JiYgcHJpbnRmKCItICAgQkk6XHQlc1xuIiwgZV9zYW1fcmVjb3JkLkJJKTsKCQkJLy8oZXZlbnRP
cmQgPT0gMikgJiYgcHJpbnRmKCItICAgQkQ6XHQlc1xuIiwgZV9zYW1fcmVjb3JkLkJEKTsKCgoJ
CQlpZiAoZXZlbnRPcmQgPT0gRXZlbnROdW0gLSAxKQoJCQl7CgkJCQkvL2NoYXIgKmV4X3N0ciA9
IG5ldyBjaGFyWzEwMjRdOyAvLyBlX2xpbmUgc2l6ZSBtYXgKCQkJCWNoYXIgKmV4X3N0ciA9IGFu
c19yMTsKCQkJCWFzc2VydChOVUxMICE9IGV4X3N0cik7CgkJCQltZW1zZXQoZXhfc3RyLCAwLCAx
MDI0KTsKCQkJCW1lbWNweShleF9zdHIsIGVfc2FtX3JlY29yZC5leF9zdHIsIGVfc2FtX3JlY29y
ZC5leF9zdHJfbGVuKTsKCgkJCQkvL2dwdV90b29sczo6cHJpbnRfaXRlbShlX3NhbV9yZWNvcmQu
QkQsIGVfc2FtX3JlY29yZC5CRF9sZW4pOyAKCQkJCS8vZ3B1X3Rvb2xzOjpwcmludF9pdGVtKGVf
c2FtX3JlY29yZC5CSSwgZV9zYW1fcmVjb3JkLkJJX2xlbik7CgkJCQkvL2dwdV90b29sczo6cHJp
bnRfaXRlbShlX3NhbV9yZWNvcmQuZXhfc3RyLCBlX3NhbV9yZWNvcmQuZXhfc3RyX2xlbik7CgoK
CQkJCWdwdV90b29sczo6aW5zZXJ0X2JkX2JpX3RvX3JlY29yZChhbnNfcjAsIGV4X3N0ciwgZV9z
YW1fcmVjb3JkLmV4X3N0cl9sZW4sIGVfc2FtX3JlY29yZC5CRCwgZV9zYW1fcmVjb3JkLkJEX2xl
biwgZV9zYW1fcmVjb3JkLkJJLCBlX3NhbV9yZWNvcmQuQklfbGVuLCAnXHQnKTsKCgoJCQkJbWVt
Y3B5KGVfc2FtX3JlY29yZC5leF9zdHIsIGV4X3N0ciwgZV9zYW1fcmVjb3JkLmV4X3N0cl9sZW4p
OwoKCQkJCS8vZ3B1X3Rvb2xzOjpwcmludF9pdGVtKGVfc2FtX3JlY29yZC5leF9zdHIsIGVfc2Ft
X3JlY29yZC5leF9zdHJfbGVuKTsKCgkJCQkvL0RFTF9BUlJfTUVNKGV4X3N0cik7CgoJCQl9CgoK
CgoJCX0KCQlERUxfQVJSX01FTShlX3NhbV9yZWNvcmQuQkQpOyAvLyBkZWwgbWVtIDIwMTgwODA4
MTQwMgoJCURFTF9BUlJfTUVNKGVfc2FtX3JlY29yZC5CSSk7IC8vIGRlbCBtZW0gMjAxODA4MDgx
NDAzCgoJCURFTF9BUlJfTUVNKHF1YWxzKTsgIC8vIGRlbCBtZW0gMiAKCgkJLy8gY2FsIGVuZCAK
CQlmb3IgKGludCBpID0gMDsgaSA8IDM7IGkrKykKCQl7CgkJCS8vREVMX0FSUl9NRU0ocmVhZENv
dmFyaWF0ZXNBcnJbaV0pOyAgLy9qZF8KCQl9CgoJCS8vREVMX0FSUl9NRU0ocmVhZENvdmFyaWF0
ZXNBcnIpOwoJCWFzc2VydChncHVfcFtpZHhdLnAgPT0gZV9zYW1fcmVjb3JkLnApOyAKCQlpbnQg
cmV0X2xlbiA9IGVfc2FtX3JlY29yZC5leF9zdHIgLSBlX3NhbV9yZWNvcmQucCArIGVfc2FtX3Jl
Y29yZC5leF9zdHJfbGVuOwoKCQkvL2dwdV90b29sczo6cHJpbnRfaXRlbShlX3NhbV9yZWNvcmQu
cCxyZXRfbGVuKTsKCQlncHVfcFtpZHhdLnBbcmV0X2xlbl0gPSAnXDAnOwoJCWdwdV9wW2lkeF0u
bGVuID0gcmV0X2xlbjsKCgl9ICAgLy8gZW5kIGlmIGlkeCAKCgoKCgp9CgoKc3RyaW5nIGdwdV90
b29sczo6cmVhZF9oZWFkKGlmc3RyZWFtICZpZl8pCnsKICAgIHN0cmluZyBoZWFkZXIoIiIpOyAK
CXN0cmluZyBlX2xpbmU7CiAgICAKICAgCgl3aGlsZSAoIWlmXy5lb2YoKSkKCXsKCQlzdGQ6Omdl
dGxpbmUoaWZfLCBlX2xpbmUpOwoKCQlpZiAoZV9saW5lWzBdICE9ICdAJykKCQl7CiNpZiBfX2xp
bnV4X18KCQkJaWZfLnNlZWtnKGlmXy50ZWxsZygpIC0gKHN0cmVhbXBvcyllX2xpbmUuc2l6ZSgp
IC0gMSk7CiNlbHNlCgkJCWlmXy5zZWVrZyhpZl8udGVsbGcoKSAtIChzdHJlYW1wb3MpZV9saW5l
LnNpemUoKSAtIDItMik7CiNlbmRpZgoJCQkvL2lmXy5zZWVrZygtNSwgaW9zOjpjdXIpOyAgCgkJ
CWJyZWFrOwoKCQl9CgogICAgICAgIGhlYWRlciArPSBlX2xpbmUgKyAiXG4iOwoKCX0KCgogICAg
cmV0dXJuIGhlYWRlcjsKfQoKdm9pZCBncHVfdG9vbHM6OnNob3dfY3VkYV9pbmZvKGludCBmbGFn
X3Nob3cpCnsKCglpbnQgZGV2SUQ7CgljdWRhRGV2aWNlUHJvcCBwcm9wczsKCgoKCS8vIFRoaXMg
d2lsbCBwaWNrIHRoZSBiZXN0IHBvc3NpYmxlIENVREEgY2FwYWJsZSBkZXZpY2UKCWludCBhcmdj
ID0gMDsKCWNoYXIgKiogYXJndiA9IE5VTEw7CglkZXZJRCA9IGZpbmRDdWRhRGV2aWNlKGFyZ2Ms
IChjb25zdCBjaGFyICoqKWFyZ3YpOwoKCS8vR2V0IEdQVSBpbmZvcm1hdGlvbgoJQ1VEQV9DSEVD
S19SRVRVUk4oY3VkYUdldERldmljZSgmZGV2SUQpKTsKCUNVREFfQ0hFQ0tfUkVUVVJOKGN1ZGFH
ZXREZXZpY2VQcm9wZXJ0aWVzKCZwcm9wcywgZGV2SUQpKTsKCgkoZmxhZ19zaG93KSAmJiBwcmlu
dGYoIi0gRGV2aWNlICVkOiBcIiVzXCIgd2l0aCBDb21wdXRlICVkLiVkIGNhcGFiaWxpdHlcbiIs
IGRldklELCBwcm9wcy5uYW1lLCBwcm9wcy5tYWpvciwgcHJvcHMubWlub3IpOwoJLy8oZmxhZ19z
aG93KSAmJiBjb3V0IDw8ICItIHByb3BzLnBhZ2VhYmxlTWVtb3J5QWNjZXNzOiAiIDw8IHByb3Bz
LnBhZ2VhYmxlTWVtb3J5QWNjZXNzICA8PCBlbmRsOwoJKGZsYWdfc2hvdykgJiYgcHJpbnRmKCIt
IGRldmljZVByb3BlcnRpZXMubWF4VGhyZWFkc1BlckJsb2NrOiAlZFxuIiwgcHJvcHMubWF4VGhy
ZWFkc1BlckJsb2NrKTsgIC8vIDEwMjQKCS8vIChmbGFnX3Nob3cpICYmIHByaW50ZigiLSBkZXZp
Y2VQcm9wZXJ0aWVzLm1heEdyaWRTaXplOiAlZFxuIiwgcHJvcHMubWF4R3JpZFNpemUpOyAgLy8g
CgoJKGZsYWdfc2hvdykgJiYgcHJpbnRmKCItIGRldmljZVByb3BlcnRpZXMubWF4R3JpZFNpemVb
MF06ICVkXG4iLCBwcm9wcy5tYXhHcmlkU2l6ZVswXSk7ICAvLyAKCShmbGFnX3Nob3cpICYmIHBy
aW50ZigiLSBkZXZpY2VQcm9wZXJ0aWVzLm1heEdyaWRTaXplWzFdOiAlZFxuIiwgcHJvcHMubWF4
R3JpZFNpemVbMV0pOyAgLy8gCgkoZmxhZ19zaG93KSAmJiBwcmludGYoIi0gZGV2aWNlUHJvcGVy
dGllcy5tYXhHcmlkU2l6ZVsyXTogJWRcbiIsIHByb3BzLm1heEdyaWRTaXplWzJdKTsgIC8vIAoJ
Ly8oZmxhZ19zaG93KSAmJiBwcmludGYoIi0gZGV2aWNlUHJvcGVydGllcy5tYXhUaHJlYWRzUGVy
TXVsdGlQcm9jZXNzb3I6ICVkXG4iLCBwcm9wcy5tYXhUaHJlYWRzUGVyTXVsdGlQcm9jZXNzb3Ip
OyAgLy8gCgoKCShmbGFnX3Nob3cpICYmIHByaW50ZigiXG4tIFslc10gaGFzICVkIE1QKHMpIHgg
JWQgKENvcmVzL01QKSA9ICVkIChDb3JlcylcbiIsCgkJCXByb3BzLm5hbWUsIHByb3BzLm11bHRp
UHJvY2Vzc29yQ291bnQsCgkJCV9Db252ZXJ0U01WZXIyQ29yZXMocHJvcHMubWFqb3IsIHByb3Bz
Lm1pbm9yKSwKCQkJX0NvbnZlcnRTTVZlcjJDb3Jlcyhwcm9wcy5tYWpvciwgcHJvcHMubWlub3Ip
ICogcHJvcHMubXVsdGlQcm9jZXNzb3JDb3VudCk7Cgp9CgoKLy8gZ3B1X3Rvb2xzX18gZW5kCgov
LyNpbmNsdWRlICJzYW10b29scy5jcHAiCi8vIHNhbXRvb2xzX18gc3RhcnQKCl9fZGV2aWNlX18g
dm9pZCBzYW10b29sczo6c2V0QmFzZVF1YWxpdGllcyhjaGFyKiBxdWFscywgc2FtX3JlY29yZCAm
IGVfc2FtX3JlY29yZCwgaW50ICYgZXZlbnRPcmQpCnsKICAgIHN3aXRjaCAoZXZlbnRPcmQpCiAg
ICB7CiAgICBjYXNlIDA6CiAgICAgICAgLy9lX3NhbV9yZWNvcmQucXVhbCA9IHF1YWxzOwogICAg
ICAgIG1lbWNweShlX3NhbV9yZWNvcmQucXVhbCwgcXVhbHMsIHNpemVvZihjaGFyKSAqIGVfc2Ft
X3JlY29yZC5xdWFsX2xlbik7CiAgICAgICAgYnJlYWs7CiAgICBjYXNlIDE6CiAgICAgICAgLy9l
X3NhbV9yZWNvcmQuQkkgPSAiQkk6WjoiICsgcXVhbHM7Cglhc3NlcnQoTlVMTCAhPSAgZV9zYW1f
cmVjb3JkLkJJKTsKICAgICAgICBtZW1jcHkoZV9zYW1fcmVjb3JkLkJJLCAiQkk6WjoiLCA1KTsK
ICAgICAgICBtZW1jcHkoZV9zYW1fcmVjb3JkLkJJICsgNSwgcXVhbHMsIHNpemVvZihjaGFyKSAq
IGVfc2FtX3JlY29yZC5xdWFsX2xlbik7CiAgICAgICAgZV9zYW1fcmVjb3JkLkJJWzUgKyBlX3Nh
bV9yZWNvcmQucXVhbF9sZW5dID0gJ1wwJzsKICAgICAgICBlX3NhbV9yZWNvcmQuQklfbGVuID0g
NSArIHNpemVvZihjaGFyKSAqIGVfc2FtX3JlY29yZC5xdWFsX2xlbjsKCiAgICAgICAgYnJlYWs7
CgogICAgY2FzZSAyOgogICAgICAgIC8vZV9zYW1fcmVjb3JkLkJEID0gIkJEOlo6IiArIHF1YWxz
OwoKCWFzc2VydChOVUxMICE9IGVfc2FtX3JlY29yZC5CRCk7CgogICAgICAgIG1lbWNweShlX3Nh
bV9yZWNvcmQuQkQsICJCRDpaOiIsIDUpOwogICAgICAgIG1lbWNweShlX3NhbV9yZWNvcmQuQkQg
KyA1LCBxdWFscywgc2l6ZW9mKGNoYXIpICogZV9zYW1fcmVjb3JkLnF1YWxfbGVuKTsKICAgICAg
ICBlX3NhbV9yZWNvcmQuQkRbNSArIGVfc2FtX3JlY29yZC5xdWFsX2xlbl0gPSAnXDAnOwogICAg
ICAgIGVfc2FtX3JlY29yZC5CRF9sZW4gPSA1ICsgc2l6ZW9mKGNoYXIpICogZV9zYW1fcmVjb3Jk
LnF1YWxfbGVuOwogICAgICAgIGJyZWFrOwogICAgZGVmYXVsdDoKICAgICAgICBicmVhazsKICAg
IH0KfQoKCl9fZGV2aWNlX18gdm9pZCBzYW10b29sczo6Z2V0QmFzZVF1YWxpdGllcyhzYW1fcmVj
b3JkICYgZV9zYW1fcmVjb3JkLCBpbnQgJmV2ZW50T3JkLCBjaGFyKiBxdWFscykKewogICAgLy9z
dHJpbmcgcXVhbHM7CiAgICBzd2l0Y2ggKGV2ZW50T3JkKQogICAgewogICAgY2FzZSAwOgogICAg
ICAgIC8vcXVhbHMgPSBlX3NhbV9yZWNvcmQucXVhbDsKICAgICAgICBtZW1jcHkocXVhbHMsIGVf
c2FtX3JlY29yZC5xdWFsLCBlX3NhbV9yZWNvcmQucXVhbF9sZW4pOwogICAgICAgIGJyZWFrOwog
ICAgY2FzZSAxOgogICAgY2FzZSAyOgogICAgICAgIC8vcXVhbHMgPSBzdHJpbmcoZV9zYW1fcmVj
b3JkLnF1YWwubGVuZ3RoKCksICdOJyk7CiAgICAgICAgbWVtc2V0KHF1YWxzLCAnTicsIGVfc2Ft
X3JlY29yZC5xdWFsX2xlbik7CiAgICAgICAgYnJlYWs7CiAgICBkZWZhdWx0OgogICAgICAgIGJy
ZWFrOwogICAgfQogICAgLy9yZXR1cm4gcXVhbHM7Cn0KCgpfX2RldmljZV9fIHZvaWQgc2FtdG9v
bHM6OnNpbXBsZVJldmVyc2VDb21wbGVtZW50KGNoYXIqIGJhc2VzLCBpbnQgYmFzZXNfbGVuKQp7
CiAgICAvL3N0cmluZyByY2Jhc2VzID0gIiI7CiAgICBjaGFyICpyY2Jhc2VzID0gbmV3IGNoYXJb
YmFzZXNfbGVuXTsKCiAgICBpbnQgJnJlYWRMZW5ndGggPSBiYXNlc19sZW47CiAgICBpbnQgY250
X2Jhc2VzID0gMDsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcmVhZExlbmd0aDsgaSsrKQogICAg
ewogICAgICAgIHN3aXRjaCAoYmFzZXNbcmVhZExlbmd0aCAtIDEgLSBpXSkKICAgICAgICB7CiAg
ICAgICAgY2FzZSAnQSc6CiAgICAgICAgY2FzZSAnYSc6CiAgICAgICAgICAgIHJjYmFzZXNbY250
X2Jhc2VzXSA9ICdUJzsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnQyc6CiAgICAg
ICAgY2FzZSAnYyc6CiAgICAgICAgICAgIHJjYmFzZXNbY250X2Jhc2VzXSAgPSAnRyc7CiAgICAg
ICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ0cnOgogICAgICAgIGNhc2UgJ2cnOgogICAgICAg
ICAgICByY2Jhc2VzW2NudF9iYXNlc10gPSAnQyc7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAg
IGNhc2UgJ1QnOgogICAgICAgIGNhc2UgJ3QnOgogICAgICAgICAgICByY2Jhc2VzW2NudF9iYXNl
c10gID0gJ0EnOwogICAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAg
ICByY2Jhc2VzW2NudF9iYXNlc10gID0gYmFzZXNbcmVhZExlbmd0aCAtIDEgLSBpXTsKICAgICAg
ICB9CiAgICAgICAgY250X2Jhc2VzKys7CiAgICB9CgogICAgbWVtY3B5KGJhc2VzLCByY2Jhc2Vz
LCByZWFkTGVuZ3RoICogc2l6ZW9mKGNoYXIpKTsKICAgIGRlbGV0ZVtdIHJjYmFzZXM7IAogICAg
Ly9yZXR1cm4gcmNiYXNlczsKfQoKX19kZXZpY2VfXyBib29sIHNhbXRvb2xzOjpnZXRSZWFkTmVn
YXRpdmVTdHJhbmRGbGFnKHNhbV9yZWNvcmQmIGVfc2FtX3JlY29yZCkKewogICAgcmV0dXJuIChl
X3NhbV9yZWNvcmQuZmxhZyAmIGdsb2JhbEI6OlJFQURfU1RSQU5EX0ZMQUcpICE9IDA7Cn0KCgpf
X2RldmljZV9fIF9faG9zdF9fIGludCBzYW10b29sczo6a2V5RnJvbUN5Y2xlKGludCAmIGN5Y2xl
KQp7CiAgICAvLyBHQVRLOm5vIG5lZ2F0aXZlIHZhbHVlcyBiZWNhdXNlIHZhbHVlcyBtdXN0IGZp
dCBpbnRvIHRoZSBmaXJzdCBmZXcgYml0cyBvZiB0aGUgbG9uZwogICAgaW50IHJlc3VsdCA9IGFi
cyhjeWNsZSk7CiAgICByZXN1bHQgPSByZXN1bHQgPDwgMTsgLy8gc2hpZnQgc28gd2UgY2FuIGFk
ZCB0aGUgInNpZ24iIGJpdAogICAgaWYgKGN5Y2xlIDwgMCkKICAgICAgICByZXN1bHQrKzsgLy8g
bmVnYXRpdmUgY3ljbGVzIGdldCB0aGUgbG93ZXItbW9zdCBiaXQgc2V0CiAgICByZXR1cm4gcmVz
dWx0Owp9CgppbnQgc2FtdG9vbHM6OnNpbXBsZUJhc2VUb0Jhc2VJbmRleChjb25zdCBjaGFyICYg
YmFzZSkKewogICAgaWYgKGJhc2UgPCAwIHx8IGJhc2UgPj0gMjU2KQogICAgewogICAgICAgIGF1
dG8gYSA9IGJhc2U7CiAgICAgICAgLy9jb3V0IDw8IGEgPDwgZW5kbDsKICAgICAgICBwcmludGYo
IiVkXG4iLCBhKTsKICAgICAgICBwcmludGYoIk5vbi1zdGFuZGFyZCBiYXNlcyB3ZXJlIGVuY291
bnRlcmVkIGluIGVpdGhlciB0aGUgaW5wdXQgcmVmZXJlbmNlIG9yIEJBTSBmaWxlKHMpIik7CiAg
ICAgICAgLy9wcmludGYoIkVycm9yIG9wZW5pbmcgZmlsZSB1bmV4aXN0LmVudDogJXNcbiIsIHN0
cmVycm9yKGVycm5vKSk7CiAgICAgICAgYXNzZXJ0KDAgPD0gYmFzZSAmJiBiYXNlIDwgMjU2KTsK
ICAgIH0KICAgIGlmIChiYXNlID09ICdBJyB8fCBiYXNlID09ICdhJyB8fCBiYXNlID09ICcqJykK
ICAgIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KICAgIGlmIChiYXNlID09ICdDJyB8fCBiYXNl
ID09ICdjJykKICAgIHsKICAgICAgICByZXR1cm4gMTsKICAgIH0KICAgIGlmIChiYXNlID09ICdH
JyB8fCBiYXNlID09ICdnJykKICAgIHsKICAgICAgICByZXR1cm4gMjsKICAgIH0KICAgIGlmIChi
YXNlID09ICdUJyB8fCBiYXNlID09ICd0JykKICAgIHsKICAgICAgICByZXR1cm4gMzsKICAgIH0K
ICAgIHJldHVybiAtMTsKfQoKX19kZXZpY2VfXyBpbnQgc2FtdG9vbHM6Ol9fZGV2aWNlX19zaW1w
bGVCYXNlVG9CYXNlSW5kZXgoY29uc3QgY2hhciAmIGJhc2UpCnsKICAgIGlmIChiYXNlIDwgMCB8
fCBiYXNlID49IDI1NikKICAgIHsKICAgICAgICBhdXRvIGEgPSBiYXNlOwogICAgICAgIC8vY291
dCA8PCBhIDw8IGVuZGw7CiAgICAgICAgcHJpbnRmKCIlZFxuIiwgYSk7CiAgICAgICAgcHJpbnRm
KCJOb24tc3RhbmRhcmQgYmFzZXMgd2VyZSBlbmNvdW50ZXJlZCBpbiBlaXRoZXIgdGhlIGlucHV0
IHJlZmVyZW5jZSBvciBCQU0gZmlsZShzKSIpOwogICAgICAgIC8vcHJpbnRmKCJFcnJvciBvcGVu
aW5nIGZpbGUgdW5leGlzdC5lbnQ6ICVzXG4iLCBzdHJlcnJvcihlcnJubykpOwogICAgICAgIGFz
c2VydCgwIDw9IGJhc2UgJiYgYmFzZSA8IDI1Nik7CiAgICB9CiAgICBpZiAoYmFzZSA9PSAnQScg
fHwgYmFzZSA9PSAnYScgfHwgYmFzZSA9PSAnKicpCiAgICB7CiAgICAgICAgcmV0dXJuIDA7CiAg
ICB9CiAgICBpZiAoYmFzZSA9PSAnQycgfHwgYmFzZSA9PSAnYycpCiAgICB7CiAgICAgICAgcmV0
dXJuIDE7CiAgICB9CiAgICBpZiAoYmFzZSA9PSAnRycgfHwgYmFzZSA9PSAnZycpCiAgICB7CiAg
ICAgICAgcmV0dXJuIDI7CiAgICB9CiAgICBpZiAoYmFzZSA9PSAnVCcgfHwgYmFzZSA9PSAndCcp
CiAgICB7CiAgICAgICAgcmV0dXJuIDM7CiAgICB9CiAgICByZXR1cm4gLTE7Cn0KCmludCBzYW10
b29sczo6a2V5RnJvbUNvbnRleHQoc3RyaW5nICZiYXNlcywgY29uc3QgaW50ICYgc3RhcnQsIGNv
bnN0IGludCAmIGVuZCkKewogICAgaW50IGtleSA9IGVuZCAtIHN0YXJ0OwogICAgaW50IGJpdE9m
ZnNldCA9IGdsb2JhbEI6OkxFTkdUSF9CSVRTOwogICAgZm9yIChpbnQgaSA9IHN0YXJ0OyBpIDwg
ZW5kOyBpKyspIHsKICAgICAgICBpbnQgYmFzZUluZGV4ID0gc2FtdG9vbHM6OnNpbXBsZUJhc2VU
b0Jhc2VJbmRleChiYXNlc1tpXSk7CiAgICAgICAgaWYgKGJhc2VJbmRleCA9PSAtMSkgLy8gaWdu
b3JlIG5vbi1BQ0dUIGJhc2VzCiAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICBrZXkgfD0g
KGJhc2VJbmRleCA8PCBiaXRPZmZzZXQpOwogICAgICAgIGJpdE9mZnNldCArPSAyOwogICAgfQog
ICAgcmV0dXJuIGtleTsKfQoKX19kZXZpY2VfXyBpbnQgc2FtdG9vbHM6Ol9fZGV2aWNlX19rZXlG
cm9tQ29udGV4dChjaGFyICogYmFzZXMsIGludCBiYXNlc19sZW4sIGNvbnN0IGludCAmIHN0YXJ0
LCBjb25zdCBpbnQgJiBlbmQpCnsKICAgIGludCBrZXkgPSBlbmQgLSBzdGFydDsKICAgIGludCBi
aXRPZmZzZXQgPSBnbG9iYWxCOjpMRU5HVEhfQklUUzsKICAgIGZvciAoaW50IGkgPSBzdGFydDsg
aSA8IGVuZDsgaSsrKSB7CiAgICAgICAgaW50IGJhc2VJbmRleCA9IHNhbXRvb2xzOjpfX2Rldmlj
ZV9fc2ltcGxlQmFzZVRvQmFzZUluZGV4KGJhc2VzW2ldKTsKICAgICAgICBpZiAoYmFzZUluZGV4
ID09IC0xKSAvLyBpZ25vcmUgbm9uLUFDR1QgYmFzZXMKICAgICAgICAgICAgcmV0dXJuIC0xOwog
ICAgICAgIGtleSB8PSAoYmFzZUluZGV4IDw8IGJpdE9mZnNldCk7CiAgICAgICAgYml0T2Zmc2V0
ICs9IDI7CiAgICB9CiAgICByZXR1cm4ga2V5Owp9CgoKCl9fZGV2aWNlX18gaW50IHNhbXRvb2xz
OjpnZXRSZWFkTGVuZ3RoRm9yQ2lnYXIoc3RydWN0IGJnaXRvb2xzOjpDSUdBUiAqIGNpZ2FyX21h
cCwgaW50IGNpZ2FyX21hcF9sZW4pCnsKCWludCBsZW5ndGggPSAwOwoJZm9yIChpbnQgaSA9IDA7
IGkgPCBjaWdhcl9tYXBfbGVuOyBpKyspCgl7CgkJc3RydWN0IGJnaXRvb2xzOjpDSUdBUiBlbHQg
PSBjaWdhcl9tYXBbaV07CgkJaWYgKGJnaXRvb2xzOjpjaWdhck9wZXJhdG9yKGVsdC5vcHQpLmNv
bnN1bWVzUmVhZEJhc2VzKQoJCXsKCQkJbGVuZ3RoICs9IGVsdC5sZW5ndGg7CgkJfQoJfQoJcmV0
dXJuIGxlbmd0aDsKfQoKCl9fZGV2aWNlX18gc2FtX3JlY29yZCBzYW10b29sczo6Y2xpcExvd1F1
YWxFbmRzKHNhbV9yZWNvcmQgJiBlX3NhbV9yZWNvcmQsIGNvbnN0IGNoYXIgbG93UXVhbCwgY29u
c3Qgc2FtdG9vbHM6OkNsaXBwaW5nUmVwcmVzZW50YXRpb24gJiBhbGdvcml0aG0pCnsKCWNoYXIq
IHF1YWxzID0gZV9zYW1fcmVjb3JkLnF1YWw7CgoJaW50IHJlYWRMZW5ndGggPSBlX3NhbV9yZWNv
cmQuc2VxX2xlbjsKCWludCBsZWZ0Q2xpcEluZGV4ID0gMDsKCWludCByaWdodENsaXBJbmRleCA9
IHJlYWRMZW5ndGggLSAxOwoKCS8vIGNoZWNrIGhvdyBmYXIgd2UgY2FuIGNsaXAgYm90aCBzaWRl
cwoJd2hpbGUgKHJpZ2h0Q2xpcEluZGV4ID49IDAgJiYgKHF1YWxzW3JpZ2h0Q2xpcEluZGV4XSAt
IDMzKSA8PSBsb3dRdWFsKSByaWdodENsaXBJbmRleC0tOwoJd2hpbGUgKGxlZnRDbGlwSW5kZXgg
PCByZWFkTGVuZ3RoICYmIChxdWFsc1tsZWZ0Q2xpcEluZGV4XSAtIDMzKSA8PSBsb3dRdWFsKSBs
ZWZ0Q2xpcEluZGV4Kys7CgoJLy8gaWYgdGhlIGVudGlyZSByZWFkIHNob3VsZCBiZSBjbGlwcGVk
LCB0aGVuIHJldHVybiBhbiBlbXB0eSByZWFkLgoJaWYgKGxlZnRDbGlwSW5kZXggPiByaWdodENs
aXBJbmRleCkKCXsKCQlzYW1fcmVjb3JkIGVtcHR5UmVhZCA9IGVfc2FtX3JlY29yZDsKCQllbXB0
eVJlYWQucG9zID0gMDsKCQllbXB0eVJlYWQuc2VxID0gTlVMTDsKCQllbXB0eVJlYWQuY2lnYXIg
PSBOVUxMOwoJCXJldHVybiBlbXB0eVJlYWQ7Cgl9CgoJY29uc3QgaW50IE9QX1NaID0gMjsKCWlu
dDIgb3BbT1BfU1pdID0geyB7LTEsLTF9LCB7LTEsLTF9IH07CglpbnQgb3BfaWR4ID0gMDsKCWlm
IChyaWdodENsaXBJbmRleCA8IHJlYWRMZW5ndGggLSAxKQoJewoJCS8vcGFpcjxpbnQsIGludD4g
b3AxOwoKCQlvcFtvcF9pZHhdLnggPSByaWdodENsaXBJbmRleCArIDE7CgkJb3Bbb3BfaWR4XS55
ID0gcmVhZExlbmd0aCAtIDE7CgkJLy9vcC5wdXNoX2JhY2sob3AxKTsKCQlvcF9pZHgrKzsKCX0K
CglpZiAobGVmdENsaXBJbmRleCA+IDApCgl7CgkJLy9wYWlyPGludCwgaW50PiBvcDI7CgkJb3Bb
b3BfaWR4XS54ID0gMDsKCQlvcFtvcF9pZHhdLnkgPSBsZWZ0Q2xpcEluZGV4IC0gMTsKCQkvL29w
LnB1c2hfYmFjayhvcDIpOwoJCW9wX2lkeCsrOwoJfQoKCWlmIChvcF9pZHggPT0gMCkKCXsKCQly
ZXR1cm4gZV9zYW1fcmVjb3JkOwoKCX0KCglmb3IgKGludCBqID0gMDsgaiA8IG9wX2lkeDsgaisr
KQoJewoJCXN3aXRjaCAoYWxnb3JpdGhtKQoJCXsKCQkJY2FzZSBzYW10b29sczo6Q2xpcHBpbmdS
ZXByZXNlbnRhdGlvbjo6V1JJVEVfTlM6CgkJCQlmb3IgKGludCBpID0gMDsgaSA8IHJlYWRMZW5n
dGg7IGkrKykKCQkJCXsKCQkJCQlpZiAoaSA+PSBvcFtqXS54ICYmIGkgPD0gb3Bbal0ueSkgCgkJ
CQkJewoJCQkJCQllX3NhbV9yZWNvcmQuc2VxW2ldID0gJ04nOwoJCQkJCX0KCQkJCX0KCQkJCWJy
ZWFrOwoJCQlkZWZhdWx0OgoJCQkJcHJpbnRmKCJVbmV4cGVjdGVkIENsaXBwaW5nIG9wZXJhdG9y
IHR5cGUiKTsKCQkJCWFzc2VydCgwID09IDEpOwoJCX0KCX0KCXJldHVybiBlX3NhbV9yZWNvcmQ7
Cn0KCgoKX19kZXZpY2VfXyBib29sIHNhbXRvb2xzOjpnZXRTZWNvbmRPZlBhaXJGbGFnKGNvbnN0
IGludCAmIGZsYWcpCnsKCWlmICghc2FtdG9vbHM6OmdldFJlYWRQYWlyZWRGbGFnKGZsYWcpKQoJ
ewoJCXByaW50ZigiSSIpOwoJCWFzc2VydCgwID09IDEpOwoJfQoJcmV0dXJuIChmbGFnICYgZ2xv
YmFsQjo6U0VDT05EX09GX1BBSVJfRkxBRykgIT0gMDsKfQoKX19kZXZpY2VfXyBib29sIHNhbXRv
b2xzOjpnZXRSZWFkUGFpcmVkRmxhZyhjb25zdCBpbnQgJiBmbGFnKQp7CglyZXR1cm4gKGZsYWcg
JiBnbG9iYWxCOjpSRUFEX1BBSVJFRF9GTEFHKSAhPSAwOwp9CgpfX2RldmljZV9fIGJvb2wgc2Ft
dG9vbHM6OmdldFJlYWRVbm1hcHBlZEZsYWcoc2FtX3JlY29yZCAmIGVfc2FtX3JlY29yZCkgCnsK
CXJldHVybiAoKGVfc2FtX3JlY29yZC5mbGFnICYgZ2xvYmFsQjo6UkVBRF9VTk1BUFBFRF9GTEFH
KSAhPSAwKTsKfQoKCi8vIHNhbXRvb2xzX18gZW5kIAoKLy8jaW5jbHVkZSAiZ3JwdG9vbHMuY3Bw
IgovLyBncnB0b29sc19fIHN0YXJ0IApkb3VibGUgZ3JwdG9vbHM6OmxvZzEwR2FtbWEoY29uc3Qg
ZG91YmxlICYgeCkKewogICAgcmV0dXJuIGxuVG9Mb2cxMChsZ2FtbWEoeCkpOwp9CmRvdWJsZSBn
cnB0b29sczo6bG5Ub0xvZzEwKGNvbnN0IGRvdWJsZSAmIGxuKQp7CiAgICByZXR1cm4gbG4gKiBs
b2cxMChnbG9iYWxCOjpNQVRIX0UpOwp9CgoKCmRvdWJsZSBncnB0b29sczo6bG9nMTBGYWN0b3Jp
YWwoY29uc3QgaW50ICYgeCkKewogICAgaWYgKHggPj0gZ2xvYmFsQjo6TE9HMTBfQ0FDSEVfU0la
RSB8fCB4IDwgMCkKICAgICAgICByZXR1cm4gbG9nMTBHYW1tYSh4ICsgMSk7CiAgICBlbHNlCiAg
ICAgICAgcmV0dXJuIGdsb2JhbEI6OkxvZzEwRmFjdG9yaWFsQ2FjaGVbeF07Cn0KCgpkb3VibGUg
Z3JwdG9vbHM6OmxvZzEwQmlub21pYWxDb2VmZmljaWVudChjb25zdCBpbnQgJiBuLCBjb25zdCBp
bnQgJiBrKQp7CiAgICBpZiAobiA8IDApIHsKICAgICAgICBwcmludGYoIm46IE11c3QgaGF2ZSBu
b24tbmVnYXRpdmUgbnVtYmVyIG9mIHRyaWFscyIpOwogICAgICAgIGFzc2VydChuID49IDApOwog
ICAgfQogICAgaWYgKGsgPiBuIHx8IGsgPCAwKSB7CiAgICAgICAgcHJpbnRmKCJrOiBNdXN0IGhh
dmUgbm9uLW5lZ2F0aXZlIG51bWJlciBvZiBzdWNjZXNzZXMsIGFuZCBubyBtb3JlIHN1Y2Nlc3Nl
cyB0aGFuIG51bWJlciBvZiB0cmlhbHMiKTsKICAgICAgICBhc3NlcnQoayA8PSBuICYmIGsgPj0g
MCk7CiAgICB9CgogICAgcmV0dXJuIGxvZzEwRmFjdG9yaWFsKG4pIC0gbG9nMTBGYWN0b3JpYWwo
aykgLSBsb2cxMEZhY3RvcmlhbChuIC0gayk7Cn0KCmRvdWJsZSBncnB0b29sczo6bG9nMTBCaW5v
bWlhbFByb2JhYmlsaXR5KGNvbnN0IGludCAmIG4sIGNvbnN0IGludCAmIGssIGNvbnN0IGRvdWJs
ZSAmIGxvZzEwcCkKewogICAgaWYgKGxvZzEwcCA+IDFlLTE4KQogICAgewogICAgICAgIHByaW50
ZigibG9nMTBwOiBMb2ctcHJvYmFiaWxpdHkgbXVzdCBiZSAwIG9yIGxlc3MiKTsKICAgICAgICBh
c3NlcnQobG9nMTBwIDw9IDApOwogICAgfQogICAgZG91YmxlIGxvZzEwT25lTWludXNQID0gbG9n
MTAoMSAtIHBvdygxMCwgbG9nMTBwKSk7CiAgICByZXR1cm4gbG9nMTBCaW5vbWlhbENvZWZmaWNp
ZW50KG4sIGspICsgbG9nMTBwICogayArIGxvZzEwT25lTWludXNQICogKG4gLSBrKTsKfQoKZG91
YmxlIGdycHRvb2xzOjpxdWFsVG9FcnJvclByb2JMb2cxMChkb3VibGUgJiBxdWFsKQp7CiAgICBp
ZiAocXVhbCA8IDAuMCkKICAgIHsKICAgICAgICBjb3V0IDw8ICJxdWFsIG11c3QgYmUgPj0gMC4w
IGJ1dCBnb3QgIiA8PCBxdWFsIDw8IGVuZGw7CiAgICAgICAgYXNzZXJ0KHF1YWwgPj0gMC4wKTsK
ICAgIH0KICAgIHJldHVybiBxdWFsIC8gKC0xMC4wKTsKfQoKCmRvdWJsZSBncnB0b29sczo6bG9n
MTBRZW1wTGlrZWxpaG9vZChkb3VibGUgJiBRZW1waXJpY2FsLCBsb25nICYgbk9ic2VydmF0aW9u
cywgbG9uZyAmIG5FcnJvcnMpCnsKICAgIGlmIChuT2JzZXJ2YXRpb25zID09IDApCiAgICAgICAg
cmV0dXJuIDAuMDsKCiAgICAvLyBHQVRLOnRoZSBiaW5vbWlhbCBjb2RlIHJlcXVpcmVzIGludHMg
YXMgaW5wdXQgKGJlY2F1c2UgaXQgZG9lcyBjYWNoaW5nKS4gIFRoaXMgc2hvdWxkIHRoZW9yZXRp
Y2FsbHkgYmUgZmluZSBiZWNhdXNlCiAgICAvLyB0aGVyZSBpcyBwbGVudHkgb2YgcHJlY2lzaW9u
IGluIDJeMzEgb2JzZXJ2YXRpb25zLCBidXQgd2UgbmVlZCB0byBtYWtlIHN1cmUgdGhhdCB3ZSBk
b24ndCBoYXZlIG92ZXJmbG93CiAgICAvLyBiZWZvcmUgY2FzdGluZyBkb3duIHRvIGFuIGludC4K
ICAgIGlmIChuT2JzZXJ2YXRpb25zID4gZ2xvYmFsQjo6TUFYX05VTUJFUl9PRl9PQlNFUlZBVElP
TlMpIHsKICAgICAgICAvLyB3ZSBuZWVkIHRvIGRlY3JlYXNlIG5FcnJvcnMgYnkgdGhlIHNhbWUg
ZnJhY3Rpb24gdGhhdCB3ZSBhcmUgZGVjcmVhc2luZyBuT2JzZXJ2YXRpb25zCiAgICAgICAgZG91
YmxlIGZyYWN0aW9uID0gKGRvdWJsZSlnbG9iYWxCOjpNQVhfTlVNQkVSX09GX09CU0VSVkFUSU9O
UyAvIChkb3VibGUpbk9ic2VydmF0aW9uczsKICAgICAgICBuRXJyb3JzID0gcm91bmQoKGRvdWJs
ZSluRXJyb3JzICogZnJhY3Rpb24pOwogICAgICAgIG5PYnNlcnZhdGlvbnMgPSAoZG91YmxlKWds
b2JhbEI6Ok1BWF9OVU1CRVJfT0ZfT0JTRVJWQVRJT05TOwogICAgfQoKICAgIC8vIEdBVEs6dGhp
cyBpcyBqdXN0IGEgc3RyYWlnaHQgYmlub21pYWwgUERGCiAgICBkb3VibGUgbG9nMTBQcm9iID0g
bG9nMTBCaW5vbWlhbFByb2JhYmlsaXR5KChpbnQpbk9ic2VydmF0aW9ucywgKGludCluRXJyb3Jz
LCBxdWFsVG9FcnJvclByb2JMb2cxMChRZW1waXJpY2FsKSk7CiAgICBpZiAoIShzdGQ6OmlzZmlu
aXRlKGxvZzEwUHJvYikpKQogICAgICAgIGxvZzEwUHJvYiA9IC1EQkxfTUFYOwoKICAgIHJldHVy
biBsb2cxMFByb2I7Cn0KCgpkb3VibGUgZ3JwdG9vbHM6OmxvZzEwUWVtcFByaW9yKGRvdWJsZSAm
IFFlbXBpcmljYWwsIGRvdWJsZSAmIFFyZXBvcnRlZCkKewogICAgaW50IGRpZmZlcmVuY2UgPSBt
aW4oYWJzKChpbnQpKFFlbXBpcmljYWwgLSBRcmVwb3J0ZWQpKSwgZ2xvYmFsQjo6TUFYX0dBVEtf
VVNBQkxFX1FfU0NPUkUpOwogICAgcmV0dXJuIGdsb2JhbEI6OmxvZzEwUWVtcFByaW9yQ2FjaGVb
ZGlmZmVyZW5jZV07Cn0KCnZlY3Rvcjxkb3VibGU+IGdycHRvb2xzOjpub3JtYWxpemVGcm9tTG9n
MTAodmVjdG9yPGRvdWJsZT4gJiBhcnJheSwgY29uc3QgYm9vbCAmIHRha2VMb2cxME9mT3V0cHV0
LCBjb25zdCBib29sICYga2VlcEluTG9nU3BhY2UpCnsKICAgIGF1dG8gbWF4X3AgPSBzdGQ6Om1h
eF9lbGVtZW50KHN0ZDo6YmVnaW4oYXJyYXkpLCBzdGQ6OmVuZChhcnJheSkpOwogICAgZG91Ymxl
IG1heFZhbHVlID0gKm1heF9wOwoKICAgIC8vIHdlIG1heSBkZWNpZGUgdG8ganVzdCBub3JtYWxp
emUgaW4gbG9nIHNwYWNlIHdpdGhvdXQgY29udmVydGluZyB0byBsaW5lYXIgc3BhY2UKICAgIGlm
IChrZWVwSW5Mb2dTcGFjZSkgewogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYXJyYXkuc2l6
ZSgpOyBpKyspIHsKICAgICAgICAgICAgYXJyYXlbaV0gLT0gbWF4VmFsdWU7CiAgICAgICAgfQog
ICAgICAgIHJldHVybiBhcnJheTsKICAgIH0KCiAgICAvLyBkZWZhdWx0IGNhc2U6IGdvIHRvIGxp
bmVhciBzcGFjZQogICAgdmVjdG9yPGRvdWJsZT4gbm9ybWFsaXplZChhcnJheS5zaXplKCkpOwoK
ICAgIGZvciAoaW50IGkgPSAwOyBpIDwgYXJyYXkuc2l6ZSgpOyBpKyspCiAgICAgICAgbm9ybWFs
aXplZFtpXSA9IHBvdygxMCwgYXJyYXlbaV0gLSBtYXhWYWx1ZSk7CgogICAgLy8gbm9ybWFsaXpl
CiAgICBkb3VibGUgc3VtID0gMC4wOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBhcnJheS5zaXpl
KCk7IGkrKykKICAgICAgICBzdW0gKz0gbm9ybWFsaXplZFtpXTsKICAgIGZvciAoaW50IGkgPSAw
OyBpIDwgYXJyYXkuc2l6ZSgpOyBpKyspIHsKICAgICAgICBkb3VibGUgeCA9IG5vcm1hbGl6ZWRb
aV0gLyBzdW07CiAgICAgICAgaWYgKHRha2VMb2cxME9mT3V0cHV0KSB7CiAgICAgICAgICAgIHgg
PSBsb2cxMCh4KTsKICAgICAgICAgICAgaWYgKHggPCBnbG9iYWxCOjpMT0cxMF9QX09GX1pFUk8g
fHwgIXN0ZDo6aXNmaW5pdGUoeCkpCiAgICAgICAgICAgICAgICB4ID0gYXJyYXlbaV0gLSBtYXhW
YWx1ZTsKICAgICAgICB9CgogICAgICAgIG5vcm1hbGl6ZWRbaV0gPSB4OwogICAgfQoKICAgIHJl
dHVybiBub3JtYWxpemVkOwp9CgoKCmRvdWJsZSBncnB0b29sczo6YmF5ZXNpYW5Fc3RpbWF0ZU9m
RW1waXJpY2FsUXVhbGl0eShsb25nICYgbk9ic2VydmF0aW9ucywgbG9uZyAmIG5FcnJvcnMsIGRv
dWJsZSAmIFFSZXBvcnRlZCkKewogICAgaW50IG51bUJpbnMgPSAoZ2xvYmFsQjo6TUFYX1JFQVNP
TkFCTEVfUV9TQ09SRSArIDEpICogKGludClnbG9iYWxCOjpSRVNPTFVUSU9OX0JJTlNfUEVSX1FV
QUw7CgogICAgdmVjdG9yPGRvdWJsZT4gbG9nMTBQb3N0ZXJpb3JzOwogICAgbG9nMTBQb3N0ZXJp
b3JzLnJlc2l6ZShudW1CaW5zKTsKICAgIGZvciAoaW50IGJpbiA9IDA7IGJpbiA8IG51bUJpbnM7
IGJpbisrKQogICAgewogICAgICAgIGRvdWJsZSBRRW1wT2ZCaW4gPSBiaW4gLyBnbG9iYWxCOjpS
RVNPTFVUSU9OX0JJTlNfUEVSX1FVQUw7CiAgICAgICAgbG9nMTBQb3N0ZXJpb3JzW2Jpbl0gPSBn
cnB0b29sczo6bG9nMTBRZW1wUHJpb3IoUUVtcE9mQmluLCBRUmVwb3J0ZWQpICsgbG9nMTBRZW1w
TGlrZWxpaG9vZChRRW1wT2ZCaW4sIG5PYnNlcnZhdGlvbnMsIG5FcnJvcnMpOwogICAgfQoKICAg
IHZlY3Rvcjxkb3VibGU+IG5vcm1hbGl6ZWRQb3N0ZXJpb3JzID0gbm9ybWFsaXplRnJvbUxvZzEw
KGxvZzEwUG9zdGVyaW9ycyk7CiAgICBzdGQ6OnZlY3Rvcjxkb3VibGU+OjppdGVyYXRvciBtYXhf
cCA9IHN0ZDo6bWF4X2VsZW1lbnQoc3RkOjpiZWdpbihub3JtYWxpemVkUG9zdGVyaW9ycyksIHN0
ZDo6ZW5kKG5vcm1hbGl6ZWRQb3N0ZXJpb3JzKSk7CiAgICBpbnQgTUxFYmluID0gc3RkOjpkaXN0
YW5jZShzdGQ6OmJlZ2luKG5vcm1hbGl6ZWRQb3N0ZXJpb3JzKSwgbWF4X3ApOyAvL21heEVsZW1l
bnRJbmRleAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETzogd2UgY2FuIGdldCB0aGUgTUxFYmluIGJ5
IGRpcmVjdGx5IG1heCBsb2cxMFBvc3RlcmlvcnMgYXMgaXQgaXMgYSBNb25vdG9uaWNhbGx5LWlu
Y3JlYXNpbmcgZnVuY3Rpb24uCgogICAgZG91YmxlIFFlbXAgPSBNTEViaW4gLyBnbG9iYWxCOjpS
RVNPTFVUSU9OX0JJTlNfUEVSX1FVQUw7CiAgICByZXR1cm4gUWVtcDsKfQoKCgpkb3VibGUgZ3Jw
dG9vbHM6OmdldEVtcGlyaWNhbFF1YWxpdHlfdjEoZG91YmxlICYgY29uZGl0aW9uYWxQcmlvciwg
ZG91YmxlICYgZW1waXJpY2FsUXVhbGl0eSwgZG91YmxlICYgbk9ic2VydmF0aW9ucywgZG91Ymxl
ICYgbnVtTWlzbWF0Y2hlcykKewogICAgbG9uZyBtaXNtYXRjaGVzID0gKGxvbmcpKG51bU1pc21h
dGNoZXMgKyAwLjUpICsgZ2xvYmFsQjo6U01PT1RISU5HX0NPTlNUQU5UOwogICAgLy8gR0FUSzpz
bW9vdGhpbmcgaXMgb25lIGVycm9yIGFuZCBvbmUgbm9uLWVycm9yIG9ic2VydmF0aW9uLCBmb3Ig
ZXhhbXBsZQogICAgbG9uZyBvYnNlcnZhdGlvbnMgPSBuT2JzZXJ2YXRpb25zICsgZ2xvYmFsQjo6
U01PT1RISU5HX0NPTlNUQU5UICsgZ2xvYmFsQjo6U01PT1RISU5HX0NPTlNUQU5UOwogICAgZG91
YmxlIGVtcGlyaWNhbFF1YWwgPSBiYXllc2lhbkVzdGltYXRlT2ZFbXBpcmljYWxRdWFsaXR5KG9i
c2VydmF0aW9ucywgbWlzbWF0Y2hlcywgY29uZGl0aW9uYWxQcmlvcik7CiAgICByZXR1cm4gbWlu
KGVtcGlyaWNhbFF1YWwsIChkb3VibGUpZ2xvYmFsQjo6TUFYX1BIUkVEX1NDT1JFKTsKfQoKCgpf
X2RldmljZV9fIHZvaWQgIGdycHRvb2xzOjpDb21wdXRlQ292YXJpYXRlc192MyhzYW1fcmVjb3Jk
ICYgZV9zYW1fcmVjb3JkLCBncnB0b29sczo6Q1ZLRVkqIHJlYWRDb3ZhcmlhdGVzQXJyLCBpbnQg
cm93cywgaW50IGNvbHMpCnsKICAgIGludCAmcmVhZExlbmd0aCA9IGNvbHM7CgogICAgY2hhciAq
YmFzZXNfY29weSA9IG5ldyBjaGFyW3JlYWRMZW5ndGhdOyAvLyBtZW0gMAogICAgYXNzZXJ0KE5V
TEwgIT0gYmFzZXNfY29weSk7CgogICAgbWVtY3B5KGJhc2VzX2NvcHksIGVfc2FtX3JlY29yZC5z
ZXEsIHJlYWRMZW5ndGgpOwoKICAgIC8vIFRPRE86ZmluYWwgTkdTUGxhdGZvcm0gbmdzUGxhdGZv
cm0gPSBkZWZhdWx0X3BsYXRmb3JtID09IG51bGwgPyByZWFkLmdldE5HU1BsYXRmb3JtKCkgOiBO
R1NQbGF0Zm9ybS5mcm9tUmVhZEdyb3VwUEwoZGVmYXVsdF9wbGF0Zm9ybSk7CiAgICBpbnQgcmVh
ZE9yZGVyRmFjdG9yID0gc2FtdG9vbHM6OmdldFJlYWRQYWlyZWRGbGFnKGVfc2FtX3JlY29yZC5m
bGFnKSAmJiBzYW10b29sczo6Z2V0U2Vjb25kT2ZQYWlyRmxhZyhlX3NhbV9yZWNvcmQuZmxhZykg
PyAtMSA6IDE7CgogICAgY2hhciogYmFzZXMgPSBzYW10b29sczo6Y2xpcExvd1F1YWxFbmRzKGVf
c2FtX3JlY29yZCwgZ2xvYmFsQjo6TE9XX1FVQUxfVEFJTCwgc2FtdG9vbHM6OkNsaXBwaW5nUmVw
cmVzZW50YXRpb246OldSSVRFX05TKS5zZXE7CgojaWYgMQogICAgYm9vbCBuZWdhdGl2ZVN0cmFu
ZCA9IHNhbXRvb2xzOjpnZXRSZWFkTmVnYXRpdmVTdHJhbmRGbGFnKGVfc2FtX3JlY29yZCk7Cgog
ICAgaW50IGluY3JlbWVudDsKICAgIGludCBjeWNsZTsKICAgIGlmIChuZWdhdGl2ZVN0cmFuZCkK
ICAgIHsKCiAgICAgICAgc2FtdG9vbHM6OnNpbXBsZVJldmVyc2VDb21wbGVtZW50KGJhc2VzLCBy
ZWFkTGVuZ3RoKTsKCiAgICAgICAgY3ljbGUgPSByZWFkTGVuZ3RoICogcmVhZE9yZGVyRmFjdG9y
OwogICAgICAgIGluY3JlbWVudCA9IC0xICogcmVhZE9yZGVyRmFjdG9yOwogICAgfQogICAgZWxz
ZQogICAgewogICAgICAgIGN5Y2xlID0gcmVhZE9yZGVyRmFjdG9yOwogICAgICAgIGluY3JlbWVu
dCA9IHJlYWRPcmRlckZhY3RvcjsKICAgIH0KICAgIGludCAqIG1pc21hdGNoS2V5cyA9IG5ldyBp
bnRbcmVhZExlbmd0aF07IC8vIG1lbSAxCiAgICBpbnQgKmluZGVsS2V5cyA9IG5ldyBpbnRbcmVh
ZExlbmd0aF07IC8vIG1lbSAyCiAgICAKCiAgICBnbG9iYWxCOjpjb250ZXh0V2l0aChiYXNlcywg
cmVhZExlbmd0aCwgZ2xvYmFsQjo6bWlzbWF0Y2hlc0NvbnRleHRTaXplLCBnbG9iYWxCOjptaXNt
YXRjaGVzS2V5TWFzaywgbWlzbWF0Y2hLZXlzKTsKICAgIGdsb2JhbEI6OmNvbnRleHRXaXRoKGJh
c2VzLCByZWFkTGVuZ3RoLCBnbG9iYWxCOjppbmRlbHNDb250ZXh0U2l6ZSwgICAgIGdsb2JhbEI6
OmluZGVsc0tleU1hc2ssIGluZGVsS2V5cyk7CiNpZiAwCiAgICBmb3IgKGludCBpID0gMDsgaSA8
IHJlYWRMZW5ndGg7IGkrKykKICAgIHsKICAgICAgICBwcmludGYoIiVkICIsIG1pc21hdGNoS2V5
c1tpXSk7CiAgICB9CiAgICBwcmludGYoIlxuIik7CgogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBy
ZWFkTGVuZ3RoOyBpKyspCiAgICB7CiAgICAgICAgcHJpbnRmKCIlZCAiLCBpbmRlbEtleXNbaV0p
OwogICAgfQojZW5kaWYgCgogICAgaW50IE1BWF9DWUNMRV9GT1JfSU5ERUxTID0gcmVhZExlbmd0
aCAtIGdsb2JhbEI6OkNVU0hJT05fRk9SX0lOREVMUyAtIDE7CgogICAgaWYgKHJlYWRMZW5ndGgg
IT0gcmVhZExlbmd0aCkKICAgIHsKICAgICAgICAvL1RPRE8KICAgIH0KCiAgICAvL3ZlY3Rvcjx2
ZWN0b3I8Z3JwdG9vbHM6OkNWS0VZPj4gcmVhZENvdmFyaWF0ZXNBcnIgPSB7fTsKICAgIC8vcmVh
ZENvdmFyaWF0ZXNBcnIucmVzaXplKDMpOyAvLyAzIGN2OiBtaXNtYXRjaCBjdiwgaW5zZXJ0aW9u
IGN2LCBkZWxldGlvbiBjdi4KICAgIC8vcmVhZENvdmFyaWF0ZXNBcnJbMF0ucmVzaXplKHJlYWRM
ZW5ndGgpOwogICAgLy9yZWFkQ292YXJpYXRlc0FyclsxXS5yZXNpemUocmVhZExlbmd0aCk7CiAg
ICAvL3JlYWRDb3ZhcmlhdGVzQXJyWzJdLnJlc2l6ZShyZWFkTGVuZ3RoKTsKICAgIAogICAgc3Ry
dWN0IGdycHRvb2xzOjpDVktFWSBjdmtleTAsIGN2a2V5MSwgY3ZrZXkyOyAvLyBmaXJzdDogcXVh
bCwgc2Vjb25kOiBjb250ZXh0IHZhbHVlLCBsYXN0OiBjeWNsZSB2YWx1ZS4KICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWlzbWF0Y2ggY292YXJp
YXRlcy4KICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcmVhZExlbmd0aDsgaSsrKQogICAgewoKICAg
ICAgICBjdmtleTAucXVhbGl0eSA9IGludCAoZV9zYW1fcmVjb3JkLnF1YWxbaV0gLSAzMyk7CiAg
ICAgICAgY3ZrZXkxLnF1YWxpdHkgPSBnbG9iYWxCOjpERUZBVUxUX0lOU0VSVElPTl9ERUxFVElP
Tl9RVUFMOwogICAgICAgIGN2a2V5Mi5xdWFsaXR5ID0gZ2xvYmFsQjo6REVGQVVMVF9JTlNFUlRJ
T05fREVMRVRJT05fUVVBTDsKCiAgICAgICAgY3ZrZXkwLmNvbnRleHRLZXkgPSBtaXNtYXRjaEtl
eXNbKG5lZ2F0aXZlU3RyYW5kID8gcmVhZExlbmd0aCAtIGkgLSAxIDogaSldOwogICAgICAgIGN2
a2V5MS5jb250ZXh0S2V5ID0gaW5kZWxLZXlzWyhuZWdhdGl2ZVN0cmFuZCA/IHJlYWRMZW5ndGgg
LSBpIC0gMSA6IGkpXTsKICAgICAgICBjdmtleTIuY29udGV4dEtleSA9IGN2a2V5MS5jb250ZXh0
S2V5OwoKICAgICAgICBpbnQgc3Vic3RpdHV0aW9uS2V5ID0gc2FtdG9vbHM6OmtleUZyb21DeWNs
ZShjeWNsZSk7CiAgICAgICAgaW50IGluZGVsS2V5ID0gKGkgPCBnbG9iYWxCOjpDVVNISU9OX0ZP
Ul9JTkRFTFMgfHwgaSA+IE1BWF9DWUNMRV9GT1JfSU5ERUxTKSA/IC0xIDogc3Vic3RpdHV0aW9u
S2V5OwogICAgICAgIGN2a2V5MC5jeWNsZUtleSA9IHN1YnN0aXR1dGlvbktleTsKICAgICAgICBj
dmtleTEuY3ljbGVLZXkgPSBpbmRlbEtleTsKICAgICAgICBjdmtleTIuY3ljbGVLZXkgPSBpbmRl
bEtleTsKICAgICAgICBjeWNsZSArPSBpbmNyZW1lbnQ7CgojaWYgMCAKICAgICAgICByZWFkQ292
YXJpYXRlc0FyclswXVtpXSA9IGN2a2V5MDsKICAgICAgICByZWFkQ292YXJpYXRlc0FyclsxXVtp
XSA9IGN2a2V5MTsKICAgICAgICByZWFkQ292YXJpYXRlc0FyclsyXVtpXSA9IGN2a2V5MjsKI2Vu
ZGlmIAojaWYgMSAKICAgICAgICByZWFkQ292YXJpYXRlc0FyclswICogcmVhZExlbmd0aCArIGld
ID0gY3ZrZXkwOwogICAgICAgIHJlYWRDb3ZhcmlhdGVzQXJyWzEgKiByZWFkTGVuZ3RoICsgaV0g
PSBjdmtleTE7CiAgICAgICAgcmVhZENvdmFyaWF0ZXNBcnJbMiAqIHJlYWRMZW5ndGggKyBpXSA9
IGN2a2V5MjsKI2VuZGlmIAoKICAgIH0KCiNpZiAwCiAgICBhdXRvICZlID0gcmVhZENvdmFyaWF0
ZXNBcnI7CiAgICBmb3IgKGludCBpID0gMDsgaSA8IDM7IGkrKykKICAgIHsKICAgICAgICBmb3Ig
KGludCBqID0gMDsgaiA8IHJlYWRMZW5ndGg7IGorKykKICAgICAgICB7CiAgICAgICAgICAgIHBy
aW50ZigiJWQgJWQgJWRcbiIsIGVbaSogcmVhZExlbmd0aCArIGpdLnF1YWxpdHksIGVbaSogcmVh
ZExlbmd0aCArIGpdLmNvbnRleHRLZXksIGVbaSAqIHJlYWRMZW5ndGggKyBqXS5jeWNsZUtleSk7
CiAgICAgICAgfQogICAgICAgIHByaW50ZigiXG4iKTsKICAgIH0KI2VuZGlmIAoKICAgIGRlbGV0
ZVtdIGluZGVsS2V5czsgLy8gZGVsIG1lbSAyCiAgICBkZWxldGVbXSBtaXNtYXRjaEtleXM7IC8v
IGRlbCBtZW0gMQojZW5kaWYgCiAgICAKICAgIG1lbWNweShlX3NhbV9yZWNvcmQuc2VxLCBiYXNl
c19jb3B5LCByZWFkTGVuZ3RoKTsKCiAgICBERUxfQVJSX01FTShiYXNlc19jb3B5KTsKCiAgICBy
ZXR1cm47Cgp9CgoKCi8vIGdycHRvb2xzX18gZW5kCgovLyNpbmNsdWRlICJiZ2l0b29scy5jcHAi
Ci8vIGJnaXRvb2xzX18gc3RhcnQgIAppbnQgYmdpdG9vbHM6OmdldEV2ZW50T3JkQnlFdFN0cihj
b25zdCBzdHJpbmcgJiBldFN0cikKewogICAgaWYgKGV0U3RyID09ICJNIikKICAgIHsKICAgICAg
ICByZXR1cm4gMDsKICAgIH0KICAgIGVsc2UgaWYgKGV0U3RyID09ICJJIikKICAgIHsKICAgICAg
ICByZXR1cm4gMTsKICAgIH0KICAgIGVsc2UgaWYgKGV0U3RyID09ICJEIikKICAgIHsKICAgICAg
ICByZXR1cm4gMjsKICAgIH0KICAgIHJldHVybiAwOyAKfQoKCnZvaWQgYmdpdG9vbHM6OnRyaW1f
c3RyKGNoYXIgKiBzdHIpCnsKICAgIGludCBsZW4gPSAoaW50KXN0cmxlbihzdHIpOwogICAgaWYg
KHN0cltsZW4gLSAxXSA9PSAnXHInIHx8IHN0cltsZW4gLSAxXSA9PSAnXG4nKQogICAgewogICAg
ICAgIHN0cltsZW4gLSAxXSA9IDA7CiAgICB9Cn0KCnZvaWQgYmdpdG9vbHM6OnRyaW1fc3RyKHN0
cmluZyAmIHN0cikKewogICAgaW50IGxlbiA9IHN0ci5sZW5ndGgoKTsKICAgIGlmIChzdHJbbGVu
IC0gMV0gPT0gJ1xyJyB8fCBzdHJbbGVuIC0gMV0gPT0gJ1xuJykKICAgIHsKICAgICAgICBzdHIg
PSBzdHIuc3Vic3RyKDAsIGxlbiAtIDEpOwogICAgfQp9CgoKdmVjdG9yPHN0cmluZz4gYmdpdG9v
bHM6OnNwbGl0X3N0cl8yX3ZlYyhjb25zdCBzdHJpbmcgJiBzdHIsIGNvbnN0IGNoYXIgJiBkZWxp
bWl0ZXIsIGNvbnN0IGludCAmIHJldGFpbk51bSwgaW50IGZsYWdfcHVzaF90YWlsX3N0cikKewog
ICAgc3RkOjp2ZWN0b3I8c3RkOjpzdHJpbmc+ICAgdmVjX3JldHt9OwogICAgdmVjX3JldC5yZXNl
cnZlKDE2KTsKCiAgICBzdGQ6OnN0cmluZ3N0cmVhbSAgZGF0YShzdHIpOwoKICAgIHN0ZDo6c3Ry
aW5nIGxpbmU7CiAgICBpZiAocmV0YWluTnVtID09IC0xKQogICAgewogICAgICAgIGlmIChkZWxp
bWl0ZXIgPT0gJyAnKQogICAgICAgIHsKICAgICAgICAgICAgd2hpbGUgKHN0ZDo6Z2V0bGluZShk
YXRhLCBsaW5lLCBkZWxpbWl0ZXIpKSAvLyBhc3N1bWUKICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgLy8gTm90ZTogaWYgbXVsdGlwbGUgZGVsaW1pdG9yIGluIHRoZSBzb3VyY2Ugc3RyaW5n
LAogICAgICAgICAgICAgICAgLy8gICAgICAgICAgIHlvdSBtYXkgc2VlIG1hbnkgZW1wdHkgaXRl
bSBpbiB2ZWN0b3IKICAgICAgICAgICAgICAgIGlmIChsaW5lID09ICIiKSBjb250aW51ZTsKICAg
ICAgICAgICAgICAgIHZlY19yZXQucHVzaF9iYWNrKGxpbmUpOwogICAgICAgICAgICB9CiAgICAg
ICAgICAgIHJldHVybiB2ZWNfcmV0OwogICAgICAgIH0KICAgICAgICB3aGlsZSAoc3RkOjpnZXRs
aW5lKGRhdGEsIGxpbmUsIGRlbGltaXRlcikpICAgICAvLyBhc3N1bWUKICAgICAgICB7CiAgICAg
ICAgICAgIC8vIE5vdGU6IGlmIG11bHRpcGxlIGRlbGltaXRvciBpbiB0aGUgc291cmNlIHN0cmlu
ZywKICAgICAgICAgICAgLy8gICAgICAgeW91IG1heSBzZWUgbWFueSBlbXB0eSBpdGVtIGluIHZl
Y3RvcgogICAgICAgICAgICB2ZWNfcmV0LnB1c2hfYmFjayhsaW5lKTsKICAgICAgICB9CiAgICB9
CiAgICBlbHNlCiAgICB7CiAgICAgICAgaWYgKGRlbGltaXRlciA9PSAnICcpCiAgICAgICAgewog
ICAgICAgICAgICBpbnQgY250ID0gMDsKICAgICAgICAgICAgd2hpbGUgKHN0ZDo6Z2V0bGluZShk
YXRhLCBsaW5lLCBkZWxpbWl0ZXIpKSAvLyBhc3N1bWUKICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgaWYgKGNudCA+PSByZXRhaW5OdW0pIGJyZWFrOwogICAgICAgICAgICAgICAgaWYgKGxp
bmUgPT0gIiIpIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgdmVjX3JldC5wdXNoX2JhY2sobGlu
ZSk7CiAgICAgICAgICAgICAgICBjbnQrKzsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1
cm4gdmVjX3JldDsKICAgICAgICB9CiAgICAgICAgaW50IGNudCA9IDA7CiAgICAgICAgd2hpbGUg
KGNudCA8IHJldGFpbk51bSAmJiBzdGQ6OmdldGxpbmUoZGF0YSwgbGluZSwgZGVsaW1pdGVyKSkg
ICAgIC8vIGFzc3VtZQogICAgICAgIHsKICAgICAgICAgICAgLy9pZiAoY250ID49IHJldGFpbk51
bSkgYnJlYWs7CiAgICAgICAgICAgIHZlY19yZXQucHVzaF9iYWNrKGxpbmUpOwogICAgICAgICAg
ICBjbnQrKzsKICAgICAgICB9CiAgICB9CgogICAgaWYgKGZsYWdfcHVzaF90YWlsX3N0cikKICAg
IHsKICAgICAgICBzdGQ6OmdldGxpbmUoZGF0YSwgbGluZSwgJ1xhJyk7CiAgICAgICAgdmVjX3Jl
dC5wdXNoX2JhY2sobGluZSk7CiAgICB9CiAgICByZXR1cm4gdmVjX3JldDsKfQoKdmVjdG9yPHN0
cmluZz4gYmdpdG9vbHM6OmJhc2VFbnVtQW5kQ29tYmluZShjb25zdCBpbnQgJiBudW1CYXNlcywg
Y29uc3QgdmVjdG9yPHN0cmluZz4gJiBiYXNlVHlwZSkKewogICAgaW50IGxlbmd0aCA9IGJhc2VU
eXBlLnNpemUoKTsKICAgIGludCBudW1CaXRzVG9SZXByZXNlbnQgPSBjZWlsKGxlbmd0aCAvIDIu
MCk7CiAgICBpbnQgY29tYmluZVRvdGFsID0gcG93KDIsIG51bUJhc2VzICogbnVtQml0c1RvUmVw
cmVzZW50KTsKICAgIGludCBiYXNlTWFzayA9IHBvdygyLCBudW1CaXRzVG9SZXByZXNlbnQpIC0g
MTsKICAgIHZlY3RvcjxzdHJpbmc+IGFsbENvbWJpbmU7IGFsbENvbWJpbmUucmVzaXplKHBvdyhs
ZW5ndGgsIG51bUJhc2VzKSk7CiAgICBpbnQgaW5kID0gMDsKICAgIGZvciAoaW50IGNvbWJpbmVD
YXNlID0gMDsgY29tYmluZUNhc2UgPCBjb21iaW5lVG90YWw7IGNvbWJpbmVDYXNlKyspCiAgICB7
CiAgICAgICAgc3RyaW5nIG51bUNvbWJCYXNlcyA9ICIiOwogICAgICAgIGJvb2wgc2tpcCA9IGZh
bHNlOwogICAgICAgIGZvciAoaW50IGkgPSBudW1CYXNlcyAtIDE7IGkgPj0gMDsgaS0tKQogICAg
ICAgIHsKICAgICAgICAgICAgaW50IGJhc2VfaW5kID0gKGNvbWJpbmVDYXNlID4+IChudW1CaXRz
VG9SZXByZXNlbnQgKiBpKSAmIGJhc2VNYXNrKTsKICAgICAgICAgICAgLy8gICAgICAgICAgICAg
ICAgaW50IGJhc2VfaW5kID0gKGNvbWJpbmVDYXNlICYgKGJhc2VNYXNrIDw8IChudW1CaXRzVG9S
ZXByZXNlbnQgKiBpKSkpID4+IChudW1CaXRzVG9SZXByZXNlbnQgKiBpKTsKICAgICAgICAgICAg
aWYgKGJhc2VfaW5kIDwgbGVuZ3RoKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBudW1D
b21iQmFzZXMgKz0gYmFzZVR5cGVbYmFzZV9pbmRdOwogICAgICAgICAgICB9CiAgICAgICAgICAg
IGVsc2UKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgc2tpcCA9IHRydWU7CiAgICAgICAg
ICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoIXNraXAp
CiAgICAgICAgewogICAgICAgICAgICBhbGxDb21iaW5lW2luZF0gPSBudW1Db21iQmFzZXM7CiAg
ICAgICAgICAgIGluZCsrOwogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gYWxsQ29tYmluZTsK
fQoKCgpfX2RldmljZV9fIHN0cnVjdCBiZ2l0b29sczo6Q2lnYXJPcGVyYXRvciBiZ2l0b29sczo6
Y2lnYXJPcGVyYXRvcihiZ2l0b29sczo6T1BUICYgb3B0KQp7CglzdHJ1Y3QgYmdpdG9vbHM6OkNp
Z2FyT3BlcmF0b3IgY287Cglzd2l0Y2ggKG9wdCkgewoJCWNhc2UgYmdpdG9vbHM6Ok9QVDo6TjoK
CQkJY28uY29uc3VtZXNSZWFkQmFzZXMgPSBmYWxzZTsKCQkJY28uY29uc3VtZXNSZWZlcmVuY2VC
YXNlcyA9IHRydWU7CgkJCWNvLmNoYXJhY3RlciA9ICdOJzsKCQkJYnJlYWs7CgkJY2FzZSBPUFQ6
Okg6CgkJCWNvLmNvbnN1bWVzUmVhZEJhc2VzID0gZmFsc2U7CgkJCWNvLmNvbnN1bWVzUmVmZXJl
bmNlQmFzZXMgPSBmYWxzZTsKCQkJY28uY2hhcmFjdGVyID0gJ0gnOwoJCQlicmVhazsKCQljYXNl
IE9QVDo6UDoKCQkJY28uY29uc3VtZXNSZWFkQmFzZXMgPSBmYWxzZTsKCQkJY28uY29uc3VtZXNS
ZWZlcmVuY2VCYXNlcyA9IGZhbHNlOwoJCQljby5jaGFyYWN0ZXIgPSAnUCc7CgkJCWJyZWFrOwoJ
CWNhc2UgT1BUOjpEOgoJCQljby5jb25zdW1lc1JlYWRCYXNlcyA9IGZhbHNlOwoJCQljby5jb25z
dW1lc1JlZmVyZW5jZUJhc2VzID0gdHJ1ZTsKCQkJY28uY2hhcmFjdGVyID0gJ0QnOwoJCQlicmVh
azsKCQljYXNlIE9QVDo6SToKCQkJY28uY29uc3VtZXNSZWFkQmFzZXMgPSB0cnVlOwoJCQljby5j
b25zdW1lc1JlZmVyZW5jZUJhc2VzID0gZmFsc2U7CgkJCWNvLmNoYXJhY3RlciA9ICdJJzsKCQkJ
YnJlYWs7CgkJY2FzZSBPUFQ6OlM6CgkJCWNvLmNvbnN1bWVzUmVhZEJhc2VzID0gdHJ1ZTsKCQkJ
Y28uY29uc3VtZXNSZWZlcmVuY2VCYXNlcyA9IGZhbHNlOwoJCQljby5jaGFyYWN0ZXIgPSAnUyc7
CgkJCWJyZWFrOwoJCWNhc2UgT1BUOjpNOgoJCQljby5jb25zdW1lc1JlYWRCYXNlcyA9IHRydWU7
CgkJCWNvLmNvbnN1bWVzUmVmZXJlbmNlQmFzZXMgPSB0cnVlOwoJCQljby5jaGFyYWN0ZXIgPSAn
TSc7CgkJCWJyZWFrOwoJCWNhc2UgT1BUOjpFUToKCQkJY28uY29uc3VtZXNSZWFkQmFzZXMgPSB0
cnVlOwoJCQljby5jb25zdW1lc1JlZmVyZW5jZUJhc2VzID0gdHJ1ZTsKCQkJY28uY2hhcmFjdGVy
ID0gJz0nOwoJCQlicmVhazsKCQljYXNlIE9QVDo6WDoKCQkJY28uY29uc3VtZXNSZWFkQmFzZXMg
PSB0cnVlOwoJCQljby5jb25zdW1lc1JlZmVyZW5jZUJhc2VzID0gdHJ1ZTsKCQkJY28uY2hhcmFj
dGVyID0gJ1gnOwoJCQlicmVhazsKCQlkZWZhdWx0OgoJCQlwcmludGYoImVycm9yIik7Cgl9CgoJ
cmV0dXJuIGNvOwp9CgoKX19kZXZpY2VfXyBib29sIGJnaXRvb2xzOjpiYWRDaWdhckZpbHRlcihz
YW1fcmVjb3JkICYgZV9zYW1fcmVjb3JkKQp7CgoJaWYgKGVfc2FtX3JlY29yZC5jaWdhclswXSA9
PSBnbG9iYWxCOjpOT19BTElHTk1FTlRfQ0lHQVIpCgl7CgkJcmV0dXJuIGZhbHNlOwoJfQoJaWYg
KGVfc2FtX3JlY29yZC5jaWdhcl9tYXBfbGVuID09IC0xKSAvL2luaXQgdmFsCgl7CgkJYmdpdG9v
bHM6OmRlY29kZV9jaWdhcihlX3NhbV9yZWNvcmQpOwoJfQoKCXN0cnVjdCBiZ2l0b29sczo6Q0lH
QVIqIGNpZ2FyX21hcCA9IGVfc2FtX3JlY29yZC5jaWdhcl9tYXA7CglhdXRvICZjaWdhcl9tYXBf
bGVuID0gZV9zYW1fcmVjb3JkLmNpZ2FyX21hcF9sZW47CgoJaWYgKGVfc2FtX3JlY29yZC5zZXFf
bGVuICE9IHNhbXRvb2xzOjpnZXRSZWFkTGVuZ3RoRm9yQ2lnYXIoY2lnYXJfbWFwLCBjaWdhcl9t
YXBfbGVuKSkKCXsKCQlyZXR1cm4gdHJ1ZTsKCX0KCgliZ2l0b29sczo6T1BUIGZpcnN0T3AgPSBi
Z2l0b29sczo6T1BUOjpIOwoJaW50IGlpaSA9IDA7Cgl3aGlsZSAoaWlpIDwgY2lnYXJfbWFwX2xl
biAmJiAoZmlyc3RPcCA9PSBiZ2l0b29sczo6T1BUOjpIIHx8IGZpcnN0T3AgPT0gYmdpdG9vbHM6
Ok9QVDo6UykpCgl7CgkJYmdpdG9vbHM6Ok9QVCBvcCA9IGNpZ2FyX21hcFtpaWldLm9wdDsKCgkJ
Ly8gR0FUSzogTm8gcmVhZHMgd2l0aCBIYXJkL1NvZnQgY2xpcHMgaW4gdGhlIG1pZGRsZSBvZiB0
aGUgY2lnYXIKCQlpZiAoZmlyc3RPcCAhPSBiZ2l0b29sczo6T1BUOjpIICYmIG9wID09IGJnaXRv
b2xzOjpPUFQ6OkgpCgkJewoJCQlyZXR1cm4gdHJ1ZTsKCQl9CgkJZmlyc3RPcCA9IG9wOwoJCWlp
aSsrOwoJfQoKCS8vIE5vIHJlYWRzIHN0YXJ0aW5nIHdpdGggZGVsZXRpb25zICh3aXRoIG9yIHdp
dGhvdXQgcHJlY2VkaW5nIGNsaXBzKQoJaWYgKGZpcnN0T3AgPT0gYmdpdG9vbHM6Ok9QVDo6RCkg
Cgl7CgkJcmV0dXJuIHRydWU7Cgl9CgoJYm9vbCBoYXNNZWFuaW5nZnVsRWxlbWVudHMgPSAoZmly
c3RPcCAhPSBiZ2l0b29sczo6T1BUOjpIICYmIGZpcnN0T3AgIT0gYmdpdG9vbHM6Ok9QVDo6Uyk7
Cglib29sIHByZXZpb3VzRWxlbWVudFdhc0luZGVsID0gZmlyc3RPcCA9PSBiZ2l0b29sczo6T1BU
OjpJOwoJYmdpdG9vbHM6Ok9QVCBsYXN0T3AgPSBmaXJzdE9wOwoJYmdpdG9vbHM6Ok9QVCBwcmV2
aW91c09wID0gZmlyc3RPcDsKCgl3aGlsZSAoaWlpIDwgY2lnYXJfbWFwX2xlbikKCXsKCQliZ2l0
b29sczo6T1BUIG9wID0gY2lnYXJfbWFwW2lpaV0ub3B0OyBpaWkrKzsKCgkJaWYgKG9wICE9IGJn
aXRvb2xzOjpPUFQ6OlMgJiYgb3AgIT0gYmdpdG9vbHM6Ok9QVDo6SCkKCQl7CgkJCS8vIEdBVEs6
IE5vIHJlYWRzIHdpdGggSGFyZC9Tb2Z0IGNsaXBzIGluIHRoZSBtaWRkbGUgb2YgdGhlIGNpZ2Fy
CgkJCWlmIChwcmV2aW91c09wID09IGJnaXRvb2xzOjpPUFQ6OlMgfHwgcHJldmlvdXNPcCA9PSBi
Z2l0b29sczo6T1BUOjpIKQoJCQkJcmV0dXJuIHRydWU7CgoJCQlsYXN0T3AgPSBvcDsKCgkJCWlm
ICghaGFzTWVhbmluZ2Z1bEVsZW1lbnRzICYmIGJnaXRvb2xzOjpjaWdhck9wZXJhdG9yKG9wKS5j
b25zdW1lc1JlYWRCYXNlcykgewoJCQkJaGFzTWVhbmluZ2Z1bEVsZW1lbnRzID0gdHJ1ZTsKCQkJ
fQoKCQkJaWYgKG9wID09IGJnaXRvb2xzOjpPUFQ6OkkgfHwgb3AgPT0gYmdpdG9vbHM6Ok9QVDo6
RCkgewoKCQkJCS8vIEdBVEs6IE5vIHJlYWRzIHRoYXQgaGF2ZSBjb25zZWN1dGl2ZSBpbmRlbHMg
aW4gdGhlIGNpZ2FyIChJSSwgREQsIElEIG9yIERJKQoJCQkJaWYgKHByZXZpb3VzRWxlbWVudFdh
c0luZGVsKSB7CgkJCQkJcmV0dXJuIHRydWU7CgkJCQl9CgkJCQlwcmV2aW91c0VsZW1lbnRXYXNJ
bmRlbCA9IHRydWU7CgkJCX0KCQkJZWxzZSB7CgkJCQlwcmV2aW91c0VsZW1lbnRXYXNJbmRlbCA9
IGZhbHNlOwoJCQl9CgkJfQoJCS8vIEdBVEs6IE5vIHJlYWRzIHdpdGggSGFyZC9Tb2Z0IGNsaXBz
IGluIHRoZSBtaWRkbGUgb2YgdGhlIGNpZ2FyCgkJZWxzZSBpZiAob3AgPT0gYmdpdG9vbHM6Ok9Q
VDo6UyAmJiBwcmV2aW91c09wID09IGJnaXRvb2xzOjpPUFQ6OkgpIHsKCQkJcmV0dXJuIHRydWU7
CgkJfQoKCQlwcmV2aW91c09wID0gb3A7Cgl9CgoJLy8gR0FUSzogTm8gcmVhZHMgZW5kaW5nIGlu
IGRlbGV0aW9ucyAod2l0aCBvciB3aXRob3V0IGZvbGxvdy11cCBjbGlwcykKCS8vIEdBVEs6IE5v
IHJlYWRzIHRoYXQgYXJlIGZ1bGx5IGhhcmQgb3Igc29mdCBjbGlwcGVkCglyZXR1cm4gbGFzdE9w
ID09IGJnaXRvb2xzOjpPUFQ6OkQgfHwgIWhhc01lYW5pbmdmdWxFbGVtZW50czsKfQoKCl9fZGV2
aWNlX18gYm9vbCBiZ2l0b29sczo6Y29udGFpbnNOT3BlcmF0b3Ioc2FtX3JlY29yZCAmIGVfc2Ft
X3JlY29yZCkKewoJaWYgKGVfc2FtX3JlY29yZC5jaWdhcl9sZW4gPT0gMCB8fCBlX3NhbV9yZWNv
cmQuY2lnYXJbMF0gPT0gZ2xvYmFsQjo6Tk9fQUxJR05NRU5UX0NJR0FSKQoJewoJCXJldHVybiBm
YWxzZTsKCX0KCS8vdW5vcmRlcmVkX21hcDxpbnQsIHN0cnVjdCBiZ2l0b29sczo6Q0lHQVI+IGNp
Z2FyX21hcCA9IGJnaXRvb2xzOjpkZWNvZGVfY2lnYXIoZV9zYW1fcmVjb3JkLmNpZ2FyKTsKCglp
ZiAoZV9zYW1fcmVjb3JkLmNpZ2FyX21hcF9sZW4gPT0gLTEpIC8vaW5pdCB2YWwKCXsKCQliZ2l0
b29sczo6ZGVjb2RlX2NpZ2FyKGVfc2FtX3JlY29yZCk7Cgl9CglhdXRvICpjaWdhcl9tYXAgPSBl
X3NhbV9yZWNvcmQuY2lnYXJfbWFwOwoJYXV0byBjaWdhcl9tYXBfbGVuID0gZV9zYW1fcmVjb3Jk
LmNpZ2FyX21hcF9sZW47CgoJZm9yIChpbnQgaWlpID0gMDsgaWlpIDwgY2lnYXJfbWFwX2xlbjsg
aWlpKyspCgl7CgkJaWYgKGNpZ2FyX21hcFtpaWldLm9wdCA9PSBiZ2l0b29sczo6T1BUOjpOKQoJ
CXsKCQkJcmV0dXJuIHRydWU7CgkJfQoJfQoJcmV0dXJuIGZhbHNlOwp9CgoKX19kZXZpY2VfXyBp
bnQgYmdpdG9vbHM6OmlzZGlnaXQoY2hhciBwKQp7CglpbnQgZmxhZyA9IDA7CglpZiAocCA+PSAn
MCcgJiYgcCA8PSAnOScpCgl7CgkJZmxhZyA9IDE7IAoJfQoJcmV0dXJuIGZsYWc7Cn07Cl9fZGV2
aWNlX18gaW50IGJnaXRvb2xzOjphdG9pKGNoYXIqIHAsIGludCBwX2xlbikKewoJZmxvYXQgc3Vt
ID0gMDsKCWF1dG8gKnBwID0gcDsKCWF1dG8gcHBfbGVuID0gcF9sZW47CglmbG9hdCBmbGFnX3Np
Z24gPSAxLjBmOwoKCWlmIChwcFswXSA9PSAnLScpCgl7CgkJcHArKzsKCQlwcF9sZW4tLTsKCQlm
bGFnX3NpZ24gPSAtMS4wZjsKCX0KCglmb3IgKGludCBpID0gMDsgaSA8IHBwX2xlbjsgaSsrKQoJ
ewoJCS8vc3VtICs9IHBbaV07CiAgICAgICAgCiAgICAgICAKCiAgICAgICAgICAgIHN1bSArPSAo
cHBbaV0gLSAnMCcpKiBwb3coMTAgKiAxLjAsIChwcF9sZW4gLSBpIC0gMSkqMS4wKTsKICAKICAg
ICAgICAvL3ByaW50ZigiJWM6ICMjIyMjIyMjIyVmIyMjIyMjIyMjI1xuIixwcFtpXSwgc3VtKTsK
CQkKCX0KCiAgICAvL3ByaW50ZigiXG4iKTsKICAgIC8vcHJpbnRmKCIjIyMjIyMjIyMlZiMjIyMj
IyMjIyNcbiIsIHN1bSk7CglyZXR1cm4gaW50KHN1bSAqIGZsYWdfc2lnbik7CiAgICAKfTsKCgpf
X2RldmljZV9fIHZvaWQgYmdpdG9vbHM6OmRlY29kZV9jaWdhcihzYW1fcmVjb3JkICYgZV9zYW1f
cmVjb3JkKQp7CglhdXRvIGNpZ2FyX2NoYXJfdG9fZW51bV92YWwgPSBbXShjaGFyICYgYykKCXsK
CQlPUFQgcmV0X29wdCA9IE9QVDo6TTsKCgkJc3dpdGNoIChjKQoJCXsKCQkJLy8gdG90YWwgOSBD
SEFSCgkJCWNhc2UgJz0nOgoJCQkJcmV0X29wdCA9IE9QVDo6RVE7IGJyZWFrOwoJCQljYXNlICdO
JzoKCQkJCXJldF9vcHQgPSBPUFQ6Ok47IGJyZWFrOwoJCQljYXNlICdIJzoKCQkJCXJldF9vcHQg
PSBPUFQ6Okg7IGJyZWFrOwoJCQljYXNlICdQJzoKCQkJCXJldF9vcHQgPSBPUFQ6OlA7IGJyZWFr
OwoKCQkJY2FzZSAnRCc6CgkJCQlyZXRfb3B0ID0gT1BUOjpEOyBicmVhazsKCQkJY2FzZSAnSSc6
CgkJCQlyZXRfb3B0ID0gT1BUOjpJOyBicmVhazsKCQkJY2FzZSAnUyc6CgkJCQlyZXRfb3B0ID0g
T1BUOjpTOyBicmVhazsKCQkJY2FzZSAnTSc6CgkJCQlyZXRfb3B0ID0gT1BUOjpNOyBicmVhazsK
CgkJCWNhc2UgJ1gnOgoJCQkJcmV0X29wdCA9IE9QVDo6WDsgYnJlYWs7CgkJCWRlZmF1bHQ6CgkJ
CQlwcmludGYoIi0gZXJyb3IgaW4gY2lnYXJfY2hhcl90b19lbnVtX3ZhbCA9IFtdKGNoYXIgJiBj
KT9cbiIpOwoJCQkJYXNzZXJ0KGMgPT0gIi0gbm90IGEgdmFsaWQgT1BUIlswXSk7IGJyZWFrOwoJ
CX0KCQlyZXR1cm4gcmV0X29wdDsKCX07ICAvLyBlbmQgZnVuKCkgZGVmaW5lCgoKCWJnaXRvb2xz
OjpDSUdBUiogIGNpZ2FyX21hcCA9IGVfc2FtX3JlY29yZC5jaWdhcl9tYXA7ICAKCWF1dG8gY2ln
YXJfbGVuID0gZV9zYW1fcmVjb3JkLmNpZ2FyX2xlbjsKCWF1dG8gKmNpZ2FyID0gZV9zYW1fcmVj
b3JkLmNpZ2FyOwoKCWFzc2VydChjaWdhcl9sZW4gIT0gMCk7CgoJaW50IHByZXYgPSAwLCBsYXN0
ID0gMDsKCWludCBvZmZzZXQgPSAwOwoJZm9yIChpbnQgaSA9IDA7IGkgPCBjaWdhcl9sZW47IGkr
KykKCXsKI2lmIDEKCQlpZiAoYmdpdG9vbHM6OmlzZGlnaXQoY2lnYXJbaV0pKQoJCXsKCQkJbGFz
dCArPSAxOwoJCX0KCQllbHNlCgkJewoKCQkJY2lnYXJfbWFwW29mZnNldF0ub3B0ID0gY2lnYXJf
Y2hhcl90b19lbnVtX3ZhbChjaWdhcltpXSk7CgkJCS8vY2lnYXJfbWFwW29mZnNldF0ubGVuZ3Ro
ID0gYXRvaShjaWdhci5zdWJzdHIocHJldiwgbGFzdCkuY19zdHIoKSk7CgkJCWNpZ2FyX21hcFtv
ZmZzZXRdLmxlbmd0aCA9IGJnaXRvb2xzOjphdG9pKGNpZ2FyK3ByZXYsIGxhc3QgLSBwcmV2KTsK
CgkJCXByZXYgPSBpICsgMTsKCQkJbGFzdCA9IDA7CgkJCW9mZnNldCArPSAxOwoJCX0KI2VuZGlm
IAoJfQoJZV9zYW1fcmVjb3JkLmNpZ2FyX21hcF9sZW4gPSBvZmZzZXQ7IAp9Cl9fZGV2aWNlX18g
aW50IGJnaXRvb2xzOjpnZXRBbGlnbm1lbnRFbmQoc2FtX3JlY29yZCAmIGVfc2FtX3JlY29yZCkK
ewoKCWlmIChlX3NhbV9yZWNvcmQuY2lnYXJfbWFwX2xlbiA9PSAtMSkgLy9pbml0IHZhbAoJewoJ
CWJnaXRvb2xzOjpkZWNvZGVfY2lnYXIoZV9zYW1fcmVjb3JkKTsKCX0KCglpbnQgbGVuZ3RoID0g
MDsKCglhdXRvIGNpZ2FyX21hcF9sZW4gPSBlX3NhbV9yZWNvcmQuY2lnYXJfbWFwX2xlbjsgCglh
dXRvICpjaWdhcl9tYXAgPSBlX3NhbV9yZWNvcmQuY2lnYXJfbWFwOwoJZm9yIChpbnQgaWlpID0g
MDsgaWlpIDwgY2lnYXJfbWFwX2xlbjsgaWlpKyspCgl7CgkJc3RydWN0IGJnaXRvb2xzOjpDSUdB
UiBlbHQgPSBjaWdhcl9tYXBbaWlpXTsKCQlzd2l0Y2ggKGVsdC5vcHQpCgkJewoJCQljYXNlIGJn
aXRvb2xzOjpPUFQ6Ok06CgkJCWNhc2UgYmdpdG9vbHM6Ok9QVDo6RDoKCQkJY2FzZSBiZ2l0b29s
czo6T1BUOjpOOgoJCQljYXNlIGJnaXRvb2xzOjpPUFQ6OkVROgoJCQljYXNlIGJnaXRvb2xzOjpP
UFQ6Olg6CgkJCQlsZW5ndGggKz0gZWx0Lmxlbmd0aDsKCQkJCWJyZWFrOwoJCQlkZWZhdWx0OiB7
fQoKCQl9Cgl9CglyZXR1cm4gbGVuZ3RoICsgZV9zYW1fcmVjb3JkLnBvcyAtIDE7Cn0KCl9fZGV2
aWNlX18gYm9vbCBiZ2l0b29sczo6TWFsZm9ybWVkUmVhZEZpbHRlcihzYW1fcmVjb3JkICYgZV9z
YW1fcmVjb3JkKQp7Cgljb25zdCBzdGF0aWMgdWludDMyX3QgTk9fQUxJR05NRU5UX1NUQVJUID0g
MDsKCWJvb2wgZmlsdGVyTWlzbWF0Y2hpbmdCYXNlQW5kUXVhbHMgPSBmYWxzZTsKCglhdXRvIGNo
ZWNrSW52YWxpZEFsaWdubWVudFN0YXJ0ID0gW10oc2FtX3JlY29yZCYgZV9zYW1fcmVjb3JkKQoJ
ewoJCS8vIEdBVEs6IHJlYWQgaXMgbm90IGZsYWdnZWQgYXMgJ3VubWFwcGVkJywgYnV0IGFsaWdu
bWVudCBzdGFydCBpcyBOT19BTElHTk1FTlRfU1RBUlQKCQlpZiAoIXNhbXRvb2xzOjpnZXRSZWFk
VW5tYXBwZWRGbGFnKGVfc2FtX3JlY29yZCkgJiYgKGVfc2FtX3JlY29yZC5wb3MgPT0gTk9fQUxJ
R05NRU5UX1NUQVJUKSkKCQl7CgkJCXJldHVybiBmYWxzZTsKCQl9CgkJLy8gR0FUSzogUmVhZCBp
cyBub3QgZmxhZ2dlZCBhcyAndW5tYXBwZWQnLCBidXQgYWxpZ25tZW50IHN0YXJ0IGlzIC0xCgkJ
aWYgKCFzYW10b29sczo6Z2V0UmVhZFVubWFwcGVkRmxhZyhlX3NhbV9yZWNvcmQpICYmIChlX3Nh
bV9yZWNvcmQucG9zID09IDE8PDMxLTEpKQoJCXsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCgkJcmV0
dXJuIHRydWU7Cgl9OwoKCS8qKgoJICogZmxhZyAmIFJFQURfVU5NQVBQRURfRkxBRyAhPSAwICYm
IGJnaXRvb2xzOjpnZXRBbGlnbm1lbnRFbmQoZV9zYW1fcmVjb3JkLCBmYWxzZSkgIT0gLTEpICYm
CgkgKiAoYmdpdG9vbHM6OmdldEFsaWdubWVudEVuZChlX3NhbV9yZWNvcmQsIGZhbHNlKSAtIGVf
c2FtX3JlY29yZC5wb3MgKyAxIDwgMCkKCSAqLwoJYXV0byBjaGVja0ludmFsaWRBbGlnbm1lbnRF
bmQgPSBbXShzYW1fcmVjb3JkJiBlX3NhbV9yZWNvcmQpCgl7CgkJaWYgKCFzYW10b29sczo6Z2V0
UmVhZFVubWFwcGVkRmxhZyhlX3NhbV9yZWNvcmQpICYmIChiZ2l0b29sczo6Z2V0QWxpZ25tZW50
RW5kKGVfc2FtX3JlY29yZCkgIT0gLTEpICYmCgkJCQkoYmdpdG9vbHM6OmdldEFsaWdubWVudEVu
ZChlX3NhbV9yZWNvcmQpIC0gaW50KGVfc2FtX3JlY29yZC5wb3MpICsgMSA8IDApKQoJCXsKCQkJ
cmV0dXJuIGZhbHNlOwoJCX0KCQlyZXR1cm4gdHJ1ZTsKCX07CgoKCS8vVE9ETzogYWRkIFJHIGNo
ZWNrIGNvbmRpdGlvbgoJLyoqCgkgKiBlX3NhbV9yZWNvcmQuc2VxLnNpemUoKSA9PSBlX3NhbV9y
ZWNvcmQucXVhbC5zaXplKCkKCSAqLwoJYXV0byBjaGVja01pc21hdGNoaW5nQmFzZXNBbmRRdWFs
cyA9IFtdKHNhbV9yZWNvcmQmIGVfc2FtX3JlY29yZCwgYm9vbCYgZmlsdGVyTWlzbWF0Y2hpbmdC
YXNlQW5kUXVhbHMpCgl7CgkJYm9vbCByZXN1bHQ7CgkJaWYgKGVfc2FtX3JlY29yZC5zZXFfbGVu
ID09IGVfc2FtX3JlY29yZC5xdWFsX2xlbikKCQl7CgkJCXJlc3VsdCA9IHRydWU7CgkJfQoJCWVs
c2UgaWYgKGZpbHRlck1pc21hdGNoaW5nQmFzZUFuZFF1YWxzKQoJCXsKCQkJcmVzdWx0ID0gZmFs
c2U7CgkJfQoJCWVsc2UKCQl7CgkJCXByaW50ZigiQkFNIGZpbGUgaGFzIGEgcmVhZCB3aXRoIG1p
c21hdGNoaW5nIG51bWJlciBvZiBiYXNlcyBhbmQgYmFzZSBxdWFsaXRpZXMiKTsKCQkJYXNzZXJ0
KDAgPT0gMSk7CgkJfQoKCQlyZXR1cm4gcmVzdWx0OwoJfTsKCgoJYXV0byBjaGVja1NlcVN0b3Jl
ZCA9IFtdKHNhbV9yZWNvcmQgJiBlX3NhbV9yZWNvcmQsIGNvbnN0IGJvb2wgJiBmaWx0ZXJCYXNl
c05vdFN0b3JlZCkKCXsKCQlpZiAoZV9zYW1fcmVjb3JkLnNlcV9sZW4gIT0gMCkKCQl7CgkJCXJl
dHVybiB0cnVlOwoJCX0KCgkJaWYgKGZpbHRlckJhc2VzTm90U3RvcmVkID09IHRydWUpCgkJewoJ
CQlyZXR1cm4gZmFsc2U7CgkJfQoKCQlwcmludGYoInRoZSBCQU0gZmlsZSBoYXMgYSByZWFkIHdp
dGggbm8gc3RvcmVkIGJhc2VzIChpLmUuIGl0IHVzZXMgJyonKSB3aGljaCBpcyBub3Qgc3VwcG9y
dGVkIGluIHRoZSBicXNyOyAiCgkJCQkic2VlIHRoZSAtLWZpbHRlcl9iYXNlc19ub3Rfc3RvcmVk
IGFyZ3VtZW50LiBPZmZlbmRlcjogJXMiLCBlX3NhbV9yZWNvcmQucW5hbWUpOyAgICAgICAgCgkJ
cmV0dXJuIGZhbHNlOwoJfTsKCglhdXRvIGNoZWNrQ2lnYXJJc1N1cHBvcnRlZCA9IFtdKHNhbV9y
ZWNvcmQgJiBlX3NhbV9yZWNvcmQsIGNvbnN0IGJvb2wgJiBmaWx0ZXJSZWFkc1dpdGhOQ2lnYXIs
IGNvbnN0IGJvb2wgJiBhbGxvd05DaWdhcnMpCgl7CgkJaWYgKGJnaXRvb2xzOjpjb250YWluc05P
cGVyYXRvcihlX3NhbV9yZWNvcmQpKQoJCXsKCQkJaWYgKCFmaWx0ZXJSZWFkc1dpdGhOQ2lnYXIg
JiYgIWFsbG93TkNpZ2FycykKCQkJewoJCQkJcHJpbnRmKCJQZXJoYXBzIHlvdSBhcmUgdHJ5aW5n
IHRvIHVzZSBSTkEtU2VxIGRhdGE/IHRoaXMgaXMgbm90IHN1cHBvcnRlZCIpOwoJCQkJYXNzZXJ0
KGZpbHRlclJlYWRzV2l0aE5DaWdhciB8fCBhbGxvd05DaWdhcnMpOwoJCQl9CgkJCXJldHVybiAh
ZmlsdGVyUmVhZHNXaXRoTkNpZ2FyOwoJCX0KCQlyZXR1cm4gdHJ1ZTsKCX07CgoJcmV0dXJuICgh
Y2hlY2tJbnZhbGlkQWxpZ25tZW50U3RhcnQoZV9zYW1fcmVjb3JkKSB8fCAhY2hlY2tJbnZhbGlk
QWxpZ25tZW50RW5kKGVfc2FtX3JlY29yZCkgfHwKCQkJIWNoZWNrTWlzbWF0Y2hpbmdCYXNlc0Fu
ZFF1YWxzKGVfc2FtX3JlY29yZCwgZmlsdGVyTWlzbWF0Y2hpbmdCYXNlQW5kUXVhbHMpIHx8CgkJ
CSFjaGVja1NlcVN0b3JlZChlX3NhbV9yZWNvcmQsIHRydWUpIHx8CgkJCSFjaGVja0NpZ2FySXNT
dXBwb3J0ZWQoZV9zYW1fcmVjb3JkLCBmYWxzZSwgZmFsc2UpKTsgLy8gfHwKfQovLyBiZ2l0b29s
c19fIGVuZAoKLy8jaW5jbHVkZSAiZ3JwX3RhYmxlcy5jcHAiCi8vIGdycF90YWJsZXNfXyBzdGFy
dCAKdm9pZCBncnBfdGFibGVzOjpyZWxlYXNlUlQxKCkKewogICAgZm9yIChpbnQgaSA9IDA7IGkg
PCBnbG9iYWxCOjpRdWFsUkFOR0VMRU5USDsgaSsrKQogICAgewogICAgICAgIERFTF9BUlJfTUVN
KFJlY2FsVGFibGUxW2ldKTsKICAgIH0KCiAgICBERUxfQVJSX01FTShSZWNhbFRhYmxlMSk7Cn0K
CnZvaWQgZ3JwX3RhYmxlczo6cmVsZWFzZVJUMl92MSgpCnsKICAgIGZvciAoaW50IGkgPSAwOyBp
IDwgZ2xvYmFsQjo6R3JwUlQyU0hBUEVfZGltXzA7IGkrKykKICAgIHsKICAgICAgICBmb3IgKGlu
dCBqID0gMDsgaiA8IGdsb2JhbEI6OkdycFJUMlNIQVBFX2RpbV8xOyBqKyspCiAgICAgICAgewog
ICAgICAgICAgICBmb3IgKGludCBrID0gMDsgayA8IGdsb2JhbEI6OkdycFJUMlNIQVBFX2RpbV8y
OyBrKyspCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIERFTF9BUlJfTUVNKFJlY2FsVGFi
bGUyW2ldW2pdW2tdKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBERUxfQVJSX01FTShSZWNh
bFRhYmxlMltpXVtqXSk7CiAgICAgICAgfQoKICAgICAgICBERUxfQVJSX01FTShSZWNhbFRhYmxl
MltpXSk7CiAgICB9CgogICAgREVMX0FSUl9NRU0oUmVjYWxUYWJsZTIpOwp9Cgp2b2lkIGdycF90
YWJsZXM6OmFsbG9jYXRlUlQyX3YxKCkKewogICAgUmVjYWxUYWJsZTIgPSBuZXcgZ3JwdG9vbHM6
OlJlY2FsVGFibGUyKioqW2dsb2JhbEI6OkdycFJUMlNIQVBFX2RpbV8wXTsKICAgIGFzc2VydChO
VUxMICE9IFJlY2FsVGFibGUyKTsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZ2xvYmFsQjo6R3Jw
UlQyU0hBUEVfZGltXzA7IGkrKykKICAgIHsKICAgICAgICBSZWNhbFRhYmxlMltpXSA9IE5VTEw7
CiAgICAgICAgUmVjYWxUYWJsZTJbaV0gPSBuZXcgZ3JwdG9vbHM6OlJlY2FsVGFibGUyKipbZ2xv
YmFsQjo6R3JwUlQyU0hBUEVfZGltXzFdOwogICAgICAgIGFzc2VydChOVUxMICE9IFJlY2FsVGFi
bGUyW2ldKTsKICAgICAgICBmb3IgKGludCBqID0gMDsgaiA8IGdsb2JhbEI6OkdycFJUMlNIQVBF
X2RpbV8xOyBqKyspCiAgICAgICAgewogICAgICAgICAgICBSZWNhbFRhYmxlMltpXVtqXSA9IE5V
TEw7CiAgICAgICAgICAgIFJlY2FsVGFibGUyW2ldW2pdID0gbmV3IGdycHRvb2xzOjpSZWNhbFRh
YmxlMipbZ2xvYmFsQjo6R3JwUlQyU0hBUEVfZGltXzJdOwogICAgICAgICAgICBhc3NlcnQoTlVM
TCAhPSBSZWNhbFRhYmxlMltpXVtqXSk7CiAgICAgICAgICAgIGZvciAoaW50IGsgPSAwOyBrIDwg
Z2xvYmFsQjo6R3JwUlQyU0hBUEVfZGltXzI7IGsrKykKICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgUmVjYWxUYWJsZTJbaV1bal1ba10gPSBOVUxMOwogICAgICAgICAgICAgICAgUmVjYWxU
YWJsZTJbaV1bal1ba10gPSBuZXcgZ3JwdG9vbHM6OlJlY2FsVGFibGUyW2dsb2JhbEI6OkV2ZW50
TnVtXTsKICAgICAgICAgICAgICAgIGFzc2VydChOVUxMICE9IFJlY2FsVGFibGUyW2ldW2pdW2td
KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCgp2b2lkIGdycF90YWJsZXM6OmFs
bG9jYXRlUlQxKCkKewogICAgUmVjYWxUYWJsZTEgPSBuZXcgZ3JwdG9vbHM6OlJlY2FsVGFibGUx
KltnbG9iYWxCOjpRdWFsUkFOR0VMRU5USF07CiAgICBhc3NlcnQoTlVMTCAhPSBSZWNhbFRhYmxl
MSk7CiAgICBmb3IgKGludCBpID0gMDsgaSA8IGdsb2JhbEI6OlF1YWxSQU5HRUxFTlRIOyBpKysp
CiAgICB7CiAgICAgICAgUmVjYWxUYWJsZTFbaV0gPSBOVUxMOwogICAgICAgIFJlY2FsVGFibGUx
W2ldID0gbmV3IGdycHRvb2xzOjpSZWNhbFRhYmxlMVtnbG9iYWxCOjpFdmVudE51bV07CiAgICAg
ICAgYXNzZXJ0KE5VTEwgIT0gUmVjYWxUYWJsZTFbaV0pOwogICAgfQp9Cgp2b2lkIGdycF90YWJs
ZXM6OmxvYWQoc3RyaW5nICZncnBfcGF0aCkKewogICAgY29uc3QgaW50IE1BWF9DSEFSID0gMTAy
NDsKICAgIGF1dG8gRl9SID0gKGlvczo6aW4pOwogICAgaWZzdHJlYW0gaWZfKGdycF9wYXRoLmNf
c3RyKCksIEZfUik7ICBhc3NlcnQoaWZfLmlzX29wZW4oKSk7CgogICAgY2hhciBsaW5lX2NvbnRl
bnRbTUFYX0NIQVJdOwogICAgbGluZV9jb250ZW50W01BWF9DSEFSIC0gMV0gPSAnXDAnOwogICAg
aWZfLnNlZWtnKDAsIGlvczo6YmVnKTsKICAgIHdoaWxlICghaWZfLmVvZigpKQogICAgewogICAg
ICAgIGlmXy5nZXRsaW5lKGxpbmVfY29udGVudCwgTUFYX0NIQVIpOyAgICAvLyBkb24ndCBuZWVk
IHJlYWQgdG9vIGxvbmcKICAgICAgICBpZiAoc3RyaW5nKGxpbmVfY29udGVudCkgPT0gIiM6R0FU
S1RhYmxlOlJlY2FsVGFibGUwOiIpCiAgICAgICAgewogICAgICAgICAgICBpZl8uZ2V0bGluZShs
aW5lX2NvbnRlbnQsIE1BWF9DSEFSKTsKICAgICAgICAgICAgaWZfLmdldGxpbmUobGluZV9jb250
ZW50LCBNQVhfQ0hBUik7CiAgICAgICAgICAgIGJnaXRvb2xzOjp0cmltX3N0cihsaW5lX2NvbnRl
bnQpOwogICAgICAgICAgICBmb3IgKGludCBldmVudE9yZCA9IDA7IGV2ZW50T3JkIDwgZ2xvYmFs
Qjo6RXZlbnROdW07IGV2ZW50T3JkKyspCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlm
IChzdHJsZW4obGluZV9jb250ZW50KSAhPSAwKQogICAgICAgICAgICAgICAgewogICAgICAgICAg
ICAgICAgICAgIHN0cmluZyBydDBEYXQgPSBsaW5lX2NvbnRlbnQ7CiAgICAgICAgICAgICAgICAg
ICAgdmVjdG9yPHN0cmluZz4gdmVjX3J0MCA9IGJnaXRvb2xzOjpzcGxpdF9zdHJfMl92ZWMocnQw
RGF0LCAnICcpOwogICAgICAgICAgICAgICAgICAgIFJlY2FsVGFibGUwW2V2ZW50T3JkXS5lc3Rp
bWF0ZWRRUmVwb3J0ZWQgPSBzdGQ6OnN0b2xkKHZlY19ydDBbM10pOwogICAgICAgICAgICAgICAg
ICAgIFJlY2FsVGFibGUwW2V2ZW50T3JkXS5vYnNlcnZhdGlvbnMgPSBzdGQ6OnN0b2xkKHZlY19y
dDBbNF0pOwogICAgICAgICAgICAgICAgICAgIFJlY2FsVGFibGUwW2V2ZW50T3JkXS5udW1NaXNt
YXRjaGVzID0gc3RkOjpzdG9sZCh2ZWNfcnQwWzVdKTsKICAgICAgICAgICAgICAgICAgICBpZl8u
Z2V0bGluZShsaW5lX2NvbnRlbnQsIE1BWF9DSEFSKTsKICAgICAgICAgICAgICAgICAgICBiZ2l0
b29sczo6dHJpbV9zdHIobGluZV9jb250ZW50KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg
ICAgfQogICAgICAgIH0KICAgICAgICBpZiAoc3RyaW5nKGxpbmVfY29udGVudCkgPT0gIiM6R0FU
S1RhYmxlOlJlY2FsVGFibGUxOiIpCiAgICAgICAgewogICAgICAgICAgICBpZl8uZ2V0bGluZShs
aW5lX2NvbnRlbnQsIE1BWF9DSEFSKTsKICAgICAgICAgICAgaWZfLmdldGxpbmUobGluZV9jb250
ZW50LCBNQVhfQ0hBUik7CiAgICAgICAgICAgIGJnaXRvb2xzOjp0cmltX3N0cihsaW5lX2NvbnRl
bnQpOwogICAgICAgICAgICB3aGlsZSAoc3RybGVuKGxpbmVfY29udGVudCkgIT0gMCkKICAgICAg
ICAgICAgewogICAgICAgICAgICAgICAgc3RyaW5nIHJ0MURhdCA9IGxpbmVfY29udGVudDsKICAg
ICAgICAgICAgICAgIHZlY3RvcjxzdHJpbmc+IHZlY19ydDEgPSBiZ2l0b29sczo6c3BsaXRfc3Ry
XzJfdmVjKHJ0MURhdCwgJyAnKTsKICAgICAgICAgICAgICAgIGludCBxdWFsaXR5U2NvcmUgPSAo
aW50KXN0b2wodmVjX3J0MVsxXS5jX3N0cigpKTsKICAgICAgICAgICAgICAgIGludCBldmVudE9y
ZCA9IGJnaXRvb2xzOjpnZXRFdmVudE9yZEJ5RXRTdHIodmVjX3J0MVsyXSk7CiAgICAgICAgICAg
ICAgICBSZWNhbFRhYmxlMVtxdWFsaXR5U2NvcmVdW2V2ZW50T3JkXS5lbXBpcmljYWxRdWFsaXR5
ID0gc3RkOjpzdG9sZCh2ZWNfcnQxWzNdKTsKICAgICAgICAgICAgICAgIFJlY2FsVGFibGUxW3F1
YWxpdHlTY29yZV1bZXZlbnRPcmRdLm9ic2VydmF0aW9ucyA9IHN0ZDo6c3RvbGQodmVjX3J0MVs0
XSk7CiAgICAgICAgICAgICAgICBSZWNhbFRhYmxlMVtxdWFsaXR5U2NvcmVdW2V2ZW50T3JkXS5u
dW1NaXNtYXRjaGVzID0gc3RkOjpzdG9sZCh2ZWNfcnQxWzVdKTsKICAgICAgICAgICAgICAgIGlm
Xy5nZXRsaW5lKGxpbmVfY29udGVudCwgTUFYX0NIQVIpOwogICAgICAgICAgICAgICAgYmdpdG9v
bHM6OnRyaW1fc3RyKGxpbmVfY29udGVudCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAg
ICAgaWYgKHN0cmluZyhsaW5lX2NvbnRlbnQpID09ICIjOkdBVEtUYWJsZTpSZWNhbFRhYmxlMjoi
KQogICAgICAgIHsKICAgICAgICAgICAgaWZfLmdldGxpbmUobGluZV9jb250ZW50LCBNQVhfQ0hB
Uik7CiAgICAgICAgICAgIGlmXy5nZXRsaW5lKGxpbmVfY29udGVudCwgTUFYX0NIQVIpOwogICAg
ICAgICAgICBiZ2l0b29sczo6dHJpbV9zdHIobGluZV9jb250ZW50KTsKICAgICAgICAgICAgd2hp
bGUgKCFpZl8uZW9mKCkgJiYgc3RybGVuKGxpbmVfY29udGVudCkgIT0gMCkKICAgICAgICAgICAg
ewogICAgICAgICAgICAgICAgc3RyaW5nIHJ0MURhdCA9IGxpbmVfY29udGVudDsKICAgICAgICAg
ICAgICAgIHZlY3RvcjxzdHJpbmc+IHZlY19ydDEgPSBiZ2l0b29sczo6c3BsaXRfc3RyXzJfdmVj
KHJ0MURhdCwgJyAnKTsKICAgICAgICAgICAgICAgIGludCBxdWFsaXR5U2NvcmUgPSAoaW50KXN0
b2wodmVjX3J0MVsxXS5jX3N0cigpKTsKICAgICAgICAgICAgICAgIGludCBldmVudE9yZCA9IGJn
aXRvb2xzOjpnZXRFdmVudE9yZEJ5RXRTdHIodmVjX3J0MVs0XSk7CiAgICAgICAgICAgICAgICBz
dHJpbmcgY292YXJpYXRlVmFsdWUgPSB2ZWNfcnQxWzJdOwogICAgICAgICAgICAgICAgaW50IGtl
eSwgY3ZJbmQ7CiAgICAgICAgICAgICAgICBpZiAodmVjX3J0MVszXSA9PSAiQ29udGV4dCIpCiAg
ICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgY3ZJbmQgPSAwOwogICAgICAgICAg
ICAgICAgICAgIGlmIChldmVudE9yZCA9PSAwKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAg
ICAgICAgICAgICAgICAgICAga2V5ID0gc2FtdG9vbHM6OmtleUZyb21Db250ZXh0KGNvdmFyaWF0
ZVZhbHVlLCAwLCBnbG9iYWxCOjptaXNtYXRjaGVzQ29udGV4dFNpemUpOwogICAgICAgICAgICAg
ICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgewog
ICAgICAgICAgICAgICAgICAgICAgICBrZXkgPSBzYW10b29sczo6a2V5RnJvbUNvbnRleHQoY292
YXJpYXRlVmFsdWUsIDAsIGdsb2JhbEI6OmluZGVsc0NvbnRleHRTaXplKTsKICAgICAgICAgICAg
ICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAg
ICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgY3ZJbmQgPSAxOwogICAgICAgICAgICAgICAg
ICAgIGludCBjeWNsZSA9IGF0b2koY292YXJpYXRlVmFsdWUuY19zdHIoKSk7CiAgICAgICAgICAg
ICAgICAgICAga2V5ID0gc2FtdG9vbHM6OmtleUZyb21DeWNsZShjeWNsZSk7CiAgICAgICAgICAg
ICAgICB9CiAgICAgICAgICAgICAgICBpZiAoY3ZJbmQgPT0gMCAmJiBxdWFsaXR5U2NvcmUgPT0g
NDUgJiYga2V5ID09IDMgJiYgZXZlbnRPcmQgPT0gMikKICAgICAgICAgICAgICAgIHsKICAgICAg
ICAgICAgICAgICAgICBjb3V0IDw8ICIiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAg
ICAgUmVjYWxUYWJsZTJbY3ZJbmRdW3F1YWxpdHlTY29yZV1ba2V5XVtldmVudE9yZF0uZXN0aW1h
dGVkUVJlcG9ydGVkID0gc3RkOjpzdG9sZCh2ZWNfcnQxWzVdKTsKICAgICAgICAgICAgICAgIFJl
Y2FsVGFibGUyW2N2SW5kXVtxdWFsaXR5U2NvcmVdW2tleV1bZXZlbnRPcmRdLm9ic2VydmF0aW9u
cyA9IHN0ZDo6c3RvbGQodmVjX3J0MVs2XSk7CiAgICAgICAgICAgICAgICBSZWNhbFRhYmxlMltj
dkluZF1bcXVhbGl0eVNjb3JlXVtrZXldW2V2ZW50T3JkXS5udW1NaXNtYXRjaGVzID0gc3RkOjpz
dG9sZCh2ZWNfcnQxWzddKTsKICAgICAgICAgICAgICAgIGlmXy5nZXRsaW5lKGxpbmVfY29udGVu
dCwgTUFYX0NIQVIpOwogICAgICAgICAgICAgICAgYmdpdG9vbHM6OnRyaW1fc3RyKGxpbmVfY29u
dGVudCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY29udGludWU7CiAgICB9CiAg
ICBpZl8uY2xvc2UoKTsKfQogCgovLyBncnBfdGFibGVzX18gZW5kIAoKLy8jaW5jbHVkZSAiYnFz
cnRvb2xzLmNwcCIKLy8gYnFzcnRvb2xzX18gc3RhcnQgCmRvdWJsZSBicXNydG9vbHM6OkNhbGN1
bGF0ZURlbHRhUUNvdmFyaWF0ZXNfdjEoc3RydWN0IGdycHRvb2xzOjpSZWNhbFRhYmxlMiAmIGVf
cnQyXzEsIGNvbnN0IGRvdWJsZSAmIGdsb2JhbERlbHRhUSwgY29uc3QgZG91YmxlICYgZGVsdGFR
UmVwb3J0ZWQsIGNvbnN0IGRvdWJsZSAmIGVwc2lsb24pCnsKICAgIGRvdWJsZSByZXN1bHQgPSAw
LjsKICAgIGlmIChlX3J0Ml8xLm9ic2VydmF0aW9ucyA+IDEwZS00KQogICAgewogICAgICAgIGRv
dWJsZSBjb25kaXRpb25hbFByaW9yID0gZGVsdGFRUmVwb3J0ZWQgKyBnbG9iYWxEZWx0YVEgKyBl
cHNpbG9uOwogICAgICAgIHJlc3VsdCA9IGdycHRvb2xzOjpnZXRFbXBpcmljYWxRdWFsaXR5X3Yx
KGNvbmRpdGlvbmFsUHJpb3IsCiAgICAgICAgICAgIGVfcnQyXzEuZW1waXJpY2FsUXVhbGl0eSwK
ICAgICAgICAgICAgZV9ydDJfMS5vYnNlcnZhdGlvbnMsCiAgICAgICAgICAgIGVfcnQyXzEubnVt
TWlzbWF0Y2hlcykgLSBjb25kaXRpb25hbFByaW9yOwogICAgfQoKICAgIHJldHVybiByZXN1bHQ7
Cn0KCmRvdWJsZSBicXNydG9vbHM6OkNhbGN1bGF0ZURlbHRhUVJlcG9ydGVkX3YxKHN0cnVjdCBn
cnB0b29sczo6UmVjYWxUYWJsZTEgJiBlX3J0MV8xLCBjb25zdCBkb3VibGUgJiBnbG9iYWxEZWx0
YVEsIGNvbnN0IGRvdWJsZSAmIGVwc2lsb24pCnsKICAgIGRvdWJsZSByZXN1bHQgPSAwLjsKICAg
IGlmIChlX3J0MV8xLm9ic2VydmF0aW9ucyA+IDEwZS00KQogICAgewogICAgICAgIGRvdWJsZSBj
b25kaXRpb25hbFByaW9yID0gZ2xvYmFsRGVsdGFRICsgZXBzaWxvbjsKICAgICAgICByZXN1bHQg
PSBncnB0b29sczo6Z2V0RW1waXJpY2FsUXVhbGl0eV92MShjb25kaXRpb25hbFByaW9yLAogICAg
ICAgICAgICBlX3J0MV8xLmVtcGlyaWNhbFF1YWxpdHksCiAgICAgICAgICAgIGVfcnQxXzEub2Jz
ZXJ2YXRpb25zLAogICAgICAgICAgICBlX3J0MV8xLm51bU1pc21hdGNoZXMpIC0gY29uZGl0aW9u
YWxQcmlvcjsKICAgIH0KICAgIHJldHVybiByZXN1bHQ7Cn0KCgpkb3VibGUgYnFzcnRvb2xzOjpj
YWxjdWxhdGVHbG9iYWxEZWx0YVFfdjEoc3RydWN0IGdycHRvb2xzOjpSZWNhbFRhYmxlMCAmIGVf
cnQwXzEpCnsKICAgIGRvdWJsZSByZXN1bHQgPSAwLjsKICAgIGlmIChlX3J0MF8xLm9ic2VydmF0
aW9ucyA+IDEwZS00KQogICAgewogICAgICAgIHJlc3VsdCA9IGdycHRvb2xzOjpnZXRFbXBpcmlj
YWxRdWFsaXR5X3YxKGVfcnQwXzEuZXN0aW1hdGVkUVJlcG9ydGVkLAogICAgICAgICAgICBlX3J0
MF8xLmVtcGlyaWNhbFF1YWxpdHksCiAgICAgICAgICAgIGVfcnQwXzEub2JzZXJ2YXRpb25zLAog
ICAgICAgICAgICBlX3J0MF8xLm51bU1pc21hdGNoZXMpIC0gZV9ydDBfMS5lc3RpbWF0ZWRRUmVw
b3J0ZWQ7CiAgICB9CiAgICByZXR1cm4gcmVzdWx0Owp9CgoKCgoKLy8gYnFzcnRvb2xzX18gZW5k
CgoKCgoKX19nbG9iYWxfXyB2b2lkIHRlc3QoKQp7CiAgICBERUZJTkVfSl9qX2lkeDsgCgogICAg
Ly9wcmludGYoIjEgIik7CgoKICAgIGNvbnN0IGNoYXIgKmNvbnN0X2V4X3N0ciA9ICJcdFgwOmk6
MVx0WDE6aTowXHRNRDpaOjUwXHRQRzpaOk1hcmtEdXBsaWNhdGVzXHRSRzpaOkNMMTAwMDM2NDc1
X0wwMV84NVx0WEc6aTowXHRBTTppOjBcdE5NOmk6MFx0U006aTozXHRYTTppOjBcdFhPOmk6MFx0
TVE6aToyOVx0WFQ6QTpVIjsKICAgIC8vY29uc3QgY2hhciAqY29uc3RfZXhfc3RyID0gIitYMDpp
OjErWDE6aTowK01EOlo6NTArUEc6WjpNYXJrRHVwbGljYXRlcytSRzpaOkNMMTAwMDM2NDc1X0ww
MV84NStYRzppOjArQU06aTowK05NOmk6MCtTTTppOjMrWE06aTowK1hPOmk6MCtNUTppOjI5K1hU
OkE6VSI7CiAgICBpbnQgY29uc3RfZXhfc3RyX2xlbiA9IDEyNDsKCgogICAgY29uc3QgaW50IGV4
X3N0cl9sZW5fID0gMTAyNDsKICAgIGNoYXIgZXhfc3RyW2V4X3N0cl9sZW5fXTsKCiAgICBpbnQg
ZXhfc3RyX2xlbiA9IGNvbnN0X2V4X3N0cl9sZW47CgogICAgbWVtY3B5KGV4X3N0ciwgY29uc3Rf
ZXhfc3RyLCBjb25zdF9leF9zdHJfbGVuKTsKCiAgICBjb25zdCBjaGFyICpCRCA9ICJCRDpOTk5O
Tk4iOwogICAgY29uc3QgaW50IGJkX2xlbiA9IDk7CiAgICBjaGFyIGJkW2JkX2xlbl07CiAgICBt
ZW1jcHkoYmQsIEJELCBiZF9sZW4pOwogICAgCgogICAgY29uc3QgY2hhciAqQkkgPSAiQkk6Tk5O
Tk5OIjsKICAgIGNvbnN0IGludCBiaV9sZW4gPSA5OwogICAgY2hhciBiaVtiaV9sZW5dOwogICAg
bWVtY3B5KGJpLCBCSSwgYmlfbGVuKTsKICAgIAogICAgLy9jaGFyIHNlcCA9ICcrJzsKICAgIGNo
YXIgc2VwID0gJ1x0JzsKICAgLy8gZ3B1X3Rvb2xzOjppbnNlcnRfYmRfYmlfdG9fcmVjb3JkKGV4
X3N0ciwgZXhfc3RyX2xlbiwgYmQsIGJkX2xlbiwgYmksIGJpX2xlbiwgc2VwKTsKCgogICAgcHJp
bnRmKCItLS1fJXNfLS0tXG4iLCBleF9zdHIpOwogICAgcHJpbnRmKCItLS1fJWRfLS0tXG4iLCBl
eF9zdHJfbGVuKTsKCn0KCgovLyBtYWluX18gCmludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJn
dikKewoKCWdwdV90b29sczo6c2hvd19jdWRhX2luZm8oMCk7CgojaWYgMAkKICAgIHN0cmluZyBn
cnBfcGF0aCA9ICIuL3QwL3NhbXBsZV8zZy5yZWNhbF9kYXRhLmdycCI7CiAgICBzdHJpbmcgZm5f
c2FtID0gIi4vdDAvc2FtcGxlXzNnLnNhbSI7CiAgICBzdHJpbmcgZm5fb3V0X3NhbSA9ICIuL3Qw
L3NhbXBsZV8zZy5zYW1fb3V0IjsKI2VuZGlmIAoKI2lmIDEJCiAgICBzdHJpbmcgZ3JwX3BhdGgg
PSAiLi90MC9hbGxfZmNvdXQucmVjYWxfZGF0YS5ncnAudHh0IjsKICAgIHN0cmluZyBmbl9zYW0g
PSAiLi90MC9zYW1wbGVfc21hbGxfMTdCMDI5MTQ1LTEtNzkucmVhbG4uc2FtIjsKICAgIHN0cmlu
ZyBmbl9vdXRfc2FtID0gIi4vdDAvc2FtcGxlX3NtYWxsXzE3QjAyOTE0NS0xLTc5LnJlYWxuLnNh
bV9vdXQiOwojZW5kaWYgCgojaWYgMQkKCWlmIChhcmdjID4gMSkKCXsKCQkvLyAuL21haW5fcHJf
Z3B1IC1ncnBQYXRoIC9ob21lL2JnaTkwMi90L2N1ZGFfZGVtby8wX1NpbXBsZS9tYWluX3ByX2dw
dS90MC9hbGxfZmNvdXQucmVjYWxfZGF0YS5ncnAudHh0IC1JIC9ob21lL2JnaTkwMi90L2N1ZGFf
ZGVtby8wX1NpbXBsZS9tYWluX3ByX2dwdS90MC9zYW1wbGVfc21hbGxfMTdCMDI5MTQ1LTEtNzku
cmVhbG4uc2FtICAtbyAvaG9tZS9iZ2k5MDIvdC9jdWRhX2RlbW8vMF9TaW1wbGUvbWFpbl9wcl9n
cHUvdDAvc2FtcGxlX3NtYWxsXzE3QjAyOTE0NS0xLTc5LnJlYWxuLnNhbV9vdXQKCQlhc3NlcnQo
YXJnYyA9PSBnbG9iYWxCOjpTSE9VTERfSEFWRV9BUkdDKTsgCgkJYXNzZXJ0KGFyZ3ZbMV1bMF0g
PT0gJy0nKTsKCQljbWxfcGFyc2VyIGlkX2NtbChhcmdjLCBhcmd2KTsKCgkJc3RyaW5nIG9wdF9z
YW0oIi1JIik7CgkJc3RyaW5nIG9wdF9vdXQoIi1vIik7CgkJc3RyaW5nIG9wdF9ncnBQYXRoKCIt
Z3JwUGF0aCIpOwoKCQlhc3NlcnQoaWRfY21sLmhhc19vcHQob3B0X3NhbSkpOyAKCQlhc3NlcnQo
aWRfY21sLmhhc19vcHQob3B0X291dCkpOyAKCQlhc3NlcnQoaWRfY21sLmhhc19vcHQob3B0X2dy
cFBhdGgpKTsgCgoJCWF1dG8gZV9hcmdfc2FtID0gaWRfY21sLmdldF9hcmdfb3B0KG9wdF9zYW0p
WzBdOwoJCWF1dG8gZV9hcmdfb3V0ID0gaWRfY21sLmdldF9hcmdfb3B0KG9wdF9vdXQpWzBdOwkJ
CgkJYXV0byBlX2FyZ19ncnBQYXRoID0gaWRfY21sLmdldF9hcmdfb3B0KG9wdF9ncnBQYXRoKVsw
XTsKCgkJZ3JwX3BhdGggPSBlX2FyZ19ncnBQYXRoOyAKCQlmbl9zYW0gPSBlX2FyZ19zYW07IAoJ
CWZuX291dF9zYW0gPSBlX2FyZ19vdXQ7IAoJfQoKCiAgICBjb3V0IDw8IGVuZGwgPDwgIi0gYWxs
IGlucHV0IGFuZCBvdXRwdXQgYXJndW1lbnRzIGlzOiIgPDwgZW5kbCA8PCAiIyMjIyMjIyMjIyMj
IyMjIyMjIyMjIyMjIiA8PCBlbmRsOwoKCWNvdXQgPDwgIi0gcm93czpcdCIgPDwgcm93cyA8PCBl
bmRsOyAKCWNvdXQgPDwgIi0gY29sczpcdCIgPDwgY29scyA8PCBlbmRsOyAKICAgIGNvdXQgPDwg
Ii0gZm5fc2FtOlx0IiA8PCBmbl9zYW0gPDwgZW5kbDsKICAgIGNvdXQgPDwgIi0gZm5fb3V0X3Nh
bTpcdCIgPDwgZm5fb3V0X3NhbSA8PCBlbmRsOwogICAgY291dCA8PCAiLSBncnBfcGF0aDpcdCIg
PDwgZ3JwX3BhdGggPDwgZW5kbCA8PCBlbmRsOyAKCgojZW5kaWYgCgoKI2lmIDAKICAgIGRpbTMg
Z18ocm93cywgMSwgMSk7CiAgICBkaW0zIGJfKGNvbHMsIDEsIDEpOwoKICAgIHRlc3QgPDwgPGdf
LCBiXyA+PiA+KCk7IAoKICAgIENVREFfQ0hFQ0tfUkVUVVJOKGN1ZGFEZXZpY2VTeW5jaHJvbml6
ZSgpKTsKI2VuZGlmIAoKI2lmIDEgCgoJY291dCA8PCAiTm93IHJ1bm5uaW5nIFByaW50UmVhZHMt
LS0tLS0tLS0tLS0tLS0tIiA8PCBlbmRsOwoKICAgIGdsb2JhbEI6OmluaXRpYWxpemVRZW1wUHJp
b3IoKTsKCglncnBfdGFibGVzIGVfZ3JwX3RhYmxlOwoJZV9ncnBfdGFibGUuYWxsb2NhdGVSVDEo
KTsKCWVfZ3JwX3RhYmxlLmFsbG9jYXRlUlQyX3YxKCk7CgoKCWVfZ3JwX3RhYmxlLmxvYWQoZ3Jw
X3BhdGgpOwoKCiAgICAKICAgIG9mc3RyZWFtIG9mXzAoZm5fb3V0X3NhbS5jX3N0cigpLCBpb3M6
OmJpbmFyeSk7IGFzc2VydChvZl8wLmlzX29wZW4oKSk7IG9mXzAuY2xvc2UoKTsKCW9mc3RyZWFt
IG9mXyhmbl9vdXRfc2FtLmNfc3RyKCksIGlvczo6YXBwKTsgYXNzZXJ0KG9mXy5pc19vcGVuKCkp
OwoKCgkKCQoKCglpZnN0cmVhbSBpZl8oZm5fc2FtLmNfc3RyKCkpOyAgIGFzc2VydChpZl8uaXNf
b3BlbigpKTsKCXN0cmluZyBzYW1faGVhZGVyID0gZ3B1X3Rvb2xzOjpyZWFkX2hlYWQoaWZfKTsK
CiAgICBvZl8gPDwgc2FtX2hlYWRlcjsgCgoJYXV0byBteV9jdXJfcG9zID0gaWZfLnRlbGxnKCk7
IAoKCXN0cmluZyBlX2xpbmU7CglzdGQ6OmdldGxpbmUoaWZfLCBlX2xpbmUpOwoJdmVjdG9yPHN0
cmluZz4gdmVjX3NhbV9maWVsZCA9IGJnaXRvb2xzOjpzcGxpdF9zdHJfMl92ZWMoZV9saW5lLCAn
XHQnKTsKCgoJaW50IHJlYWRMZW5ndGggPSAoaW50KSh2ZWNfc2FtX2ZpZWxkWzldLnNpemUoKSk7
IAoKCWdsb2JhbEI6OnJlbGF0ZWREZWx0YVFJbml0KGVfZ3JwX3RhYmxlLCByZWFkTGVuZ3RoKTsK
Cglkb3VibGUgKmdsb2JhbEJfZXBzaWxvbiA9IE5VTEw7IAoJQ1VEQV9DSEVDS19SRVRVUk4oCgkJ
CWN1ZGFNYWxsb2NNYW5hZ2VkKCZnbG9iYWxCX2Vwc2lsb24sIChnbG9iYWxCOjpFdmVudE51bSkg
KiBzaXplb2YoZG91YmxlKSkKCQkJKTsgCgoJaWZfLnNlZWtnKG15X2N1cl9wb3MpOwoJZV9saW5l
X3QgKmdwdV9wOwoJY3VkYU1hbGxvY01hbmFnZWQoJmdwdV9wLCByb3dzICogY29scyAqIHNpemVv
ZihlX2xpbmVfdCkpOwoKCiAgICBhdXRvICZnbG9iYWxCX2RlbHRhUVJlcG9ydGVkID0gZ2xvYmFs
Qjo6ZGVsdGFRUmVwb3J0ZWQ7CgogICAgYXV0byAmZ2xvYmFsQl9kZWx0YVFDb3ZhcmlhdGVzQXJy
XzEgPSBnbG9iYWxCOjpkZWx0YVFDb3ZhcmlhdGVzQXJyXzE7CiAgICBhdXRvICZnbG9iYWxCX2ds
b2JhbERlbHRhUV8xID0gZ2xvYmFsQjo6Z2xvYmFsRGVsdGFRXzE7CiAgICBhdXRvICZnbG9iYWxC
X2N5Y2xlX3Zfa19hcnIgPSBnbG9iYWxCOjpjeWNsZV92X2tfYXJyOwogICAgYXV0byAmZ2xvYmFs
Ql9jb250ZXh0X3Zfa19hcnIgPSBnbG9iYWxCOjpjb250ZXh0X3Zfa19hcnI7CgogICAgYXV0byAm
Z2xvYmFsQl9DT05URVhUQ09NQklORVNJWkUgPSBnbG9iYWxCOjpDT05URVhUQ09NQklORVNJWkU7
CiAgICBhdXRvIGdsb2JhbEJfY29udGV4dENvbWJpbmVfc3ogPSBnbG9iYWxCOjpjb250ZXh0Q29t
YmluZS5zaXplKCk7CgogICAgYXV0byAmZ3JwdG9vbHNfcmVhZENvdmFyaWF0ZXNBcnIgPSBncnB0
b29sczo6cmVhZENvdmFyaWF0ZXNBcnI7CiAgICBhdXRvICZnbG9iYWxCX2xpbmVfY2FjaGUgPSBn
bG9iYWxCOjpsaW5lX2NhY2hlOwogICAgYXV0byAmZ2xvYmFsQl9saW5lX2NhY2hlXzEgPSBnbG9i
YWxCOjpsaW5lX2NhY2hlXzE7CgoKICAgIC8vIHJvd3MgPSAzLCBjb2xzID0gcmVhZExlbmd0aCAg
aSAqIGNvbHMgKyBqCiAgICBDVURBX0NIRUNLX1JFVFVSTigKICAgICAgICBjdWRhTWFsbG9jTWFu
YWdlZCgmZ3JwdG9vbHNfcmVhZENvdmFyaWF0ZXNBcnIsIHJvd3MgKiBjb2xzICogMyAqIHJlYWRM
ZW5ndGggKiBzaXplb2YoZ3JwdG9vbHM6OkNWS0VZKSkKICAgICAgICApOwogICAgQ1VEQV9DSEVD
S19SRVRVUk4oY3VkYU1hbGxvY01hbmFnZWQoJmdsb2JhbEI6OmxpbmVfY2FjaGUsIHJvd3MgKiBj
b2xzICogMTAyNCkpOwogICAgQ1VEQV9DSEVDS19SRVRVUk4oY3VkYU1hbGxvY01hbmFnZWQoJmds
b2JhbEI6OmxpbmVfY2FjaGVfMSwgcm93cyAqIGNvbHMgKiAxMDI0KSk7CgoKCgl3aGlsZSAoIWlm
Xy5lb2YoKSkKCXsgCgkJaW50IGNudF9saW5lID0gMDsKCgkJd2hpbGUgKCFpZl8uZW9mKCkpCgkJ
ewoJCQlzdGQ6OmdldGxpbmUoaWZfLCBlX2xpbmUpOwoJCQlpZiAoZV9saW5lLnNpemUoKSA+IDAp
CgkJCXsKCQkJCWdwdV9wW2NudF9saW5lKytdID0gZV9saW5lX3QoZV9saW5lKTsKCgkJCQlpZiAo
Y250X2xpbmUgPT0gcm93cyAqIGNvbHMpIGJyZWFrOwoJCQl9CgkJCWVsc2UKCQkJewoJCQkJYnJl
YWs7ICAvLyBlb2YKCQkJfQoJCX0KCgkJZGltMyBnXyhyb3dzLCAxLCAxKTsKCQlkaW0zIGJfKGNv
bHMsIDEsIDEpOwoKCgkJZm9yKGludCBpPTA7aTxnbG9iYWxCOjpFdmVudE51bTsgaSsrKQoJCXsK
CQkJZ2xvYmFsQl9lcHNpbG9uW2ldID0gZ2xvYmFsQjo6ZXBzaWxvbltpXTsKCQl9CgoKCgkJZ3B1
X3Rvb2xzOjpwcm9jX2VfbGluZSA8PCA8Z18sIGJfPj4gPihncHVfcCwgY250X2xpbmUsIAoJCQkJ
Z2xvYmFsQl9kZWx0YVFSZXBvcnRlZCwKCQkJCWdsb2JhbEJfZGVsdGFRQ292YXJpYXRlc0Fycl8x
LAoJCQkJZ2xvYmFsQl9nbG9iYWxEZWx0YVFfMSwKCQkJCWdsb2JhbEJfY3ljbGVfdl9rX2FyciwK
CQkJCWdsb2JhbEJfY29udGV4dF92X2tfYXJyLAoJCQkJZ2xvYmFsQl9DT05URVhUQ09NQklORVNJ
WkUsCgkJCQlnbG9iYWxCX2Vwc2lsb24sCgkJCQlnbG9iYWxCX2NvbnRleHRDb21iaW5lX3N6LAoJ
CQkJZ3JwdG9vbHNfcmVhZENvdmFyaWF0ZXNBcnIsCgkJCQlnbG9iYWxCX2xpbmVfY2FjaGUsCgkJ
CQlnbG9iYWxCX2xpbmVfY2FjaGVfMQoJCQkJKTsKCgkJc3RhdGljIGludCBjbnRfYmF0Y2ggPSAw
OyAKCQljb3V0IDw8ICItIGJhdGNoIDogIiA8PCBjbnRfYmF0Y2ggPDwgZW5kbDsKCQlDVURBX0NI
RUNLX1JFVFVSTihjdWRhRGV2aWNlU3luY2hyb25pemUoKSk7CgoKCQlmb3IoaW50IGk9MDtpPGNu
dF9saW5lO2krKykKCQl7CgkJCW9mXyA8PCBncHVfcFtpXS5wIDw8IGVuZGw7IAoJCX0KCgkJLy8g
Q0wxMDAwMzY0NzVMMUMwMDdSMDUxXzQzNDQ0ICAgICAxNjMgICAgIGNocjEgICAgMTA0NDAyOTYg
ICAgICAgIDM3ICAgICAgNTBNICAgICA9ICAgICAgIDEwNDQwNTE4ICAgIDI3MiBDQUdUR0d+fn5H
VEFDVEMgICAgICBGRkY1Rn5ERkZGRUYKCQkvLyBxbmFtZSAgICAgICAgICAgICAgICAgICAgICAg
ICBjX2ZsYWcgICAgcm5hbWUgICAgY19wb3MgICAgICAgIGNfbWFwcSAgICBjaWdhciAgcm5leHQg
ICAgIGNfcG5leHQgICBjX3RsZW4gICBzZXEgICAgICAgICAgICAgICAgICBxdWFsICAgICAgICAg
ICAgICAgCgkJLy9icmVhazsgLy9qZF8KCiNpZiAwCgkJaWYgKGNudF9iYXRjaCA9PSAyKQoJCXsK
CQkJYnJlYWs7IAoJCX0KI2VuZGlmIAoJCWNudF9iYXRjaCsrOwoKCX0KCgoKCWN1ZGFGcmVlKGdw
dV9wKTsKCWN1ZGFGcmVlKGdsb2JhbEJfZXBzaWxvbik7CiAgICBjdWRhRnJlZShncnB0b29sc19y
ZWFkQ292YXJpYXRlc0Fycik7CgoJaWZfLmNsb3NlKCk7CgoJZ2xvYmFsQjo6cmVsYXRlZERlbHRh
UVJlbGVhc2UoZ2xvYmFsQjo6Y29udGV4dENvbWJpbmUuc2l6ZSgpLCByZWFkTGVuZ3RoKTsKCgll
X2dycF90YWJsZS5yZWxlYXNlUlQxKCk7CgllX2dycF90YWJsZS5yZWxlYXNlUlQyX3YxKCk7CgoJ
b2ZfLmNsb3NlKCk7CiNlbmRpZiAKCglfX1BfXzsKfQoKCgoKCgo=
